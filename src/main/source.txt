Folder Structure
--------------------------------------------------
/
    codebase.txt
java/
    controller/
        CartServlet.java
        IndexServlet.java
        SearchServlet.java
        TrackPaginationServlet.java
        TrackServlet.java
        MarketingManagement/
            ImageServlet.java
            MarketingServlet.java
        OrderManagement/
            OrderDetailsServlet.java
        UserAuth/
            LoginServlet.java
            LogoutServlet.java
            filters/
                AdminFilter.java
                AuthFilter.java
                RoleFilter.java
        UserManagement/
            ManageUserServlet.java
            RegisterServlet.java
    dao/
        AdvertisementDAO.java
        CartDAO.java
        PromotionDAO.java
        TrackDAO.java
        UserDAO.java
    model/
        Admin.java
        Advertisement.java
        Promotion.java
        Track.java
        User.java
        enums/
            AdminRole.java
    utils/
        DatabaseConnection.java
        EmailHandleUtil.java
        PasswordUtil.java
resources/
    config.properties
webapp/
    index.jsp
    login.jsp
    order_details.jsp
    searchMusic.jsp
    signup.jsp
    admin/
        index.jsp
        ManageMarketing.jsp
        ManageUsers.jsp
        css/
            admin-styles.css
            index.css
            theme.css
        includes/
            admin_nav_bar.jsp
            modals/
                manage_marketing_modals/
                    add_advertisement_modal.jsp
                    add_promotion_modal.jsp
                    delete_advertisement_modal.jsp
                    delete_promotion_modal.jsp
                    edit_advertisement_modal.jsp
                    edit_promotion_modal.jsp
                manage_user_modals/
                    add_user_modal.jsp
                    delete_user_modal.jsp
                    edit_user_modal.jsp
    css/
        admin-styles.css
        index.css
        login.css
        signup.css
        theme.css
    includes/
        footer.jsp
        navbar.jsp
        modals/
            shoppingCartModal.jsp
    js/
        cart.js
        music.js
    WEB-INF/
        web.xml
        db/
            RhythmWaveDB.db


File Contents
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/codebase.txt
File type: .txt
Folder Structure
--------------------------------------------------
/
java/
    controller/
        CartServlet.java
        IndexServlet.java
        SearchServlet.java
        TrackPaginationServlet.java
        TrackServlet.java
        MarketingManagement/
            ImageServlet.java
            MarketingServlet.java
        UserAuth/
            LoginServlet.java
            LogoutServlet.java
            filters/
                AdminFilter.java
                AuthFilter.java
        UserManagement/
            ManageUserServlet.java
            RegisterServlet.java
    dao/
        AdvertisementDAO.java
        CartDAO.java
        PromotionDAO.java
        TrackDAO.java
        UserDAO.java
    model/
        Admin.java
        Advertisement.java
        Promotion.java
        Track.java
        User.java
    utils/
        DatabaseConnection.java
        EmailHandleUtil.java
        PasswordUtil.java
resources/
    config.properties
webapp/
    index.jsp
    login.jsp
    searchMusic.jsp
    signup.jsp
    admin/
        index.jsp
        ManageMarketing.jsp
        ManageUsers.jsp
        css/
            admin-styles.css
            index.css
            theme.css
        includes/
            admin_nav_bar.jsp
            modals/
                manage_marketing_modals/
                    add_advertisement_modal.jsp
                    add_promotion_modal.jsp
                    delete_advertisement_modal.jsp
                    delete_promotion_modal.jsp
                    edit_advertisement_modal.jsp
                    edit_promotion_modal.jsp
                manage_user_modals/
                    add_user_modal.jsp
                    delete_user_modal.jsp
                    edit_user_modal.jsp
    css/
        admin-styles.css
        index.css
        login.css
        signup.css
        theme.css
    includes/
        footer.jsp
        navbar.jsp
        modals/
            shoppingCartModal.jsp
    js/
        cart.js
    WEB-INF/
        web.xml
        db/
            RhythmWaveDB.db


File Contents
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\CartServlet.java
File type: .java
package controller;

import dao.TrackDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;

import java.io.IOException;
import java.io.PrintWriter;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import com.google.gson.Gson;

@WebServlet(name = "CartServlet", value = "/CartServlet")
public class CartServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("application/json");
        response.setCharacterEncoding("UTF-8");
        PrintWriter out = response.getWriter();
        Gson gson = new Gson();

        try {
            String action = request.getParameter("action");
            String trackId = request.getParameter("trackId");

            // Get or create cart in session
            HttpSession session = request.getSession();
            List<Track> cartItems = (List<Track>) session.getAttribute("cartItems");

            if (cartItems == null) {
                cartItems = new ArrayList<>();
                session.setAttribute("cartItems", cartItems);
            }

            // Handle getState action - return current cart state without modification
            if ("getState".equals(action)) {
                double cartTotal = calculateTotal(cartItems);
                int itemCount = cartItems.size();

                CartResponse cartResponse = new CartResponse(
                        cartItems != null ? cartItems : new ArrayList<>(),
                        cartTotal,
                        itemCount
                );

                out.print(gson.toJson(cartResponse));
                out.flush();
                return;
            }

            // Validate parameters for other actions
            if (trackId == null || trackId.trim().isEmpty()) {
                response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
                out.print(gson.toJson(new ErrorResponse("Track ID is required")));
                out.flush();
                return;
            }

            if (action == null || (!action.equals("add") && !action.equals("remove"))) {
                response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
                out.print(gson.toJson(new ErrorResponse("Invalid or missing action")));
                out.flush();
                return;
            }

            // Parse trackId and fetch track
            Track track;
            try {
                track = TrackDAO.findTrackById(Integer.parseInt(trackId));
            } catch (NumberFormatException e) {
                response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
                out.print(gson.toJson(new ErrorResponse("Invalid track ID format")));
                out.flush();
                return;
            } catch (SQLException e) {
                response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
                out.print(gson.toJson(new ErrorResponse("Database error occurred")));
                out.flush();
                return;
            }

            if (track == null) {
                response.setStatus(HttpServletResponse.SC_NOT_FOUND);
                out.print(gson.toJson(new ErrorResponse("Track not found")));
                out.flush();
                return;
            }

            Double cartTotal = 0.0;

            // Perform cart action
            switch (action) {
                case "add":
                    addItemtoCart(cartItems, track);
                    cartTotal = calculateTotal(cartItems);
                    System.out.println("Item Added to Cart: " + trackId);
                    break;
                case "remove":
                    removeFromCart(cartItems, track);
                    cartTotal = calculateTotal(cartItems);
                    System.out.println("Item Removed from Cart: " + trackId);
                    break;
            }

            // Update cart in session
            session.setAttribute("cartItems", cartItems);
            session.setAttribute("cartTotal", cartTotal);

            // Respond with JSON
            CartResponse cartResponse = new CartResponse(cartItems, cartTotal, cartItems.size());
            out.print(gson.toJson(cartResponse));
            out.flush();

        } catch (Exception e) {
            // Catch any unexpected errors
            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
            out.print(gson.toJson(new ErrorResponse("Unexpected error: " + e.getMessage())));
            out.flush();
            e.printStackTrace();
        }
    }

    private void addItemtoCart(List<Track> cartItems, Track track) {
        // Check if track already exists in cart
        boolean exists = false;
        for (Track item : cartItems) {
            if (item.getTrackId() == track.getTrackId()) {
                exists = true;
                break;
            }
        }

        if (!exists) {
            cartItems.add(track);
        }
    }

    private void removeFromCart(List<Track> cartItems, Track track) {
        // Find and remove the track by ID
        for (int i = 0; i < cartItems.size(); i++) {
            if (cartItems.get(i).getTrackId() == track.getTrackId()) {
                cartItems.remove(i);
                break;
            }
        }
    }

    private double calculateTotal(List<Track> cartItems) {
        double total = 0;
        if (cartItems != null) {
            for (Track track : cartItems) {
                total += track.getPrice();
            }
        }
        return total;
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        doGet(request, response);
    }

    // Inner class for JSON response
    private static class CartResponse {
        private List<Track> cartItems;
        private double cartTotal;
        private int itemCount;

        public CartResponse(List<Track> cartItems, double cartTotal, int itemCount) {
            this.cartItems = cartItems;
            this.cartTotal = cartTotal;
            this.itemCount = itemCount;
        }

        // Add getters for JSON serialization
        public List<Track> getCartItems() { return cartItems; }
        public double getCartTotal() { return cartTotal; }
        public int getItemCount() { return itemCount; }
    }

    // Inner class for error response
    private static class ErrorResponse {
        private String error;

        public ErrorResponse(String error) {
            this.error = error;
        }

        public String getError() { return error; }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\IndexServlet.java
File type: .java
package controller;

import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;

import java.io.IOException;

@WebServlet(name = "IndexServlet", value = "", loadOnStartup = 1)
public class IndexServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.sendRedirect(request.getContextPath() + "/trackPaginate");
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\SearchServlet.java
File type: .java
package controller;

import dao.TrackDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.util.*;

@WebServlet("/search")
public class SearchServlet extends HttpServlet {
    private final int RECORDS_PER_PAGE = 8;

    @Override
    public void init() throws ServletException {
        TrackDAO.ensureTableExists();
    }

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // Retrieve search parameters
        String title = request.getParameter("query");
        String genre = request.getParameter("genre");
        String priceRange = request.getParameter("price");
        String rating = request.getParameter("rating");

        // Parse price range
        Double minPrice = null;
        Double maxPrice = null;
        if (priceRange != null && !priceRange.isEmpty()) {
            switch (priceRange) {
                case "under100":
                    maxPrice = 100.0;
                    break;
                case "100-200":
                    minPrice = 100.0;
                    maxPrice = 200.0;
                    break;
                case "200-400":
                    minPrice = 200.0;
                    maxPrice = 400.0;
                    break;
                case "over400":
                    minPrice = 400.0;
                    break;
            }
        }

        // Parse rating
        Double minRating = null;
        if (rating != null && !rating.isEmpty()) {
            try {
                minRating = Double.parseDouble(rating);
            } catch (NumberFormatException e) {
                minRating = null;
            }
        }

        // Handle pagination
        int page = 1;
        if (request.getParameter("page") != null) {
            try {
                page = Integer.parseInt(request.getParameter("page"));
            } catch (NumberFormatException e) {
                page = 1;
            }
        }

        List<Track> tracks = new ArrayList<>();
        int noOfRecords = 0;
        int noOfPages = 0;

        try {
            // Check if no search parameters are provided
            if ((title == null || title.isEmpty()) &&
                    (genre == null || genre.isEmpty()) &&
                    (priceRange == null || priceRange.isEmpty()) &&
                    (rating == null || rating.isEmpty())) {
                // Fetch all tracks with pagination
                tracks = TrackDAO.getAllTracksPaginated(page, RECORDS_PER_PAGE);
                noOfRecords = TrackDAO.countAllTracks();
            } else {
                // Use TrackDAO to search products
                tracks = TrackDAO.searchProducts(title, genre, minPrice, maxPrice, minRating, page, RECORDS_PER_PAGE);
                noOfRecords = TrackDAO.countProducts(title, genre, minPrice, maxPrice);
            }
            noOfPages = (int) Math.ceil(noOfRecords * 1.0 / RECORDS_PER_PAGE);

        } catch (Exception e) {
            e.printStackTrace();
        }

        // Set attributes for JSP
        request.setAttribute("trackList", tracks);
        request.setAttribute("noOfPages", noOfPages);
        request.setAttribute("currentPage", page);

        // Forward to JSP
        RequestDispatcher rd = request.getRequestDispatcher("searchMusic.jsp");
        rd.forward(request, response);
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\TrackPaginationServlet.java
File type: .java
package controller;

import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.util.*;

@WebServlet("/trackPaginate")
public class TrackPaginationServlet extends HttpServlet {
    private final int RECORDS_PER_PAGE = 8;

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        int page = 1;
        if (request.getParameter("page") != null) {
            page = Integer.parseInt(request.getParameter("page"));
        }

        List<Track> tracks = new ArrayList<>();
        int noOfRecords = 0;
        int noOfPages = 0;

        try {

            Connection conn = DatabaseConnection.getConnection();

            // Fetch limited songs
            PreparedStatement ps = conn.prepareStatement(
                    "SELECT * FROM tracks ORDER BY trackId OFFSET ? ROWS FETCH NEXT ? ROWS ONLY");
            ps.setInt(1, (page - 1) * RECORDS_PER_PAGE);
            ps.setInt(2, RECORDS_PER_PAGE);

            ResultSet rs = ps.executeQuery();
            while (rs.next()) {
                Track track = new Track(
                        rs.getString("title"),
                        rs.getString("artist")
                );
                track.setTrackId(rs.getInt("trackId"));
                track.setPrice(rs.getDouble("price"));
                tracks.add(track);
            }
            rs.close();

            // Get total rows
            Statement stmt = conn.createStatement();
            rs = stmt.executeQuery("SELECT COUNT(*) FROM tracks");
            if (rs.next()) {
                noOfRecords = rs.getInt(1);
            }
            noOfPages = (int) Math.ceil(noOfRecords * 1.0 / RECORDS_PER_PAGE);

            rs.close();

            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

        request.setAttribute("trackList", tracks);
        request.setAttribute("noOfPages", noOfPages);
        request.setAttribute("currentPage", page);

        RequestDispatcher rd = request.getRequestDispatcher("index.jsp");
        rd.forward(request, response);
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\TrackServlet.java
File type: .java
package controller;

import dao.TrackDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;

import java.io.IOException;
import java.sql.SQLException;
import java.util.LinkedList;
import java.util.List;

@WebServlet(name = "TrackServlet", value = "/TrackServlet")
public class TrackServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        LinkedList<Track> allTracks = new LinkedList<>();
        try {
            allTracks = TrackDAO.getAllTracks();
            request.setAttribute("allTracks", allTracks);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        request.getRequestDispatcher("TrackList.jsp").forward(request, response);

    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\MarketingManagement\ImageServlet.java
File type: .java
package controller.MarketingManagement;

import dao.AdvertisementDAO;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import model.Advertisement;

import java.io.IOException;
import java.sql.SQLException;

@WebServlet("/image")
public class ImageServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String adIdStr = request.getParameter("adId");
        if (adIdStr == null || adIdStr.isEmpty()) {
            response.sendError(HttpServletResponse.SC_BAD_REQUEST, "Advertisement ID is required.");
            return;
        }

        try {
            int adId = Integer.parseInt(adIdStr);
            Advertisement ad = AdvertisementDAO.findAdvertisementById(adId);
            if (ad == null || ad.getImageData() == null) {
                response.sendError(HttpServletResponse.SC_NOT_FOUND, "Image not found.");
                return;
            }

            response.setContentType("image/jpeg"); // Adjust based on actual image type if needed
            response.getOutputStream().write(ad.getImageData());
            response.getOutputStream().flush();
        } catch (SQLException e) {
            response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "Database error occurred.");
        } catch (NumberFormatException e) {
            response.sendError(HttpServletResponse.SC_BAD_REQUEST, "Invalid advertisement ID.");
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\MarketingManagement\MarketingServlet.java
File type: .java
package controller.MarketingManagement;

import dao.AdvertisementDAO;
import dao.PromotionDAO;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.MultipartConfig;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.*;
import model.Advertisement;
import model.Promotion;

import java.io.IOException;
import java.io.InputStream;
import java.sql.SQLException;
import java.time.LocalDate;
import java.util.LinkedList;

@WebServlet("/marketing")
@MultipartConfig(fileSizeThreshold = 1024 * 1024 * 2, // 2MB
        maxFileSize = 1024 * 1024 * 10,      // 10MB
        maxRequestSize = 1024 * 1024 * 50)    // 50MB
public class MarketingServlet extends HttpServlet {

    private static final String[] ALLOWED_EXTENSIONS = {".png", ".jpg", ".jpeg"};

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String action = request.getParameter("action");

        HttpSession session = request.getSession();

        if (action.startsWith("ad_")) {
            handleAdvertisementAction(request, response, action.substring(3));
        } else {
            switch (action) {
                case "add":
                    String code = request.getParameter("code");
                    double discount = Double.parseDouble(request.getParameter("discount"));
                    LocalDate startDate = LocalDate.parse(request.getParameter("startDate"));
                    LocalDate endDate = LocalDate.parse(request.getParameter("endDate"));
                    String description = request.getParameter("description");
                    addPromotion(code, discount, startDate, endDate, description);
                    break;
                case "update":
                    int promotionId = Integer.parseInt(request.getParameter("promotionId"));
                    String updateCode = request.getParameter("code");
                    double updateDiscount = Double.parseDouble(request.getParameter("discount"));
                    LocalDate updateStartDate = LocalDate.parse(request.getParameter("startDate"));
                    LocalDate updateEndDate = LocalDate.parse(request.getParameter("endDate"));
                    int usageCount = Integer.parseInt(request.getParameter("usageCount"));
                    String updateDescription = request.getParameter("description");
                    updatePromotion(promotionId, updateCode, updateDiscount, updateStartDate, updateEndDate, usageCount, updateDescription);
                    break;
                case "delete":
                    int deletePromotionId = Integer.parseInt(request.getParameter("promotionId"));
                    deletePromotion(deletePromotionId);
                    break;
                case "track":
                    String trackCode = request.getParameter("code");
                    trackPromotion(trackCode, response);
                    return; // Don't redirect, print directly
            }
        }

        response.sendRedirect(request.getContextPath() + "/marketing");
    }

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession();

        LinkedList<Promotion> allPromotions = new LinkedList<>();
        LinkedList<Advertisement> allAdvertisements = new LinkedList<>();
        try {
            allPromotions = PromotionDAO.getPromotions();
            allAdvertisements = AdvertisementDAO.getAdvertisements();
        } catch (SQLException e) {
            throw new RuntimeException("Database error: " + e.getMessage());
        }

        req.setAttribute("allPromotions", allPromotions);
        req.setAttribute("allAdvertisements", allAdvertisements);
        RequestDispatcher rd = req.getRequestDispatcher("admin/ManageMarketing.jsp");
        rd.forward(req, resp);
    }

    private void handleAdvertisementAction(HttpServletRequest request, HttpServletResponse response, String action) throws IOException, ServletException {
        switch (action) {
            case "add":
                String title = request.getParameter("title");
                String content = request.getParameter("content");
                String imageUrl = request.getParameter("imageUrl");
                LocalDate startDate = LocalDate.parse(request.getParameter("startDate"));
                LocalDate endDate = LocalDate.parse(request.getParameter("endDate"));
                boolean active = Boolean.parseBoolean(request.getParameter("active"));
                byte[] imageData = handleFileUpload(request);
                addAdvertisement(title, content, imageData, imageUrl, startDate, endDate, active);
                break;
            case "update":
                int adId = Integer.parseInt(request.getParameter("adId"));
                String updateTitle = request.getParameter("title");
                String updateContent = request.getParameter("content");
                String updateImageUrl = request.getParameter("imageUrl");
                LocalDate updateStartDate = LocalDate.parse(request.getParameter("startDate"));
                LocalDate updateEndDate = LocalDate.parse(request.getParameter("endDate"));
                boolean updateActive = Boolean.parseBoolean(request.getParameter("active"));
                byte[] updateImageData = handleFileUpload(request);
                updateAdvertisement(adId, updateTitle, updateContent, updateImageData, updateImageUrl, updateStartDate, updateEndDate, updateActive);
                break;
            case "delete":
                int deleteAdId = Integer.parseInt(request.getParameter("adId"));
                deleteAdvertisement(deleteAdId);
                break;
        }
    }

    private void addPromotion(String code, double discount, LocalDate startDate, LocalDate endDate, String description) {
        try {
            Promotion promotion = new Promotion(code, discount, startDate, endDate, 0, description);
            PromotionDAO.addPromotion(promotion);
        } catch (SQLException | IOException e) {
            System.out.println("SQL Issue! Promotion not Added! " + e.getMessage());
        }
    }

    private void updatePromotion(int promotionId, String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) {
        try {
            PromotionDAO.updatePromotion(promotionId, code, discount, startDate, endDate, usageCount, description);
        } catch (SQLException | IOException e) {
            System.out.println("Promotion Update Failed. SQL Error: " + e.getMessage());
        }
    }

    private void deletePromotion(int promotionId) {
        try {
            Promotion promo = PromotionDAO.findPromotionById(promotionId);
            PromotionDAO.removePromotion(promo);
        } catch (SQLException | IOException e) {
            System.out.println("Promotion Delete Failed. SQL Error: " + e.getMessage());
        }
    }

    private void trackPromotion(String code, HttpServletResponse response) throws IOException {
        try {
            int usage = PromotionDAO.trackUsage(code);
            response.getWriter().println("Usage count for promo " + code + ": " + usage);
        } catch (SQLException e) {
            System.out.println("Tracking Failed. SQL Error: " + e.getMessage());
            response.getWriter().println("Error tracking promo.");
        }
    }

    private void addAdvertisement(String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        try {
            Advertisement ad = new Advertisement(title, content, imageData, imageUrl, startDate, endDate, active);
            AdvertisementDAO.addAdvertisement(ad);
        } catch (SQLException | IOException e) {
            System.out.println("SQL Issue! Advertisement not Added! " + e.getMessage());
        }
    }

    private void updateAdvertisement(int adId, String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        try {
            AdvertisementDAO.updateAdvertisement(adId, title, content, imageData, imageUrl, startDate, endDate, active);
        } catch (SQLException | IOException e) {
            System.out.println("Advertisement Update Failed. SQL Error: " + e.getMessage());
        }
    }

    private void deleteAdvertisement(int adId) {
        try {
            AdvertisementDAO.deleteAdvertisement(adId);
        } catch (SQLException | IOException e) {
            System.out.println("Advertisement Delete Failed. SQL Error: " + e.getMessage());
        }
    }

    private byte[] handleFileUpload(HttpServletRequest request) throws IOException, ServletException {
        Part filePart = request.getPart("imageFile");
        if (filePart == null || filePart.getSize() == 0) {
            return null; // No new image uploaded
        }

        String fileName = extractFileName(filePart);
        String extension = fileName.substring(fileName.lastIndexOf(".")).toLowerCase();
        if (!isValidExtension(extension)) {
            throw new ServletException("Invalid file type. Only PNG, JPG, and JPEG are allowed.");
        }

        try (InputStream input = filePart.getInputStream()) {
            return input.readAllBytes();
        }
    }

    private String extractFileName(Part part) {
        String contentDisp = part.getHeader("content-disposition");
        String[] items = contentDisp.split(";");
        for (String s : items) {
            if (s.trim().startsWith("filename")) {
                return s.substring(s.indexOf("=") + 2, s.length() - 1);
            }
        }
        return "";
    }

    private boolean isValidExtension(String extension) {
        for (String allowedExt : ALLOWED_EXTENSIONS) {
            if (allowedExt.equals(extension)) {
                return true;
            }
        }
        return false;
    }

}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\LoginServlet.java
File type: .java
package controller.UserAuth;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.*;
import model.User;
import dao.UserDAO;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.SQLException;

@WebServlet("/LoginServlet")
public class LoginServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String email = request.getParameter("email");
        String password = request.getParameter("password");
        boolean remember = Boolean.parseBoolean(request.getParameter("remember-me"));

        if (email == null || password == null) {
            response.sendRedirect("login.jsp");
        }

        User loginUser = null;

        try {
            loginUser = UserDAO.findUserByEmail(email);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        if (loginUser == null) {
            request.setAttribute("error", "Incorrect Email or Password");
            RequestDispatcher rd = request.getRequestDispatcher("login.jsp");
            rd.forward(request, response);
        } else if (PasswordUtil.checkPassword(password, loginUser.getPassword())) {
            HttpSession session = request.getSession();
            session.setAttribute("USER", loginUser);

            if (remember) {
                Cookie cookie = new Cookie("userId", String.valueOf(loginUser.getUserId()));
                cookie.setMaxAge(60 * 60 * 24 * 7);
                response.addCookie(cookie);
            }

            response.sendRedirect("index.jsp");
        } else {
            request.setAttribute("error", "Wrong password");
            RequestDispatcher rd = request.getRequestDispatcher("login.jsp");
            rd.forward(request, response);
        }
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\LogoutServlet.java
File type: .java
package controller.UserAuth;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.*;

import java.io.IOException;

@WebServlet("/LogoutServlet")
public class LogoutServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        HttpSession session = request.getSession(false);
        if (session != null) {
            session.invalidate();
        }

        // Remove cookie
        Cookie cookie = new Cookie("userId", "");
        cookie.setMaxAge(0);
        response.addCookie(cookie);

        response.sendRedirect(request.getContextPath() + "/index.jsp");
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\filters\AdminFilter.java
File type: .java
package controller.UserAuth.filters;

import dao.UserDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.User;

import java.io.IOException;
import java.sql.SQLException;

@WebFilter("/admin/*")
public class AdminFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
                         FilterChain chain) throws IOException, ServletException {

        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse res = (HttpServletResponse) response;
        HttpSession session = req.getSession(false);

        // Check if user is logged in
        if (session == null || session.getAttribute("USER") == null) {
            System.out.println("No user session found - redirecting to login");
            res.sendRedirect(req.getContextPath() + "/login.jsp");
            return;
        }

        User user = (User) session.getAttribute("USER");

        // Check if user is admin
        if (user != null && user.isAdmin()) {
            System.out.println("User is Admin: " + user.getFirstName() + " is Logged");
            chain.doFilter(request, response);
        } else {
            System.out.println("User is not Admin or user is null");
            res.sendRedirect(req.getContextPath() + "/");
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\filters\AuthFilter.java
File type: .java
package controller.UserAuth.filters;

import dao.UserDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.User;

import java.io.IOException;
import java.sql.SQLException;

@WebFilter("/*")
public class AuthFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
                         FilterChain chain) throws IOException, ServletException {

        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse res = (HttpServletResponse) response;
        HttpSession session = req.getSession(false);

        // If no session but cookie exists
        if (session == null || session.getAttribute("USER") == null) {
            Cookie[] cookies = req.getCookies();
            if (cookies != null) {
                for (Cookie cookie : cookies) {
                    if ("userId".equals(cookie.getName())) {
                        session = req.getSession(true);

                        try {
                            User user = UserDAO.findUserById(Integer.parseInt(cookie.getValue()));
                            session.setAttribute("USER", user);
                        } catch (SQLException e) {
                            throw new RuntimeException(e);
                        }
                    }
                }
            }
        }

        chain.doFilter(request, response);
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserManagement\ManageUserServlet.java
File type: .java
package controller.UserManagement;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import model.Admin;
import model.User;
import dao.UserDAO;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.SQLException;
import java.util.LinkedList;

@WebServlet("/manageUsers")
public class ManageUserServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String action = request.getParameter("action");

        String firstName = request.getParameter("firstName");
        String lastName = request.getParameter("lastName");
        String email = request.getParameter("email");
        String phone = request.getParameter("phoneNumber");
        String password = request.getParameter("password");
        String role = request.getParameter("role");

        String newPassword = request.getParameter("editPassword");

        switch (action) {
            case "add":
                addUser(firstName, lastName, email, password, role);
                break;
            case "update":
                updateUser(firstName, lastName, email, newPassword, role);
                break;
            case "delete":
                // TO DO
                break;
        }

        response.sendRedirect(request.getContextPath() + "/manageUsers");

    }

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        LinkedList<User> allUsers = new LinkedList<>();

        try {
            allUsers = UserDAO.getUsers();
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        req.setAttribute("allUsers", allUsers);
        RequestDispatcher rd = req.getRequestDispatcher("/admin/ManageUsers.jsp");
        rd.forward(req, resp);
    }

    private void addUser(String firstName,
                         String lastName,
                         String email,
                         String password,
                         String role) {

        String passwordHash = PasswordUtil.hashPassword(password);

        switch (role) {
            case "admin" :
                try {
                    Admin admin = new Admin(firstName, lastName, email, passwordHash);
                    UserDAO.addUser(admin);
                    break;
                } catch (SQLException | IOException e) {
                    System.out.println("SQL Issue! Admin User not Added! ");
                }
            case "user":
                try {
                    User user = new User(firstName, lastName, email, passwordHash);
                    UserDAO.addUser(user);
                    break;
                } catch (SQLException | IOException e){
                    System.out.println("SQL Issue! User not Added! ");
            }
        }

    }

    private void updateUser(String firstName,
                         String lastName,
                         String email,
                         String newPassword,
                         String role) {

        try {

            User user = UserDAO.findUserByEmail(email);

            if (user != null) {
                UserDAO.updateUser(user.getUserId(), firstName, lastName, email, role);

                if (!(newPassword.isEmpty())) {
                    UserDAO.updateUserPassword(user.getUserId(), newPassword);
                }
            }

        } catch (SQLException | IOException e) {
            System.out.println("User Update Failed. SQL Error");
        }
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserManagement\RegisterServlet.java
File type: .java
package controller.UserManagement;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import model.User;
import dao.UserDAO;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.SQLException;

@WebServlet("/RegisterServlet")
public class RegisterServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String firstName = request.getParameter("first-name");
        String lastName = request.getParameter("last-name");
        String email = request.getParameter("email");
        String password = request.getParameter("password");
        String likedGenre = request.getParameter("signup-genre");

        // Hashing the Password using Bcrypt
        String passwordHash = PasswordUtil.hashPassword(password);

        User user = new User(firstName, lastName, email, passwordHash);
        user.addLikedGenre(likedGenre);

        try {
            UserDAO.addUser(user);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
        System.out.println("User added Successfully");

        response.sendRedirect("login.jsp");

    }

}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\AdvertisementDAO.java
File type: .java
package dao;

import model.Advertisement;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.time.LocalDate;
import java.util.LinkedList;

public class AdvertisementDAO {

    static {
        ensureTableExists();
    }

    public static LinkedList<Advertisement> getAdvertisements() throws SQLException {
        LinkedList<Advertisement> allAds = new LinkedList<>();
        String sql = "SELECT * FROM advertisements";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                allAds.add(createAdvertisementFromResultSet(rs));
            }
        }

        return allAds;
    }

    public static LinkedList<Advertisement> getActiveAdvertisements() throws SQLException {
        LinkedList<Advertisement> activeAds = new LinkedList<>();
        String sql = "SELECT * FROM advertisements WHERE active = 1 AND startDate <= ? AND endDate >= ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            LocalDate now = LocalDate.now();
            pstmt.setDate(1, Date.valueOf(now));
            pstmt.setDate(2, Date.valueOf(now));

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                activeAds.add(createAdvertisementFromResultSet(rs));
            }
        }

        return activeAds;
    }

    public static void addAdvertisement(Advertisement ad) throws IOException, SQLException {
        if (ad != null) {
            try (Connection con = DatabaseConnection.getConnection()) {
                String sql = "INSERT INTO advertisements (title, content, imageData, imageUrl, startDate, endDate, active) VALUES (?, ?, ?, ?, ?, ?, ?)";
                PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);

                pstmt.setString(1, ad.getTitle());
                pstmt.setString(2, ad.getContent());
                if (ad.getImageData() != null) {
                    pstmt.setBytes(3, ad.getImageData());
                } else {
                    pstmt.setNull(3, Types.BINARY);
                }
                pstmt.setString(4, ad.getImageUrl());
                pstmt.setDate(5, Date.valueOf(ad.getStartDate()));
                pstmt.setDate(6, Date.valueOf(ad.getEndDate()));
                pstmt.setBoolean(7, ad.isActive());

                int result = pstmt.executeUpdate();

                try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                    if (generatedKeys.next()) {
                        ad.setAdId(generatedKeys.getInt(1));
                    }
                }
            }
        }
    }

    public static void updateAdvertisement(int adId, String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) throws IOException, SQLException {
        // Initialize StringBuilder for dynamic SQL query
        StringBuilder sql = new StringBuilder("UPDATE advertisements SET title = ?, content = ?, imageUrl = ?, startDate = ?, endDate = ?, active = ?");

        int paramIndex = 7;

        if (imageData != null) {
            sql.append(", imageData = ?");
        }
        sql.append(" WHERE adId = ?");

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql.toString())) {

            pstmt.setString(1, title);
            pstmt.setString(2, content);
            pstmt.setString(3, imageUrl);
            pstmt.setDate(4, Date.valueOf(startDate));
            pstmt.setDate(5, Date.valueOf(endDate));
            pstmt.setBoolean(6, active);

            // Set imageData parameter only if it is not null
            if (imageData != null) {
                pstmt.setBytes(paramIndex++, imageData);
            }

            // Set adId parameter
            pstmt.setInt(paramIndex, adId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating advertisement failed, no rows affected.");
            }
        }
    }

    public static void deleteAdvertisement(int adId) throws IOException, SQLException {
        String sql = "DELETE FROM advertisements WHERE adId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, adId);
            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Deleting advertisement failed, no rows affected.");
            }
        }
    }

    public static Advertisement findAdvertisementById(int adId) throws SQLException {
        String sql = "SELECT * FROM advertisements WHERE adId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, adId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createAdvertisementFromResultSet(rs);
                }
            }
        }
        return null;
    }

    private static Advertisement createAdvertisementFromResultSet(ResultSet rs) throws SQLException {
        return new Advertisement(
                rs.getInt("adId"),
                rs.getString("title"),
                rs.getString("content"),
                rs.getBytes("imageData"),
                rs.getString("imageUrl"),
                rs.getDate("startDate").toLocalDate(),
                rs.getDate("endDate").toLocalDate(),
                rs.getBoolean("active")
        );
    }

    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'advertisements') " +
                            "CREATE TABLE advertisements (" +
                            "adId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "title VARCHAR(100), " +
                            "content VARCHAR(255), " +
                            "imageData VARBINARY(MAX), " +
                            "imageUrl VARCHAR(255), " +
                            "startDate DATE, " +
                            "endDate DATE, " +
                            "active BIT" +
                            ")"
            );
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\CartDAO.java
File type: .java
package dao;

import java.sql.*;
import java.util.*;
import utils.DatabaseConnection;

public class CartDAO {

    static {
        ensureTableExists();
    }

    public void addToCart(int userId, int trackId, int quantity) throws SQLException {
        try (Connection conn = DatabaseConnection.getConnection()) {
            PreparedStatement stmt = conn.prepareStatement(
                    "IF EXISTS (SELECT 1 FROM carts WHERE user_id=? AND product_id=?) " +
                            "UPDATE carts SET quantity = quantity + ? WHERE user_id=? AND product_id=? " +
                            "ELSE INSERT INTO carts (user_id, product_id, quantity) VALUES (?, ?, ?)"
            );
            stmt.setInt(1, userId);
            stmt.setInt(2, trackId);
            stmt.setInt(3, quantity);
            stmt.setInt(4, userId);
            stmt.setInt(5, trackId);
            stmt.setInt(6, userId);
            stmt.setInt(7, trackId);
            stmt.setInt(8, quantity);
            stmt.executeUpdate();
        }
    }

    public void removeFromCart(int userId, int trackId) throws SQLException {
        try (Connection conn = DatabaseConnection.getConnection()) {
            PreparedStatement stmt = conn.prepareStatement(
                    "DELETE FROM carts WHERE user_id=? AND product_id=?"
            );
            stmt.setInt(1, userId);
            stmt.setInt(2, trackId);
            stmt.executeUpdate();
        }
    }

    public List<Map<String, Object>> getCartItems(int userId) throws SQLException {
        List<Map<String, Object>> items = new ArrayList<>();
        try (Connection conn = DatabaseConnection.getConnection()) {
            PreparedStatement stmt = conn.prepareStatement(
                    "SELECT c.product_id AS trackId, c.quantity, p.title, p.artist, p.price " +
                            "FROM carts c JOIN products p ON c.product_id = p.id " +
                            "WHERE c.user_id = ?"
            );
            stmt.setInt(1, userId);
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                Map<String, Object> item = new HashMap<>();
                item.put("trackId", rs.getInt("trackId"));
                item.put("quantity", rs.getInt("quantity"));
                item.put("title", rs.getString("title"));
                item.put("artist", rs.getString("artist"));
                item.put("price", rs.getDouble("price"));
                items.add(item);
            }
        }
        return items;
    }
    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {

            // Create carts table
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'carts') " +
                            "CREATE TABLE carts (" +
                            "id INT IDENTITY(1,1) PRIMARY KEY, " +
                            "user_id INT NOT NULL, " +
                            "product_id INT NOT NULL, " +
                            "quantity INT NOT NULL DEFAULT 1, " +
                            "FOREIGN KEY (user_id) REFERENCES users(userId) ON DELETE CASCADE, " +
                            "FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE CASCADE" +
                            ")"
            );

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

    }

}



--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\PromotionDAO.java
File type: .java
package dao;

import model.Promotion;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.time.LocalDate;
import java.util.LinkedList;

public class PromotionDAO {

    static {
        ensureTableExists();
    }

    public static LinkedList<Promotion> getPromotions() throws SQLException {
        LinkedList<Promotion> allPromotions = new LinkedList<>();
        String sql = "SELECT * FROM promotions";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                allPromotions.add(createPromotionFromResultSet(rs));
            }
        }

        return allPromotions;
    }

    public static void addPromotion(Promotion promotion) throws IOException, SQLException {
        if (promotion != null) {
            try (Connection con = DatabaseConnection.getConnection()) {
                System.out.println("Connected to Database!");

                String sql = "INSERT INTO promotions (code, discount, startDate, endDate, usageCount, description) VALUES (?, ?, ?, ?, ?, ?)";
                PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);

                pstmt.setString(1, promotion.getCode());
                pstmt.setDouble(2, promotion.getDiscount());
                pstmt.setDate(3, Date.valueOf(promotion.getStartDate()));
                pstmt.setDate(4, Date.valueOf(promotion.getEndDate()));
                pstmt.setInt(5, promotion.getUsageCount());
                pstmt.setString(6, promotion.getDescription());

                int result = pstmt.executeUpdate();

                System.out.println("Number of changes made " + result);

                try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                    if (generatedKeys.next()) {
                        promotion.setPromotionId(generatedKeys.getInt(1));
                    }
                }
            }
        }
    }

    public static void removePromotion(Promotion promotion) throws IOException, SQLException {
        if (promotion == null) {
            throw new IllegalArgumentException("Promotion cannot be null");
        }

        String sql = "DELETE FROM promotions WHERE promotionId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, promotion.getPromotionId());
            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Deleting promotion failed, no rows affected.");
            }

            System.out.println("Promotion deleted successfully. Rows affected: " + affectedRows);
        }
    }

    public static Promotion findPromotionById(int promotionId) throws SQLException {
        String sql = "SELECT * FROM promotions WHERE promotionId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, promotionId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createPromotionFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static Promotion findPromotionByCode(String code) throws SQLException {
        String sql = "SELECT * FROM promotions WHERE code = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createPromotionFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static void updatePromotion(int promotionId, String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) throws IOException, SQLException {
        String sql = "UPDATE promotions SET code = ?, discount = ?, startDate = ?, endDate = ?, usageCount = ?, description = ? WHERE promotionId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);
            pstmt.setDouble(2, discount);
            pstmt.setDate(3, Date.valueOf(startDate));
            pstmt.setDate(4, Date.valueOf(endDate));
            pstmt.setInt(5, usageCount);
            pstmt.setString(6, description);
            pstmt.setInt(7, promotionId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating promotion failed, no rows affected.");
            }

            System.out.println("Promotion updated successfully. Rows affected: " + affectedRows);
        }
    }

    public static void incrementUsageCount(String code) throws SQLException {
        String sql = "UPDATE promotions SET usageCount = usageCount + 1 WHERE code = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating usage count failed, no rows affected.");
            }

            System.out.println("Promotion usage count incremented successfully. Rows affected: " + affectedRows);
        }
    }

    public static int trackUsage(String code) throws SQLException {
        String sql = "SELECT COUNT(*) FROM bookings WHERE promoCode = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return rs.getInt(1);
                }
            }
        }
        return 0;
    }

    private static Promotion createPromotionFromResultSet(ResultSet rs) throws SQLException {
        return new Promotion(
                rs.getInt("promotionId"),
                rs.getString("code"),
                rs.getDouble("discount"),
                rs.getDate("startDate").toLocalDate(),
                rs.getDate("endDate").toLocalDate(),
                rs.getInt("usageCount"),
                rs.getString("description")
        );
    }

    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {

            // Create promotions table if it doesn't exist
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'promotions') " +
                            "BEGIN " +
                            "CREATE TABLE promotions (" +
                            "promotionId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "code VARCHAR(50) UNIQUE, " +
                            "discount DECIMAL(10,2), " +   // updated for larger amounts
                            "startDate DATE, " +
                            "endDate DATE, " +
                            "usageCount INT, " +
                            "description VARCHAR(255)" +
                            ")" +
                            "END"
            );
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\TrackDAO.java
File type: .java
package dao;

import model.Track;
import utils.DatabaseConnection;

import java.sql.*;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public class TrackDAO {

    static {
        ensureTableExists();
    }

    public static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {
            // Create tracks table
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'tracks') " +
                            "CREATE TABLE tracks (" +
                            "trackId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "title VARCHAR(50), " +
                            "artist VARCHAR(50), " +
                            "genre VARCHAR(20), " +
                            "rating FLOAT, " +
                            "price DECIMAL(10,2)" +
                            ")"
            );
        } catch (SQLException e) {
            throw new RuntimeException("Error creating tracks table", e);
        }
    }

    public static LinkedList<Track> getAllTracks() throws SQLException {
        LinkedList<Track> tracks = new LinkedList<>();
        String sql = "SELECT * FROM tracks";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql);
             ResultSet rs = pstmt.executeQuery()) {

            while (rs.next()) {
                Track track = new Track(
                        rs.getString("title"),
                        rs.getString("artist")
                );
                track.setTrackId(rs.getInt("trackId"));
                track.setPrice(rs.getDouble("price"));
                track.setGenre(rs.getString("genre"));
                track.setRating(rs.getDouble("rating"));
                tracks.add(track);
            }
        }
        return tracks;
    }

    public static List<Track> getAllTracksPaginated(int page, int pageSize) throws SQLException {
        List<Track> tracks = new ArrayList<>();
        String sql = "SELECT * FROM tracks ORDER BY trackId OFFSET ? ROWS FETCH NEXT ? ROWS ONLY";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, (page - 1) * pageSize);
            pstmt.setInt(2, pageSize);

            try (ResultSet rs = pstmt.executeQuery()) {
                while (rs.next()) {
                    Track track = new Track(
                            rs.getString("title"),
                            rs.getString("artist")
                    );
                    track.setTrackId(rs.getInt("trackId"));
                    track.setPrice(rs.getDouble("price"));
                    track.setGenre(rs.getString("genre"));
                    track.setRating(rs.getDouble("rating"));
                    tracks.add(track);
                }
            }
        }
        return tracks;
    }

    public static int countAllTracks() throws SQLException {
        String sql = "SELECT COUNT(*) FROM tracks";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql);
             ResultSet rs = pstmt.executeQuery()) {

            if (rs.next()) {
                return rs.getInt(1);
            }
        }
        return 0;
    }

    public static void addTrack(Track track) throws SQLException {
        if (track == null) return;

        String sql = "INSERT INTO tracks (title, artist, price, genre, rating) VALUES (?, ?, ?, ?, ?)";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS)) {

            pstmt.setString(1, track.getTitle());
            pstmt.setString(2, track.getArtist());
            pstmt.setDouble(3, track.getPrice());
            pstmt.setString(4, track.getGenre());
            pstmt.setDouble(5, track.getRating());
            pstmt.executeUpdate();

            try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                if (generatedKeys.next()) {
                    track.setTrackId(generatedKeys.getInt(1));
                }
            }
        }
    }

    public static void removeTrack(int trackId) throws SQLException {
        String sql = "DELETE FROM tracks WHERE trackId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, trackId);
            pstmt.executeUpdate();
        }
    }

    public static Track findTrackById(int trackId) throws SQLException {
        String sql = "SELECT * FROM tracks WHERE trackId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, trackId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    Track track = new Track(
                            rs.getString("title"),
                            rs.getString("artist")
                    );
                    track.setTrackId(rs.getInt("trackId"));
                    track.setPrice(rs.getDouble("price"));
                    track.setGenre(rs.getString("genre"));
                    track.setRating(rs.getDouble("rating"));
                    return track;
                }
            }
        }
        return null;
    }

    public static void updateTrack(Track track) throws SQLException {
        if (track == null) return;

        String sql = "UPDATE tracks SET title = ?, artist = ?, price = ?, genre = ?, rating = ? WHERE trackId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, track.getTitle());
            pstmt.setString(2, track.getArtist());
            pstmt.setDouble(3, track.getPrice());
            pstmt.setString(4, track.getGenre());
            pstmt.setDouble(5, track.getRating());
            pstmt.setInt(6, track.getTrackId());
            pstmt.executeUpdate();
        }
    }

    public static List<Track> searchProducts(String title,
                                             String genre,
                                             Double minPrice,
                                             Double maxPrice,
                                             Double rating,
                                             int page,
                                             int pageSize) {

        List<Track> list = new ArrayList<>();
        StringBuilder sql = new StringBuilder("SELECT * FROM tracks WHERE 1=1");
        List<Object> params = new ArrayList<>();

        if (title != null && !title.isEmpty()) {
            sql.append(" AND title LIKE ?");
            params.add("%" + title + "%");
        }

        if (genre != null && !genre.isEmpty()) {
            sql.append(" AND genre = ?");
            params.add(genre);
        }

        if (minPrice != null) {
            sql.append(" AND price >= ?");
            params.add(minPrice);
        }
        if (maxPrice != null) {
            sql.append(" AND price <= ?");
            params.add(maxPrice);
        }

        if (rating != null) {
            sql.append(" AND rating >= ?");
            params.add(rating);
        }

        sql.append(" ORDER BY trackId OFFSET ? ROWS FETCH NEXT ? ROWS ONLY");
        params.add((page - 1) * pageSize);
        params.add(pageSize);

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(sql.toString())) {

            for (int i = 0; i < params.size(); i++) {
                ps.setObject(i + 1, params.get(i));
            }

            ResultSet rs = ps.executeQuery();
            while (rs.next()) {
                list.add(new Track(
                        rs.getInt("trackId"),
                        rs.getString("title"),
                        rs.getString("artist"),
                        rs.getDouble("price"),
                        rs.getString("genre"),
                        rs.getDouble("rating")
                ));
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return list;
    }

    public static int countProducts(String title,
                                    String genre,
                                    Double minPrice,
                                    Double maxPrice) {

        StringBuilder sql = new StringBuilder("SELECT COUNT(*) FROM tracks WHERE 1=1");
        List<Object> params = new ArrayList<>();

        if (title != null && !title.isEmpty()) {
            sql.append(" AND title LIKE ?");
            params.add("%" + title + "%");
        }
        if (genre != null && !genre.isEmpty()) {
            sql.append(" AND genre = ?");
            params.add(genre);
        }

        if (minPrice != null) {
            sql.append(" AND price >= ?");
            params.add(minPrice);
        }
        if (maxPrice != null) {
            sql.append(" AND price <= ?");
            params.add(maxPrice);
        }

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(sql.toString())) {

            for (int i = 0; i < params.size(); i++) {
                ps.setObject(i + 1, params.get(i));
            }

            ResultSet rs = ps.executeQuery();
            if (rs.next()) return rs.getInt(1);

        } catch (Exception e) {
            e.printStackTrace();
        }

        return 0;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\UserDAO.java
File type: .java
package dao;

import model.Admin;
import model.User;
import utils.DatabaseConnection;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.*;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.LinkedList;
import java.util.List;

public class UserDAO {

    static {
        ensureTableExists();
    }

    public static LinkedList<User> getUsers() throws SQLException {
        LinkedList<User> allUsers = new LinkedList<>();
        String sql = "SELECT * From users";

        try (Connection con = DatabaseConnection.getConnection();
        PreparedStatement pstmt = con.prepareStatement(sql)) {

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                allUsers.add(createUserFromResultSet(rs));
            }
        }

        return allUsers;
    }

    public static void addUser(User user) throws IOException, SQLException {
        if (user != null) {
            try (Connection con = DatabaseConnection.getConnection()) {
                System.out.println("Connected to Database!");

                String sql = "INSERT INTO users (role, firstName, lastName, email, password) VALUES (?, ?, ?, ?, ?)";
                PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);

                    pstmt.setString(1, user.isAdmin() ? "adminUser" : "standardUser");
                    pstmt.setString(2, user.getFirstName());
                    pstmt.setString(3, user.getLastName());
                    pstmt.setString(4, user.getEmail());
                    pstmt.setString(5, user.getPassword());

                    int result = pstmt.executeUpdate();

                System.out.println("Number of changes made " + result);

                try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                    if (generatedKeys.next()) {
                        user.setUserId(generatedKeys.getInt(1));
                    }
                }

                // insert Liked Genres to table
                if (user.getLikedGenres() != null) {
                    String genreSql = "INSERT INTO UserGenres (userId, genre) VALUES (?, ?)";
                    try (PreparedStatement ps2 = con.prepareStatement(genreSql)) {
                        for (String genre : user.getLikedGenres()) {
                            ps2.setInt(1, user.getUserId());
                            ps2.setString(2, genre);
                            ps2.addBatch();
                        }
                        ps2.executeBatch();
                    }
                }
            }
        }
    }

    public static void removeUser(User user) throws IOException, SQLException {
        if (user == null) {
            throw new IllegalArgumentException("User cannot be null");
        }

        String sql = "DELETE FROM users WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, user.getUserId());
            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Deleting user failed, no rows affected.");
            }

            System.out.println("User deleted successfully. Rows affected: " + affectedRows);
        }
    }

    public static User findUserById(int userId) throws SQLException {
        String sql = "SELECT * FROM users WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, userId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createUserFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static User findUserByEmail(String email) throws SQLException {
        String sql = "SELECT * FROM users WHERE email = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, email);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createUserFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static void updateUser(int userId, String firstName, String lastName, String email, String role) throws IOException, SQLException {
        String sql = "UPDATE users SET firstName = ?, lastName = ?, email = ?, role = ? WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, firstName);
            pstmt.setString(2, lastName);
            pstmt.setString(3, email);
            pstmt.setString(4, (role.equals("admin")) ? "adminUser" : "standardUser");
            pstmt.setInt(5, userId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating user failed, no rows affected.");
            }

            System.out.println("User updated successfully. Rows affected: " + affectedRows);
        }
    }

    public static void updateUserPassword(int userId, String newPassword) throws IOException, SQLException {
        String sql = "UPDATE users SET password = ? WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            String hashPassword = PasswordUtil.hashPassword(newPassword);

            pstmt.setString(1, hashPassword);
            pstmt.setInt(5, userId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating user failed, no rows affected.");
            }

            System.out.println("User updated successfully. Rows affected: " + affectedRows);
        }
    }

    private static User createUserFromResultSet(ResultSet rs) throws SQLException {
        boolean isAdmin = "adminUser".equals(rs.getString("role"));

        if (isAdmin) {
            Admin admin = new Admin(
                    rs.getInt("userId"),
                    rs.getString("firstName"),
                    rs.getString("lastName"),
                    rs.getString("email"),
                    rs.getString("password")
            );

            admin.setLikedGenres(getUserLikedGenres(rs.getInt("userId")));
            return admin;

        } else {
            User user = new User(
                    rs.getInt("userId"),
                    rs.getString("firstName"),
                    rs.getString("lastName"),
                    rs.getString("email"),
                    rs.getString("password")
            );

            user.setLikedGenres(getUserLikedGenres(rs.getInt("userId")));
            return user;

        }
    }



    private static List<String> getUserLikedGenres(int userId) throws SQLException {
        List<String> genres = new ArrayList<>();
        try (Connection conn = DatabaseConnection.getConnection()) {
            String genreSql = "SELECT genre FROM UserGenres WHERE userId=?";

            try (PreparedStatement ps = conn.prepareStatement(genreSql)) {
                ps.setInt(1, userId);
                ResultSet rs = ps.executeQuery();

                while (rs.next()) {
                    genres.add(rs.getString("genre"));
                }
            }
        }
        return genres;
    }

    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {
            // Create users table
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'users') " +
                            "CREATE TABLE users (" +
                            "userId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "role VARCHAR(20), " +
                            "firstName VARCHAR(50), " +
                            "lastName VARCHAR(50), " +
                            "email VARCHAR(100) UNIQUE, " +
                            "password VARCHAR(255)" +
                            ")"
            );

            // Create UserGenres table
            stmt.executeUpdate("IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'UserGenres') " +
                    "CREATE TABLE UserGenres (" +
                    "id INT PRIMARY KEY IDENTITY, " +
                    "userId INT, " +
                    "genre VARCHAR(50), " +
                    "FOREIGN KEY (userId) REFERENCES users(userId) ON DELETE CASCADE" +
                    ")"
            );

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

}
 

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Admin.java
File type: .java
package model;

public class Admin extends User {
    public Admin(String firstName, String lastName, String email, String password) {
        super(firstName, lastName, email, password);
    }

    public Admin(int userId, String firstName, String lastName, String email, String password) {
        super(userId, firstName, lastName, email, password);
    }

    @Override
    public boolean isAdmin() {
        return true;
    }

    @Override
    public String getRoleDescription() {
        return "Administrator";
    }

}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Advertisement.java
File type: .java
package model;

import java.time.LocalDate;

public class Advertisement {
    private int adId;
    private String title;
    private String content;
    private byte[] imageData;
    private String imageUrl; // Optional, for external URLs
    private LocalDate startDate;
    private LocalDate endDate;
    private boolean active;

    public Advertisement(String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        this.title = title;
        this.content = content;
        this.imageData = imageData;
        this.imageUrl = imageUrl;
        this.startDate = startDate;
        this.endDate = endDate;
        this.active = active;
    }

    public Advertisement(int adId, String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        this.adId = adId;
        this.title = title;
        this.content = content;
        this.imageData = imageData;
        this.imageUrl = imageUrl;
        this.startDate = startDate;
        this.endDate = endDate;
        this.active = active;
    }

    // Getters and Setters
    public int getAdId() {
        return adId;
    }

    public void setAdId(int adId) {
        this.adId = adId;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getContent() {
        return content;
    }

    public void setContent(String content) {
        this.content = content;
    }

    public byte[] getImageData() {
        return imageData;
    }

    public void setImageData(byte[] imageData) {
        this.imageData = imageData;
    }

    public String getImageUrl() {
        return imageUrl;
    }

    public void setImageUrl(String imageUrl) {
        this.imageUrl = imageUrl;
    }

    public LocalDate getStartDate() {
        return startDate;
    }

    public void setStartDate(LocalDate startDate) {
        this.startDate = startDate;
    }

    public LocalDate getEndDate() {
        return endDate;
    }

    public void setEndDate(LocalDate endDate) {
        this.endDate = endDate;
    }

    public boolean isActive() {
        return active;
    }

    public void setActive(boolean active) {
        this.active = active;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Promotion.java
File type: .java
package model;

import java.time.LocalDate;

public class Promotion {
    private int promotionId;
    private String code;
    private double discount;
    private LocalDate startDate;
    private LocalDate endDate;
    private int usageCount;
    private String description;

    public Promotion(String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) {
        this.code = code;
        this.discount = discount;
        this.startDate = startDate;
        this.endDate = endDate;
        this.usageCount = usageCount;
        this.description = description;
    }

    public Promotion(int promotionId, String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) {
        this.promotionId = promotionId;
        this.code = code;
        this.discount = discount;
        this.startDate = startDate;
        this.endDate = endDate;
        this.usageCount = usageCount;
        this.description = description;
    }

    // Getters and Setters
    public int getPromotionId() {
        return promotionId;
    }

    public void setPromotionId(int promotionId) {
        this.promotionId = promotionId;
    }

    public String getCode() {
        return code;
    }

    public void setCode(String code) {
        this.code = code;
    }

    public double getDiscount() {
        return discount;
    }

    public void setDiscount(double discount) {
        this.discount = discount;
    }

    public LocalDate getStartDate() {
        return startDate;
    }

    public void setStartDate(LocalDate startDate) {
        this.startDate = startDate;
    }

    public LocalDate getEndDate() {
        return endDate;
    }

    public void setEndDate(LocalDate endDate) {
        this.endDate = endDate;
    }

    public int getUsageCount() {
        return usageCount;
    }

    public void setUsageCount(int usageCount) {
        this.usageCount = usageCount;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Track.java
File type: .java
package model;

public class Track {
    private int trackId;
    private String title;
    private String artist;
    private double price;
    private String genre;
    private double rating;

    public Track(
            int trackId,
            String title,
            String artist,
            double price,
            String genre,
            double rating) {

        this.trackId = trackId;
        this.title = title;
        this.artist = artist;
        this.price = price;
        this.genre = genre;
        this.rating = rating;
    }

    public Track(String title, String artist) {
        this.title = title;
        this.artist = artist;
    }

    public String getGenre() {
        return genre;
    }

    public void setGenre(String genre) {
        this.genre = genre;
    }

    public double getRating() {
        return rating;
    }

    public void setRating(double rating) {
        this.rating = rating;
    }

    public double getPrice() {
        return price;
    }

    public void setPrice(double price) {
        this.price = price;
    }

    public String getArtist() {
        return artist;
    }

    public int getTrackId() {
        return trackId;
    }

    public void setTrackId(int trackId) {
        this.trackId = trackId;
    }

    public void setArtist(String artist) {
        this.artist = artist;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\User.java
File type: .java
package model;

import java.util.ArrayList;
import java.util.List;

public class User {
    protected int userId;
    protected String firstName;
    protected String lastName;
    protected String email;
    protected String password;
    protected List<String> likedGenres = new ArrayList<>();

    public User(String firstName, String lastName, String email, String password) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.email = email;
        this.password = password;
    }

    public User(int userId, String firstName, String lastName, String email, String password) {
        this.userId = userId;
        this.firstName = firstName;
        this.lastName = lastName;
        this.email = email;
        this.password = password;
    }

    public void addLikedGenre(String genre) {
        if (likedGenres.isEmpty()){
            likedGenres.add(genre);
            return;
        }

        if (!(likedGenres.contains(genre)))
            likedGenres.add(genre);
    }

    public List<String> getLikedGenres() {
        return likedGenres;
    }

    public void setLikedGenres(List<String> likedGenres) {
        this.likedGenres = likedGenres;
    }

    public String likedGenreToString() {
        return String.join("|", likedGenres);
    }

    public int getUserId() {
        return userId;
    }

    public void setUserId(int userId) {
        this.userId = userId;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public boolean isAdmin() {
        return false;
    }

    public String getRoleDescription() {
        return "Standard User";
    }

}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\utils\DatabaseConnection.java
File type: .java
package utils;

import com.microsoft.sqlserver.jdbc.SQLServerConnection;

import java.io.IOException;
import java.io.InputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.Properties;

public class DatabaseConnection {
    private static String DB_URL = "jdbc:sqlserver://localhost;instanceName=SQLEXPRESS;database=test1;encrypt=true;trustServerCertificate=true";
    private static String DB_USER = "Prageeth";
    private static String DB_PASSWORD = "1234";

    public static Connection getConnection() throws SQLException {

        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
        } catch (ClassNotFoundException e) {
            System.out.println("Driver not found: " + e.getMessage());
        }

        return DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD);
    }

}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\utils\EmailHandleUtil.java
File type: .java
package utils;
import jakarta.mail.*;
import jakarta.mail.Message;
import jakarta.mail.Session;
import jakarta.mail.Transport;
import jakarta.mail.internet.InternetAddress;
import jakarta.mail.internet.MimeMessage;

import java.util.Properties;

public class EmailHandleUtil {
    public static void sendMail(String to, String subject, String body) throws Exception {
        final String username = "prageethperera2002@gmail.com";   // Your Gmail
        final String password = "bgma yxkv cvsq glzw";    // 16-char app password

        Properties props = new Properties();
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.host", "smtp.gmail.com");
        props.put("mail.smtp.port", "587"); // TLS port

        Session session = Session.getInstance(props, new Authenticator() {
            @Override
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(username, password);
            }
        });

        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress(username));
        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));
        message.setSubject(subject);

        message.setContent(body, "text/html; charset=utf-8");

        Transport.send(message);
        System.out.println("Email sent successfully to " + to);
    }

}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\utils\PasswordUtil.java
File type: .java
package utils;

import org.mindrot.jbcrypt.BCrypt;

public class PasswordUtil {

    // Hash the password
    public static String hashPassword(String plainPassword) {
        return BCrypt.hashpw(plainPassword, BCrypt.gensalt(12));
    }

    // Verify entered password against stored hash
    public static boolean checkPassword(String plainPassword, String hashedPassword) {
        return BCrypt.checkpw(plainPassword, hashedPassword);
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/resources\config.properties
File type: .properties
db.url=jdbc:sqlserver://localhost;instanceName=SQLEXPRESS;database=test1;encrypt=true;trustServerCertificate=true;
db.user=sa
db.pass=1234

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\index.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RhythmWave Music Store</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/index.css">
</head>
<body>

<!-- Navigation Bar -->
<jsp:include page="/includes/navbar.jsp">
    <jsp:param name="page" value="index"/>
    <jsp:param name="user" value="${sessionScope.USER}"/>
</jsp:include>

<!-- Banner Section -->
<div class="container-fluid">
    <div class="banner">
        <c:choose>
            <c:when test="${empty sessionScope.USER}">
                <div class="container text-center">
                    <h1 class="display-4 fw-bold">Discover Your Soundtrack</h1>
                    <p class="lead">Millions of songs at your fingertips. Curated playlists and exclusive releases.</p>
                    <button class="btn btn-primary btn-lg mt-3">Explore Now</button>
                </div>
            </c:when>
            <c:otherwise>
                <div class="container text-center">
                    <h1 class="display-4 fw-bold">Welcome Back! ${sessionScope.USER.firstName}</h1>
                    <p class="lead">Millions of songs at your fingertips. Curated playlists and exclusive releases.</p>
                    <button class="btn btn-primary btn-lg mt-3">Explore Now</button>
                </div>
            </c:otherwise>
        </c:choose>
    </div>
</div>

<!-- Music Listing Section -->
<div class="container">
    <h2 class="mb-4">Featured Music</h2>
    <div class="row">
        <!-- Music Card -->
        <c:forEach var="track" items="${requestScope.trackList}">
            <div class="col-md-4 col-lg-3 mb-3">
                <div class="music-card">
                    <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80" class="album-cover" alt="Album Cover">
                    <div class="p-3">
                        <h5>${track.title}</h5>
                        <p class="artist-name">by ${track.artist}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="price-tag">Rs. ${track.price}</span>
                            <div class="d-flex">
                                <div class="play-btn me-2">
                                    <i class="fas fa-play"></i>
                                </div>
                                <button class="cart-btn" data-track-id="${track.trackId}">
                                    <i class="fas fa-cart-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </c:forEach>

        <c:set var="currentPage" value="${requestScope.currentPage}"/>
        <c:set var="noOfPages" value="${requestScope.noOfPages}"/>

        <!-- Pagination -->
        <c:if test="${noOfPages > 1}">
            <nav class="mt-5">
                <ul class="pagination justify-content-center">
                    <li class="page-item ${currentPage == 1 ? 'disabled' : ''}">
                        <a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${currentPage - 1}">Previous</a>
                    </li>
                    <c:forEach var="i" begin="1" end="${noOfPages}">
                        <c:choose>
                            <c:when test="${i eq currentPage}">
                                <li class="page-item active"><a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${i}">${i}</a></li>
                            </c:when>
                            <c:otherwise>
                                <li class="page-item"><a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${i}">${i}</a></li>
                            </c:otherwise>
                        </c:choose>
                    </c:forEach>
                    <li class="page-item ${currentPage == noOfPages ? 'disabled' : ''}">
                        <a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${currentPage + 1}">Next</a>
                    </li>
                </ul>
            </nav>
        </c:if>
    </div>
</div>

<!-- Footer -->
<jsp:include page="includes/footer.jsp" />

<!-- Shopping Cart Modal -->
<jsp:include page="includes/modals/shoppingCartModal.jsp" />

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="${pageContext.request.contextPath}/js/cart.js"></script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\login.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RhythmWave - Login</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/login.css">
    <style>

    </style>
</head>
<body>
<!-- Auth Container -->
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <div class="auth-icon">
                <i class="fas fa-music"></i>
            </div>
            <h2>Welcome Back</h2>
            <p class="text-secondary">Sign in to your RhythmWave account</p>
        </div>

        <form id="loginForm" action="${pageContext.request.contextPath}/LoginServlet" method="post">
            <div class="mb-3">
                <label for="login-email" class="form-label">Email address</label>
                <input type="email" class="form-control" id="login-email" name="email" placeholder="name@example.com" required>
            </div>

            <div class="mb-3 password-input-group">
                <label for="login-password" class="form-label">Password</label>
                <input type="password" class="form-control" id="login-password" name="password" placeholder="Enter your password" required>
            </div>

            <div class="mb-3 d-flex justify-content-between align-items-center">
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="remember-me" name="remember-me" value="true">
                    <label class="form-check-label" for="remember-me">Remember me</label>
                </div>
                <a href="#" class="text-primary">Forgot password?</a>
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg">Login</button>
                <a href="signup.jsp" class="btn btn-outline-light">Don't have an account? Sign Up</a>
            </div>
        </form>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Form validation
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            if (!email || !password) {
                e.preventDefault()
                alert('Please fill in all fields');
            }

        });
    });
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\searchMusic.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Music - RhythmWave Music Store</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/index.css">
    <style>
        /* Ensure consistency with theme.css and index.css */
        body {
            background-color: var(--dark-bg);
            color: var(--text-primary);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .search-header {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
            url('https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1770&q=80');
            background-size: cover;
            background-position: center;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .search-header h1 {
            color: var(--text-primary);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .input-group input {
            background-color: #2a2a2a;
            border: 1px solid #444;
            color: var(--text-primary);
        }

        .input-group input::placeholder {
            color: var(--placeholder-color);
        }

        .input-group input:focus {
            background-color: #2a2a2a;
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
        }

        .search-section {
            background-color: var(--card-bg);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .filter-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .form-select {
            background-color: #2a2a2a;
            border: 1px solid #444;
            color: var(--text-primary);
            border-radius: 5px;
        }

        .form-select:focus {
            background-color: #2a2a2a;
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
        }

        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
            color: #000;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #9965f4;
            border-color: #9965f4;
            transform: translateY(-2px);
        }

        .btn-outline-secondary {
            border-color: var(--primary);
            color: var(--primary);
            transition: all 0.3s ease;
        }

        .btn-outline-secondary:hover {
            background-color: var(--primary);
            color: #000;
            transform: translateY(-2px);
        }

        .search-results-info {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .no-results {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
            background-color: var(--card-bg);
            border-radius: 10px;
        }

        .no-results i {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
            color: #555;
        }

        .music-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            transition: transform 0.3s, box-shadow 0.3s;
            overflow: hidden;
        }

        .music-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .album-cover {
            width: 100%;
            aspect-ratio: 1/1;
            object-fit: cover;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

        .play-btn, .cart-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .play-btn {
            background-color: var(--primary);
            color: #000;
        }

        .play-btn:hover {
            background-color: #9965f4;
            transform: scale(1.1);
        }

        .play-btn.playing {
            background-color: var(--secondary);
            animation: pulse 0.5s infinite;
        }

        .cart-btn {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .cart-btn:hover {
            background-color: var(--primary);
            color: #000;
            transform: scale(1.1);
        }

        .cart-btn.added {
            background-color: var(--primary);
            color: #000;
        }

        .price-tag {
            color: var(--primary);
            font-weight: bold;
        }

        .artist-name {
            color: var(--secondary);
        }

        /* Animation for play button */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
<!-- Navigation Bar -->
<jsp:include page="/includes/navbar.jsp">
    <jsp:param name="page" value="search"/>
    <jsp:param name="searchBox" value="noShow"/>
</jsp:include>

<!-- Search Header Section -->
<div class="container mt-4">
    <div class="search-header">
        <h1 class="display-5 fw-bold mb-4">Search Our Music Library</h1>
        <!-- Main Search Bar -->
        <div class="row justify-content-center">
            <div class="col-md-8">
                <form action="${pageContext.request.contextPath}/search" method="get">
                    <div class="input-group input-group-lg mb-4">
                        <input type="text" class="form-control" name="query" placeholder="Search artists, albums, or songs..." value="${param.query}">
                        <button class="btn btn-primary" type="submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Advanced Filters Section -->
<div class="container">
    <div class="search-section">
        <h2 class="mb-4">Refine Your Search</h2>
        <form action="${pageContext.request.contextPath}/search" method="get">
            <input type="hidden" name="query" value="${param.query}">
            <div class="row mt-3">
                <div class="col-md-3">
                    <div class="filter-label">Genre</div>
                    <select class="form-select" name="genre">
                        <option value="">All Genres</option>
                        <option value="rock" ${param.genre == 'rock' ? 'selected' : ''}>Rock</option>
                        <option value="pop" ${param.genre == 'pop' ? 'selected' : ''}>Pop</option>
                        <option value="hiphop" ${param.genre == 'hiphop' ? 'selected' : ''}>Hip Hop</option>
                        <option value="electronic" ${param.genre == 'electronic' ? 'selected' : ''}>Electronic</option>
                        <option value="jazz" ${param.genre == 'jazz' ? 'selected' : ''}>Jazz</option>
                        <option value="classical" ${param.genre == 'classical' ? 'selected' : ''}>Classical</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="filter-label">Price Range</div>
                    <select class="form-select" name="price">
                        <option value="">Any Price</option>
                        <option value="under100" ${param.price == 'under100' ? 'selected' : ''}>Under Rs. 100</option>
                        <option value="100-200" ${param.price == '100-200' ? 'selected' : ''}>Rs. 100 - Rs. 200</option>
                        <option value="200-400" ${param.price == '200-400' ? 'selected' : ''}>Rs. 200 - Rs. 400</option>
                        <option value="over400" ${param.price == 'over400' ? 'selected' : ''}>Over Rs. 400</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="filter-label">Release Year</div>
                    <select class="form-select" name="year">
                        <option value="">Any Year</option>
                        <option value="2023" ${param.year == '2023' ? 'selected' : ''}>2023</option>
                        <option value="2022" ${param.year == '2022' ? 'selected' : ''}>2022</option>
                        <option value="2020-2021" ${param.year == '2020-2021' ? 'selected' : ''}>2020-2021</option>
                        <option value="2010-2019" ${param.year == '2010-2019' ? 'selected' : ''}>2010-2019</option>
                        <option value="before2010" ${param.year == 'before2010' ? 'selected' : ''}>Before 2010</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="filter-label">Rating</div>
                    <select class="form-select" name="rating">
                        <option value="">Any Rating</option>
                        <option value="5" ${param.rating == '5' ? 'selected' : ''}>5 Stars</option>
                        <option value="4" ${param.rating == '4' ? 'selected' : ''}>4+ Stars</option>
                        <option value="3" ${param.rating == '3' ? 'selected' : ''}>3+ Stars</option>
                    </select>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-12 text-end">
                    <button type="submit" class="btn btn-primary">Apply Filters</button>
                    <a href="${pageContext.request.contextPath}/search?query=${param.query}" class="btn btn-outline-secondary ms-2">Clear Filters</a>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Search Results Section -->
<div class="container mt-5">
    <c:choose>
        <c:when test="${not empty requestScope.trackList}">
            <div class="search-results-info">
                <h4>${empty param.query ? 'All Tracks' : 'Search Results for "' += param.query += '"'}</h4>
                <p>Found ${fn:length(requestScope.trackList)} results</p>
            </div>
            <div class="row">
                <c:forEach var="track" items="${requestScope.trackList}">
                    <div class="col-md-4 col-lg-3 mb-4">
                        <div class="music-card">
                            <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80" class="album-cover" alt="Album Cover">
                            <div class="p-3">
                                <h5>${track.title}</h5>
                                <p class="artist-name">by ${track.artist}</p>
                                <p class="genre">Genre: ${track.genre}</p>
                                <p class="rating">Rating: ${track.rating} Stars</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="price-tag">Rs. ${track.price}</span>
                                    <div class="d-flex">
                                        <div class="play-btn me-2">
                                            <i class="fas fa-play"></i>
                                        </div>
                                        <a href="${pageContext.request.contextPath}/CartServlet?action=add&trackId=${track.trackId}">
                                            <div class="cart-btn">
                                                <i class="fas fa-cart-plus"></i>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </c:forEach>
            </div>
            <!-- Pagination -->
            <c:if test="${requestScope.noOfPages > 1}">
                <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center mt-4">
                        <c:if test="${requestScope.currentPage > 1}">
                            <li class="page-item">
                                <a class="page-link" href="${pageContext.request.contextPath}/search?query=${param.query}&genre=${param.genre}&price=${param.price}&rating=${param.rating}&page=${requestScope.currentPage - 1}">Previous</a>
                            </li>
                        </c:if>
                        <c:forEach begin="1" end="${requestScope.noOfPages}" var="i">
                            <li class="page-item ${requestScope.currentPage == i ? 'active' : ''}">
                                <a class="page-link" href="${pageContext.request.contextPath}/search?query=${param.query}&genre=${param.genre}&price=${param.price}&rating=${param.rating}&page=${i}">${i}</a>
                            </li>
                        </c:forEach>
                        <c:if test="${requestScope.currentPage < requestScope.noOfPages}">
                            <li class="page-item">
                                <a class="page-link" href="${pageContext.request.contextPath}/search?query=${param.query}&genre=${param.genre}&price=${param.price}&rating=${param.rating}&page=${requestScope.currentPage + 1}">Next</a>
                            </li>
                        </c:if>
                    </ul>
                </nav>
            </c:if>
        </c:when>
        <c:otherwise>
            <div class="no-results">
                <i class="fas fa-music"></i>
                <h4>No tracks available</h4>
                <p>No tracks found in the library. Please check back later.</p>
            </div>
        </c:otherwise>
    </c:choose>
</div>

<!-- Footer -->
<jsp:include page="/includes/footer.jsp" />

<!-- Shopping Cart Modal -->
<jsp:include page="/includes/modals/shoppingCartModal.jsp" />

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Play button functionality
        const playButtons = document.querySelectorAll('.play-btn');
        playButtons.forEach(button => {
            button.addEventListener('click', function() {
                this.classList.toggle('playing');
                const icon = this.querySelector('i');
                if (icon.classList.contains('fa-play')) {
                    icon.classList.replace('fa-play', 'fa-pause');
                } else {
                    icon.classList.replace('fa-pause', 'fa-play');
                }
            });
        });

        // Add to cart functionality
        const cartButtons = document.querySelectorAll('.cart-btn');
        cartButtons.forEach(button => {
            button.addEventListener('click', function() {
                this.classList.toggle('added');
                const icon = this.querySelector('i');
                if (this.classList.contains('added')) {
                    icon.classList.replace('fa-cart-plus', 'fa-check');
                } else {
                    icon.classList.replace('fa-check', 'fa-cart-plus');
                }
            });
        });
    });
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\signup.jsp
File type: .jsp
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RhythmWave - Sign Up</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/css/signup.css">
  <style>

  </style>
</head>
<body>
<!-- Auth Container -->
<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <div class="auth-icon">
        <i class="fas fa-music"></i>
      </div>
      <h2>Create Your RhythmWave Account</h2>
      <p class="text-secondary">Join our community of music lovers today</p>
    </div>

    <form id="signupForm" action="${pageContext.request.contextPath}/RegisterServlet" method="post">
      <div class="form-group">
        <label for="first-name" class="form-label">First Name</label>
        <input type="text" class="form-control" id="first-name" name="first-name" placeholder="Enter your first name" required>
      </div>

      <div class="form-group">
        <label for="last-name" class="form-label">Last Name</label>
        <input type="text" class="form-control" id="last-name" name="last-name" placeholder="Enter your last name" required>
      </div>

      <div class="form-group">
        <label for="email" class="form-label">Email address</label>
        <input type="email" class="form-control" id="email" name="email" placeholder="name@example.com" required>
      </div>

      <div class="form-group password-input-group">
        <label for="password" class="form-label">Password</label>
        <input type="password" class="form-control" id="password" name="password" placeholder="Create a strong password" required>
        <span class="password-toggle" id="signup-password-toggle">
          <i class="far fa-eye"></i>
        </span>
      </div>

      <div class="form-group password-input-group">
        <label for="signup-confirm-password" class="form-label">Confirm Password</label>
        <input type="password" class="form-control" id="signup-confirm-password" placeholder="Confirm your password" required>
        <span class="password-toggle" id="signup-confirm-password-toggle">
          <i class="far fa-eye"></i>
        </span>
      </div>

      <div class="form-group">
        <label for="signup-genre" class="form-label">Favorite Music Genre</label>
        <select class="form-control" id="signup-genre" name="signup-genre">
          <option value="">Select your favorite genre</option>
          <option value="rock">Rock</option>
          <option value="pop">Pop</option>
          <option value="jazz">Jazz</option>
          <option value="hiphop">Hip Hop</option>
          <option value="electronic">Electronic</option>
          <option value="classical">Classical</option>
          <option value="country">Country</option>
          <option value="r&b">R&B</option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary btn-lg">Create Account</button>

      <div class="text-center mt-4">
        <p class="text-secondary">Already have an account? <a href="login.jsp" class="text-primary">Log In</a></p>
      </div>
    </form>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\index.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/index.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/admin-styles.css">
</head>
<body>
<div class="admin-container">
    <!-- Sidebar Navigation -->
    <jsp:include page="includes/admin_nav_bar.jsp" />

    <!-- Main Content Area -->
    <main class="admin-main">
        <header class="admin-header">
            <h1>RhythmWave Admin Dashboard</h1>
            <div class="user-info">
                <div class="user-avatar">A</div>
                <div>
                    <div>Administrator</div>
                    <div class="text-muted">admin@rhythmwave.com</div>
                </div>
            </div>
        </header>

        <!-- Welcome Section -->
        <section class="welcome-section">
            <div class="welcome-icon">
                <i class="fas fa-music"></i>
            </div>
            <div class="welcome-content">
                <h2>Welcome back, Administrator!</h2>
                <p>Manage your music platform efficiently with the RhythmWave Admin Panel.</p>
            </div>
        </section>

        <!-- Stats Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-content">
                    <h3>1,254</h3>
                    <p>Total Users</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-tag"></i>
                </div>
                <div class="stat-content">
                    <h3>24</h3>
                    <p>Active Promotions</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-ad"></i>
                </div>
                <div class="stat-content">
                    <h3>12</h3>
                    <p>Running Ads</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stat-content">
                    <h3>+8.2%</h3>
                    <p>Revenue Growth</p>
                </div>
            </div>
        </div>

        <!-- Dashboard Cards -->
        <div class="dashboard-grid">
            <!-- User Management Card -->
            <div class="dashboard-card card-user">
                <div class="card-icon">
                    <i class="fas fa-users-cog"></i>
                </div>
                <h3 class="card-title">User Management</h3>
                <p class="card-description">Manage users, roles, and permissions</p>
                <a href="<%=request.getContextPath()%>/manageUsers" class="card-link">
                    Manage Users <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <!-- Marketing Management Card -->
            <div class="dashboard-card card-user">
                <div class="card-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <h3 class="card-title">Marketing Management</h3>
                <p class="card-description">Create promotions and advertisements</p>
                <a href="<%=request.getContextPath()%>/marketing" class="card-link">
                    Manage Marketing <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <!-- Content Management Card -->
            <div class="dashboard-card">
                <div class="card-icon">
                    <i class="fas fa-music"></i>
                </div>
                <h3 class="card-title">Content Management</h3>
                <p class="card-description">Manage songs, albums, and playlists</p>
                <a href="#" class="card-link">
                    Manage Content <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <!-- Settings Card -->
            <div class="dashboard-card">
                <div class="card-icon">
                    <i class="fas fa-cog"></i>
                </div>
                <h3 class="card-title">Settings</h3>
                <p class="card-description">Configure system settings</p>
                <a href="#" class="card-link">
                    Open Settings <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>

        <footer class="admin-footer">
            &copy; 2023 RhythmWave | Admin Panel
        </footer>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\ManageMarketing.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hotel Admin - Marketing Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/index.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/admin-styles.css">
</head>
<body>
<div class="admin-container">
  <!-- Sidebar Navigation -->
  <jsp:include page="includes/admin_nav_bar.jsp">
    <jsp:param name="page" value="manageMarketing"/>
  </jsp:include>

  <!-- Main Content Area -->
  <main class="admin-main">
    <header class="admin-header">
      <h1>Marketing Management</h1>
      <div class="user-info">
        <div class="user-avatar">A</div>
        <div>
          <div>Administrator</div>
          <div class="text-muted">admin@rhythmwave.com</div>
        </div>
      </div>
    </header>

    <!-- Welcome Section -->
    <section class="welcome-section">
      <div class="welcome-icon">
        <i class="fas fa-chart-bar"></i>
      </div>
      <div class="welcome-content">
        <h2>Marketing Management</h2>
        <p>Manage promotions, advertisements, and marketing campaigns for your platform.</p>
      </div>
    </section>

    <!-- Promotions Section -->
    <div class="table-container">
      <div class="table-header">
        <h3>Manage Promotions</h3>
        <div class="table-actions">
          <button class="btn btn-primary" onclick="openAddPromotionModal()">
            <i class="fas fa-plus"></i> Add Promotion
          </button>
        </div>
      </div>
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>Code</th>
          <th>Discount</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Usage</th>
          <th>Description</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <c:choose>
          <c:when test="${not empty requestScope.allPromotions}">
            <c:forEach var="promo" items="${requestScope.allPromotions}">
              <tr>
                <td>${promo.promotionId}</td>
                <td><strong>${promo.code}</strong></td>
                <td>${promo.discount}%</td>
                <td>${promo.startDate}</td>
                <td>${promo.endDate}</td>
                <td>${promo.usageCount}</td>
                <td>${promo.description}</td>
                <td>
                  <span class="status-badge status-active">Active</span>
                </td>
                <td class="actions">
                  <button class="btn btn-edit btn-sm" onclick="openEditPromotionModal('${promo.promotionId}', '${promo.code}', '${promo.discount}', '${promo.startDate}', '${promo.endDate}', '${promo.description}')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-delete btn-sm" onclick="openDeletePromotionModal('${promo.promotionId}', '${promo.code}')">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
            </c:forEach>
          </c:when>
          <c:otherwise>
            <tr>
              <td colspan="9" class="text-muted text-center py-4">No promotions found.</td>
            </tr>
          </c:otherwise>
        </c:choose>
        </tbody>
      </table>
    </div>

    <!-- Advertisements Section -->
    <div class="table-container">
      <div class="table-header">
        <h3>Manage Advertisements</h3>
        <div class="table-actions">
          <button class="btn btn-primary" onclick="openAddAdvertisementModal()">
            <i class="fas fa-plus"></i> Add Advertisement
          </button>
        </div>
      </div>
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>Title</th>
          <th>Content</th>
          <th>Image</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <c:choose>
          <c:when test="${not empty requestScope.allAdvertisements}">
            <c:forEach var="ad" items="${requestScope.allAdvertisements}">
              <tr>
                <td>${ad.adId}</td>
                <td><strong>${ad.title}</strong></td>
                <td>${ad.content}</td>
                <td>
                  <c:if test="${not empty ad.imageData}">
                    <img src="${pageContext.request.contextPath}/image?adId=${ad.adId}" class="preview-img" alt="Ad Image">
                  </c:if>
                </td>
                <td>${ad.startDate}</td>
                <td>${ad.endDate}</td>
                <td>
                  <span class="status-badge ${ad.active ? 'status-active' : 'status-inactive'}">
                      ${ad.active ? 'Active' : 'Inactive'}
                  </span>
                </td>
                <td class="actions">
                  <button class="btn btn-edit btn-sm" onclick="openEditAdvertisementModal('${ad.adId}', '${ad.title}', '${ad.content}', '${ad.imageUrl}', '${ad.startDate}', '${ad.endDate}', '${ad.active}')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-delete btn-sm" onclick="openDeleteAdvertisementModal('${ad.adId}', '${ad.title}')">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
            </c:forEach>
          </c:when>
          <c:otherwise>
            <tr>
              <td colspan="8" class="text-muted text-center py-4">No advertisements found.</td>
            </tr>
          </c:otherwise>
        </c:choose>
        </tbody>
      </table>
    </div>

    <footer class="admin-footer">
      &copy; 2023 RhythmWave | Admin Panel
    </footer>
  </main>
</div>

<!-- Modals -->
<jsp:include page="includes/modals/manage_marketing_modals/add_promotion_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/edit_promotion_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/delete_promotion_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/add_advertisement_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/edit_advertisement_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/delete_advertisement_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Initialize Bootstrap modals
  const addPromotionModal = new bootstrap.Modal(document.getElementById('addPromotionModal'));
  const editPromotionModal = new bootstrap.Modal(document.getElementById('editPromotionModal'));
  const deletePromotionModal = new bootstrap.Modal(document.getElementById('deletePromotionModal'));
  const addAdvertisementModal = new bootstrap.Modal(document.getElementById('addAdvertisementModal'));
  const editAdvertisementModal = new bootstrap.Modal(document.getElementById('editAdvertisementModal'));
  const deleteAdvertisementModal = new bootstrap.Modal(document.getElementById('deleteAdvertisementModal'));

  function openAddPromotionModal() {
    addPromotionModal.show();
  }

  function closeAddPromotionModal() {
    addPromotionModal.hide();
  }

  function openEditPromotionModal(promotionId, code, discount, startDate, endDate, description) {
    document.getElementById('editPromotionId').value = promotionId;
    document.getElementById('editPromoCode').value = code;
    document.getElementById('editDiscount').value = discount;
    document.getElementById('editStartDate').value = startDate;
    document.getElementById('editEndDate').value = endDate;
    document.getElementById('editDescription').value = description;
    editPromotionModal.show();
  }

  function closeEditPromotionModal() {
    editPromotionModal.hide();
  }

  function openDeletePromotionModal(promotionId, code) {
    document.getElementById('deletePromotionId').value = promotionId;
    document.getElementById('deletePromoCode').textContent = code;
    deletePromotionModal.show();
  }

  function closeDeletePromotionModal() {
    deletePromotionModal.hide();
  }

  function openAddAdvertisementModal() {
    addAdvertisementModal.show();
  }

  function closeAddAdvertisementModal() {
    addAdvertisementModal.hide();
  }

  function openEditAdvertisementModal(adId, title, content, startDate, endDate, active) {
    document.getElementById('editAdId').value = adId;
    document.getElementById('editAdTitle').value = title;
    document.getElementById('editAdContent').value = content;
    document.getElementById('editAdStartDate').value = startDate;
    document.getElementById('editAdEndDate').value = endDate;
    document.getElementById('editAdActive').value = active;
    editAdvertisementModal.show();
  }

  function closeEditAdvertisementModal() {
    editAdvertisementModal.hide();
  }

  function openDeleteAdvertisementModal(adId, title) {
    document.getElementById('deleteAdId').value = adId;
    document.getElementById('deleteAdTitle').textContent = title;
    deleteAdvertisementModal.show();
  }

  function closeDeleteAdvertisementModal() {
    deleteAdvertisementModal.hide();
  }
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\ManageUsers.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hotel Admin - User Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/index.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/admin-styles.css">
</head>
<body>
<div class="admin-container">
  <!-- Sidebar Navigation -->
  <jsp:include page="includes/admin_nav_bar.jsp">
    <jsp:param name="page" value="manageUsers"/>
  </jsp:include>

  <!-- Main Content Area -->
  <main class="admin-main">
    <header class="admin-header">
      <h1>User Management</h1>
      <div class="user-info">
        <div class="user-avatar">A</div>
        <div>
          <div>Administrator</div>
          <div class="text-muted">admin@rhythmwave.com</div>
        </div>
      </div>
    </header>

    <!-- Welcome Section -->
    <section class="welcome-section">
      <div class="welcome-icon">
        <i class="fas fa-users-cog"></i>
      </div>
      <div class="welcome-content">
        <h2>User Management</h2>
        <p>Manage all users, their roles, and permissions in the system.</p>
      </div>
    </section>

    <!-- Users Table -->
    <div class="table-container">
      <div class="table-header">
        <h3>All Users</h3>
        <div class="table-actions">
          <button class="btn btn-primary" onclick="openAddUserModal()">
            <i class="fas fa-plus"></i> Add User
          </button>
        </div>
      </div>
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Email</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <c:forEach var="user" items="${requestScope.allUsers}">
          <tr>
            <td>${user.userId}</td>
            <td>
              <div><strong>${user.firstName} ${user.lastName}</strong></div>
              <div class="text-muted">Joined: 2023-10-15</div>
            </td>
            <td>${user.email}</td>
            <td>
              <span class="status-badge ${user.isAdmin() ? 'status-active' : 'status-inactive'}">
                  ${user.isAdmin() ? "Admin" : "User"}
              </span>
            </td>
            <td>
              <span class="status-badge status-active">Active</span>
            </td>
            <td class="actions">
              <button class="btn btn-edit btn-sm" onclick="openEditModal('${user.userId}', '${user.firstName}', '${user.lastName}', '${user.email}', '${user.isAdmin()}')">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button class="btn btn-delete btn-sm" onclick="openDeleteModal('${user.userId}', '${user.firstName} ${user.lastName}')">
                <i class="fas fa-trash"></i> Delete
              </button>
            </td>
          </tr>
        </c:forEach>
        </tbody>
      </table>
    </div>

    <footer class="admin-footer">
      &copy; 2023 RhythmWave | Admin Panel
    </footer>
  </main>
</div>

<!-- Add User Modal -->
<jsp:include page="includes/modals/manage_user_modals/add_user_modal.jsp" >
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>

<!-- Edit User Modal -->
<jsp:include page="includes/modals/manage_user_modals/edit_user_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>

<!-- Delete User Modal -->
<jsp:include page="includes/modals/manage_user_modals/delete_user_modal.jsp" />

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Initialize Bootstrap modals
  const addUserModal = new bootstrap.Modal(document.getElementById('addUserModal'));
  const editUserModal = new bootstrap.Modal(document.getElementById('editUserModal'));
  const deleteUserModal = new bootstrap.Modal(document.getElementById('deleteUserModal'));

  function openAddUserModal() {
    addUserModal.show();
  }

  function closeAddUserModal() {
    addUserModal.hide();
  }

  function openEditModal(userId, firstName, lastName, email, isAdmin) {
    document.getElementById('editUserId').value = userId;
    document.getElementById('editFirstName').value = firstName;
    document.getElementById('editLastName').value = lastName;
    document.getElementById('editEmail').value = email;
    document.getElementById('editRole').value = isAdmin === 'true' ? 'admin' : 'user';
    editUserModal.show();
  }

  function closeEditModal() {
    editUserModal.hide();
  }

  function openDeleteModal(userId, userName) {
    document.getElementById('deleteUserId').value = userId;
    document.getElementById('deleteUserName').textContent = userName;
    deleteUserModal.show();
  }

  function closeDeleteModal() {
    deleteUserModal.hide();
  }
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\css\admin-styles.css
File type: .css
/* Admin-specific styles for ManageUsers.jsp, ManageMarketing.jsp */
@import "theme.css";

/* Table Styles */
.table-container {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    margin-bottom: 2rem;
    overflow-x: auto;
}

.table-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.table-header h3 {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.table-actions {
    display: flex;
    gap: 0.75rem;
}

table {
    width: 100%;
    border-collapse: collapse;
    color: var(--text-primary);
}

/* Add or modify these styles */
th, td {
    padding: 0.875rem;
    text-align: left;
    border-bottom: 1px solid #333;
    font-size: var(--font-size-small);
    vertical-align: middle; /* Center content vertically */
    min-height: 100px; /* Match preview-img height */
}

th {
    background-color: rgba(42, 42, 42, 0.5);
    color: var(--text-secondary);
    font-weight: 600;
}

td.actions {
    display: flex;
    gap: 0.5rem;
    align-items: center; /* Center buttons vertically */
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: var(--font-size-label);
    height: 100%; /* Fill the cell height */
    box-sizing: border-box; /* Include padding in height */
}

tr:hover {
    background-color: rgba(42, 42, 42, 0.3);
}

.actions {
    display: flex;
    gap: 0.5rem;

}

.btn {
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius);
    border: none;
    cursor: pointer;
    transition: var(--transition);
    font-size: var(--font-size-small);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-primary {
    background-color: var(--primary);
    color: #000;
}

.btn-primary:hover {
    background-color: #9965f4;
}

.btn-secondary {
    background-color: #2a2a2a;
    color: var(--text-primary);
}

.btn-secondary:hover {
    background-color: #3a3a3a;
}

.btn-edit {
    background-color: var(--secondary);
    color: #000;
}

.btn-edit:hover {
    background-color: #02b3a1;
}

.btn-delete {
    background-color: #dc3545;
    color: #fff;
}

.btn-delete:hover {
    background-color: #c82333;
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: var(--font-size-label);
}

/* Modal Styles */
.modal-content {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border: 1px solid #333;
    border-radius: var(--border-radius);
}

.modal-header {
    border-bottom: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.modal-title {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
}

.modal-body {
    padding: 1.5rem;
}

.modal-footer {
    border-top: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-group label {
    display: block;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #444;
    border-radius: var(--border-radius);
    background-color: #2a2a2a;
    color: var(--text-primary);
    font-size: var(--font-size-small);
    transition: var(--transition);
}

.form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
    outline: none;
}

/* Image Preview */
.preview-img {
    width: 100px;
    height: 60px;
    border-radius: var(--border-radius);
    object-fit: cover;
    border: 1px solid #333;
    vertical-align: middle; /* Align image with other content */
}

/* Status Badges */
.status-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.status-active {
    background-color: rgba(3, 218, 198, 0.2);
    color: var(--secondary);
}

.status-inactive {
    background-color: rgba(220, 53, 69, 0.2);
    color: #dc3545;
}

/* Image Preview */
.image-preview {
    width: 100px;
    height: 100px;
    border-radius: var(--border-radius);
    object-fit: cover;
    border: 1px solid #333;
}

.text-muted {
    color: var(--text-secondary) !important;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\css\index.css
File type: .css
/* General application styles from index.css */
@import "theme.css";

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: var(--font-size-base);
    line-height: 1.5;
}

/* Admin Layout Styles */
.admin-container {
    display: flex;
    min-height: 100vh;
}

.admin-sidebar {
    width: var(--sidebar-width);
    background-color: var(--card-bg);
    border-right: 1px solid #333;
    position: fixed;
    height: 100vh;
    overflow-y: auto;
    z-index: 1000;
    transition: var(--transition);
}

.sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid #333;
    text-align: center;
}

.sidebar-header h2 {
    color: var(--primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.sidebar-nav {
    padding: 1rem 0;
}

.sidebar-nav a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    text-decoration: none;
    padding: 0.875rem 1.5rem;
    transition: var(--transition);
    font-size: var(--font-size-small);
}

.sidebar-nav a:hover, .sidebar-nav a.active {
    background-color: rgba(187, 134, 252, 0.1);
    color: var(--primary);
    border-left: 3px solid var(--primary);
}

.sidebar-nav i {
    width: 20px;
    text-align: center;
}

.admin-main {
    flex: 1;
    margin-left: var(--sidebar-width);
    padding: 1.5rem;
    transition: var(--transition);
}

.admin-header {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid #333;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.admin-header h1 {
    color: var(--text-primary);
    font-size: var(--font-size-heading);
    margin: 0;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    font-size: var(--font-size-small);
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-weight: bold;
}

/* Dashboard Styles */
.welcome-section {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 2rem;
    margin-bottom: 2rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

.welcome-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.welcome-icon i {
    font-size: 2rem;
    color: #000;
}

.welcome-content h2 {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.welcome-content p {
    color: var(--text-secondary);
    margin: 0;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.dashboard-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    transition: var(--transition);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.dashboard-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    border-color: var(--primary);
}

.card-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1rem;
}

.card-icon i {
    font-size: 1.5rem;
    color: var(--primary);
}

.card-title {
    font-size: var(--font-size-subheading);
    margin-bottom: 0.5rem;
    color: var(--text-primary);
}

.card-description {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin-bottom: 1rem;
}

.card-link {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    font-size: var(--font-size-small);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: var(--transition);
}

.card-link:hover {
    color: var(--secondary);
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.stat-icon i {
    font-size: 1.25rem;
    color: var(--primary);
}

.stat-content h3 {
    color: var(--text-primary);
    font-size: 1.5rem;
    margin: 0;
}

.stat-content p {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin: 0;
}

/* Footer */
.admin-footer {
    background-color: #1a1a1a;
    color: var(--text-secondary);
    text-align: center;
    padding: 1.5rem;
    margin-top: 2rem;
    border-radius: var(--border-radius);
    font-size: var(--font-size-small);
}

/* Responsive Design */
@media (max-width: 992px) {
    .admin-sidebar {
        transform: translateX(-100%);
    }

    .admin-sidebar.active {
        transform: translateX(0);
    }

    .admin-main {
        margin-left: 0;
    }
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }

    .welcome-section {
        flex-direction: column;
        text-align: center;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\css\theme.css
File type: .css
/* theme.css - Updated with proper font sizes */
:root {
    --dark-bg: #121212;
    --card-bg: #1e1e1e;
    --primary: #bb86fc;
    --secondary: #03dac6;
    --text-primary: #ffffff;
    --text-secondary: #b3b3b3;
    --placeholder-color: #888;
    --font-size-base: 1rem;
    --font-size-heading: 1.5rem;
    --font-size-subheading: 1.25rem;
    --font-size-small: 0.875rem;
    --font-size-label: 0.8rem;
    --border-radius: 8px;
    --sidebar-width: 250px;
    --header-height: 70px;
    --transition: all 0.3s ease;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\admin_nav_bar.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="page" value="${param.page}" />

<nav class="admin-sidebar">
  <div class="sidebar-header">
    <h2>RhythmWave Admin</h2>
  </div>
  <div class="sidebar-nav">
    <a href="${pageContext.request.contextPath}/admin/index.jsp" class="${empty page ? 'active' : ''}">
      <i class="fas fa-tachometer-alt"></i>
      Dashboard
    </a>
    <a href="${pageContext.request.contextPath}/manageUsers" class="${page eq 'manageUsers' ? 'active' : ''}">
      <i class="fas fa-users-cog"></i>
      User Management
    </a>
    <a href="${pageContext.request.contextPath}/marketing" class="${page eq 'manageMarketing' ? 'active' : ''}">
      <i class="fas fa-chart-bar"></i>
      Marketing Management
    </a>
    <a href="${pageContext.request.contextPath}/LogoutServlet">
      <i class="fas fa-sign-out-alt"></i>
      Logout
    </a>
  </div>
</nav>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\add_advertisement_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="addAdvertisementModal" tabindex="-1" aria-labelledby="addAdvertisementModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addAdvertisementModalLabel">Add New Advertisement</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="addAdvertisementForm" action="${contextPath}/marketing" method="POST" enctype="multipart/form-data">
                <div class="modal-body">
                    <input type="hidden" name="action" value="ad_add">
                    <div class="form-group">
                        <label for="addAdTitle">Title</label>
                        <input type="text" class="form-control" id="addAdTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdContent">Content</label>
                        <input type="text" class="form-control" id="addAdContent" name="content" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdImage" class="form-label">Image</label>
                        <input type="file" class="form-control" id="addAdImage" name="imageFile" accept="image/png,image/jpeg,image/jpg">
                    </div>
                    <div class="form-group">
                        <label for="addAdStartDate">Start Date</label>
                        <input type="date" class="form-control" id="addAdStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdEndDate">End Date</label>
                        <input type="date" class="form-control" id="addAdEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdActive">Active</label>
                        <select class="form-control" id="addAdActive" name="active" required>
                            <option value="true">Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Advertisement</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\add_promotion_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="addPromotionModal" tabindex="-1" aria-labelledby="addPromotionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addPromotionModalLabel">Add New Promotion</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="addPromotionForm" action="${contextPath}/marketing" method="POST">
                <div class="modal-body">
                    <input type="hidden" name="action" value="add">
                    <div class="form-group">
                        <label for="addPromoCode">Code</label>
                        <input type="text" class="form-control" id="addPromoCode" name="code" required>
                    </div>
                    <div class="form-group">
                        <label for="addDiscount">Discount</label>
                        <input type="number" class="form-control" id="addDiscount" name="discount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="addStartDate">Start Date</label>
                        <input type="date" class="form-control" id="addStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addEndDate">End Date</label>
                        <input type="date" class="form-control" id="addEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addDescription">Description</label>
                        <input type="text" class="form-control" id="addDescription" name="description" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Promotion</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\delete_advertisement_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="deleteAdvertisementModal" tabindex="-1" aria-labelledby="deleteAdvertisementModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteAdvertisementModalLabel">Delete Advertisement</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="deleteAdvertisementForm" action="${contextPath}/marketing" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="deleteAdId" name="adId">
                    <input type="hidden" name="action" value="ad_delete">
                    <p>Are you sure you want to delete advertisement <strong id="deleteAdTitle"></strong>?</p>
                    <p class="text-muted">This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\delete_promotion_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="deletePromotionModal" tabindex="-1" aria-labelledby="deletePromotionModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deletePromotionModalLabel">Delete Promotion</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="deletePromotionForm" action="${contextPath}/marketing" method="POST">
        <div class="modal-body">
          <input type="hidden" id="deletePromotionId" name="promotionId">
          <input type="hidden" name="action" value="delete">
          <p>Are you sure you want to delete promotion <strong id="deletePromoCode"></strong>?</p>
          <p class="text-muted">This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-danger">Delete</button>
        </div>
      </form>
    </div>
  </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\edit_advertisement_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="editAdvertisementModal" tabindex="-1" aria-labelledby="editAdvertisementModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editAdvertisementModalLabel">Edit Advertisement</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="editAdvertisementForm" action="${contextPath}/marketing" method="POST" enctype="multipart/form-data">
                <div class="modal-body">
                    <input type="hidden" id="editAdId" name="adId">
                    <input type="hidden" name="action" value="ad_update">
                    <div class="form-group">
                        <label for="editAdTitle">Title</label>
                        <input type="text" class="form-control" id="editAdTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdContent">Content</label>
                        <input type="text" class="form-control" id="editAdContent" name="content" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdImage">Image</label>
                        <div class="custom-file-upload">
                            <input type="file" id="editAdImage" name="image" accept="image/*">
                            <label for="editAdImage">
                                <span class="file-name">No file chosen</span>
                                <span class="btn">Choose File</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editAdStartDate">Start Date</label>
                        <input type="date" class="form-control" id="editAdStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdEndDate">End Date</label>
                        <input type="date" class="form-control" id="editAdEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdActive">Active</label>
                        <select class="form-control" id="editAdActive" name="active" required>
                            <option value="true">Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.getElementById('editAdImage').addEventListener('change', function() {
        const fileName = this.files.length > 0 ? this.files[0].name : 'No file chosen';
        this.nextElementSibling.querySelector('.file-name').textContent = fileName;
    });
</script>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\edit_promotion_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="editPromotionModal" tabindex="-1" aria-labelledby="editPromotionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPromotionModalLabel">Edit Promotion</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="editPromotionForm" action="${contextPath}/marketing" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="editPromotionId" name="promotionId">
                    <input type="hidden" name="action" value="update">
                    <div class="form-group">
                        <label for="editPromoCode">Code</label>
                        <input type="text" class="form-control" id="editPromoCode" name="code" required>
                    </div>
                    <div class="form-group">
                        <label for="editDiscount">Discount</label>
                        <input type="number" class="form-control" id="editDiscount" name="discount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editStartDate">Start Date</label>
                        <input type="date" class="form-control" id="editStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editEndDate">End Date</label>
                        <input type="date" class="form-control" id="editEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editDescription">Description</label>
                        <input type="text" class="form-control" id="editDescription" name="description" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_user_modals\add_user_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addUserModalLabel">Add New User</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="addUserForm" action="${contextPath}/manageUsers" method="POST">
        <div class="modal-body">
          <input type="hidden" name="action" value="add">
          <div class="form-group">
            <label for="addFirstName">First Name</label>
            <input type="text" class="form-control" id="addFirstName" name="firstName" required>
          </div>
          <div class="form-group">
            <label for="addLastName">Last Name</label>
            <input type="text" class="form-control" id="addLastName" name="lastName" required>
          </div>
          <div class="form-group">
            <label for="addEmail">Email</label>
            <input type="email" class="form-control" id="addEmail" name="email" required>
          </div>
          <div class="form-group">
            <label for="addPassword">Password</label>
            <input type="password" class="form-control" id="addPassword" name="password" required>
          </div>
          <div class="form-group">
            <label for="addRole">Role</label>
            <select class="form-control" id="addRole" name="role" required>
              <option value="user">User</option>
              <option value="admin">Admin</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Add User</button>
        </div>
      </form>
    </div>
  </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_user_modals\delete_user_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="deleteUserModal" tabindex="-1" aria-labelledby="deleteUserModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteUserModalLabel">Delete User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="deleteUserForm" action="${contextPath}/manageUsers" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="deleteUserId" name="userId">
                    <input type="hidden" name="action" value="delete">
                    <p>Are you sure you want to delete user <strong id="deleteUserName"></strong>?</p>
                    <p class="text-muted">This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_user_modals\edit_user_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editUserModalLabel">Edit User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="editUserForm" action="${contextPath}/manageUsers" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="editUserId" name="userId">
                    <input type="hidden" id="action" name="action" value="update">
                    <div class="form-group">
                        <label for="editFirstName">First Name</label>
                        <input type="text" class="form-control" id="editFirstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="editLastName">Last Name</label>
                        <input type="text" class="form-control" id="editLastName" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label for="editEmail">Email</label>
                        <input type="email" class="form-control" id="editEmail" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="editRole">Role</label>
                        <select class="form-control" id="editRole" name="role" required>
                            <option value="user">User</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editPassword">Password</label>
                        <input type="password" class="form-control" id="editPassword" name="editPassword" placeholder="New Password (leave blank to keep unchanged)">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\admin-styles.css
File type: .css

@import "theme.css";

/* Table Styles */
.table-container {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    margin-bottom: 2rem;
    overflow-x: auto;
}

.table-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.table-header h3 {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.table-actions {
    display: flex;
    gap: 0.75rem;
}

table {
    width: 100%;
    border-collapse: collapse;
    color: var(--text-primary);
}

th, td {
    padding: 0.875rem;
    text-align: left;
    border-bottom: 1px solid #333;
    font-size: var(--font-size-small);
}

th {
    background-color: rgba(42, 42, 42, 0.5);
    color: var(--text-secondary);
    font-weight: 600;
}

tr:hover {
    background-color: rgba(42, 42, 42, 0.3);
}

.actions {
    display: flex;
    gap: 0.5rem;
}

.btn {
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius);
    border: none;
    cursor: pointer;
    transition: var(--transition);
    font-size: var(--font-size-small);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-primary {
    background-color: var(--primary);
    color: #000;
}

.btn-primary:hover {
    background-color: #9965f4;
}

.btn-secondary {
    background-color: #2a2a2a;
    color: var(--text-primary);
}

.btn-secondary:hover {
    background-color: #3a3a3a;
}

.btn-edit {
    background-color: var(--secondary);
    color: #000;
}

.btn-edit:hover {
    background-color: #02b3a1;
}

.btn-delete {
    background-color: #dc3545;
    color: #fff;
}

.btn-delete:hover {
    background-color: #c82333;
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: var(--font-size-label);
}

/* Modal Styles */
.modal-content {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border: 1px solid #333;
    border-radius: var(--border-radius);
}

.modal-header {
    border-bottom: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.modal-title {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
}

.modal-body {
    padding: 1.5rem;
}

.modal-footer {
    border-top: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-group label {
    display: block;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #444;
    border-radius: var(--border-radius);
    background-color: #2a2a2a;
    color: var(--text-primary);
    font-size: var(--font-size-small);
    transition: var(--transition);
}

.form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
    outline: none;
}

/* Status Badges */
.status-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.status-active {
    background-color: rgba(3, 218, 198, 0.2);
    color: var(--secondary);
}

.status-inactive {
    background-color: rgba(220, 53, 69, 0.2);
    color: #dc3545;
}

/* Image Preview */
.preview-img {
    width: 100px;
    height: 100px;
    border-radius: var(--border-radius);
    object-fit: cover;
    border: 1px solid #333;
}

.text-muted {
    color: var(--text-secondary) !important;
}

/* Custom File Upload Styles */
.custom-file-upload {
    position: relative;
    display: inline-block;
    width: 100%;
}

.custom-file-upload input[type="file"] {
    display: none;
}

.custom-file-upload label {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #444;
    border-radius: var(--border-radius);
    background-color: #2a2a2a;
    color: var(--text-primary);
    font-size: var(--font-size-small);
    cursor: pointer;
    transition: var(--transition);
}

.custom-file-upload label:hover {
    background-color: #3a3a3a;
}

.custom-file-upload label:focus-within {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
    outline: none;
}

.custom-file-upload .file-name {
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: var(--text-secondary);
}

.custom-file-upload .btn {
    background-color: var(--primary);
    color: #000;
    padding: 0.5rem 1rem;
    font-size: var(--font-size-label);
}

.custom-file-upload .btn:hover {
    background-color: #9965f4;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\index.css
File type: .css
/* General application styles from index.css */
@import "theme.css";

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: var(--font-size-base);
    line-height: 1.5;
}

/* Admin Layout Styles */
.admin-container {
    display: flex;
    min-height: 100vh;
}

.admin-sidebar {
    width: var(--sidebar-width);
    background-color: var(--card-bg);
    border-right: 1px solid #333;
    position: fixed;
    height: 100vh;
    overflow-y: auto;
    z-index: 1000;
    transition: var(--transition);
}

.sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid #333;
    text-align: center;
}

.sidebar-header h2 {
    color: var(--primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.sidebar-nav {
    padding: 1rem 0;
}

.sidebar-nav a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    text-decoration: none;
    padding: 0.875rem 1.5rem;
    transition: var(--transition);
    font-size: var(--font-size-small);
}

.sidebar-nav a:hover, .sidebar-nav a.active {
    background-color: rgba(187, 134, 252, 0.1);
    color: var(--primary);
    border-left: 3px solid var(--primary);
}

.sidebar-nav i {
    width: 20px;
    text-align: center;
}

.admin-main {
    flex: 1;
    margin-left: var(--sidebar-width);
    padding: 1.5rem;
    transition: var(--transition);
}

.admin-header {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid #333;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.admin-header h1 {
    color: var(--text-primary);
    font-size: var(--font-size-heading);
    margin: 0;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    font-size: var(--font-size-small);
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-weight: bold;
}

/* Dashboard Styles */
.welcome-section {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 2rem;
    margin-bottom: 2rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

.welcome-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.welcome-icon i {
    font-size: 2rem;
    color: #000;
}

.welcome-content h2 {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.welcome-content p {
    color: var(--text-secondary);
    margin: 0;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.dashboard-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    transition: var(--transition);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.dashboard-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    border-color: var(--primary);
}

.card-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1rem;
}

.card-icon i {
    font-size: 1.5rem;
    color: var(--primary);
}

.card-title {
    font-size: var(--font-size-subheading);
    margin-bottom: 0.5rem;
    color: var(--text-primary);
}

.card-description {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin-bottom: 1rem;
}

.card-link {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    font-size: var(--font-size-small);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: var(--transition);
}

.card-link:hover {
    color: var(--secondary);
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.stat-icon i {
    font-size: 1.25rem;
    color: var(--primary);
}

.stat-content h3 {
    color: var(--text-primary);
    font-size: 1.5rem;
    margin: 0;
}

.stat-content p {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin: 0;
}

/* Footer */
.admin-footer {
    background-color: #1a1a1a;
    color: var(--text-secondary);
    text-align: center;
    padding: 1.5rem;
    margin-top: 2rem;
    border-radius: var(--border-radius);
    font-size: var(--font-size-small);
}

/* Responsive Design */
@media (max-width: 992px) {
    .admin-sidebar {
        transform: translateX(-100%);
    }

    .admin-sidebar.active {
        transform: translateX(0);
    }

    .admin-main {
        margin-left: 0;
    }
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }

    .welcome-section {
        flex-direction: column;
        text-align: center;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\login.css
File type: .css
@import "theme.css";

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.auth-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-grow: 1;
    padding: 2rem;
}

.auth-card {
    background-color: var(--card-bg);
    border-radius: 10px;
    padding: 2.5rem;
    width: 100%;
    max-width: 450px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.5);
}

.auth-header {
    text-align: center;
    margin-bottom: 2rem;
}

.auth-icon {
    font-size: 2.5rem;
    color: var(--primary);
    margin-bottom: 1rem;
}

.form-control {
    background-color: #2a2a2a;
    border: 1px solid #444;
    color: var(--text-primary);
    padding: 0.75rem 1rem;
}

.form-control:focus {
    background-color: #2a2a2a;
    color: var(--text-primary);
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
}

.btn-primary {
    background-color: var(--primary);
    border: none;
    color: #000;
    padding: 0.75rem;
    font-weight: 600;
}

.btn-primary:hover {
    background-color: #9965f4;
}

.form-check-input {
    background-color: #2a2a2a;
    border: 1px solid #444;
}

.form-check-input:checked {
    background-color: var(--primary);
    border-color: var(--primary);
}

.form-control::placeholder {
    color: var(--placeholder-color);
    opacity: 1;
}

.form-control:-ms-input-placeholder {
    color: var(--placeholder-color);
}

.form-control::-ms-input-placeholder {
    color: var(--placeholder-color);
}

.password-toggle {
    cursor: pointer;
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
}

.password-input-group {
    position: relative;
}

.footer {
    background-color: #1a1a1a;
    padding: 1.5rem 0;
    margin-top: auto;
    text-align: center;
}

.footer-links {
    margin-top: 0.5rem;
}

.footer-links a {
    color: var(--text-secondary);
    text-decoration: none;
    margin: 0 10px;
    font-size: 0.9rem;
}

.footer-links a:hover {
    color: var(--primary);
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\signup.css
File type: .css
@import "theme.css";

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    background-image: linear-gradient(to bottom, #1a1a1a, #2d2d2d);
}

.auth-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-grow: 1;
    padding: 2rem;
}

.auth-card {
    background-color: var(--card-bg);
    border-radius: 12px;
    padding: 2.5rem;
    width: 100%;
    max-width: 500px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.5);
}

.auth-header {
    text-align: center;
    margin-bottom: 2.5rem;
}

.auth-icon {
    font-size: 3rem;
    color: var(--primary);
    margin-bottom: 1.5rem;
}

.form-control {
    background-color: #2a2a2a;
    border: 1px solid #444;
    color: var(--text-primary);
    padding: 0.85rem 2.5rem 0.85rem 1.2rem;
    font-size: 1.05rem;
    margin-bottom: 1.5rem;
}

.form-control:focus {
    background-color: #2a2a2a;
    color: var(--text-primary);
    border-color: var(--primary);
    box-shadow: 0 0 0 0.3rem rgba(187, 134, 252, 0.25);
}

.form-control::placeholder {
    color: var(--placeholder-color);
    opacity: 1;
}

.form-control:-ms-input-placeholder {
    color: var(--placeholder-color);
}

.form-control::-ms-input-placeholder {
    color: var(--placeholder-color);
}

.btn-primary {
    background-color: var(--primary);
    border: none;
    color: #000;
    padding: 0.9rem;
    font-weight: 600;
    font-size: 1.1rem;
    border-radius: 8px;
    transition: all 0.3s;
    width: 100%;
    margin-top: 1rem;
}

.btn-primary:hover {
    background-color: #9965f4;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(187, 134, 252, 0.4);
}

.form-check-input {
    background-color: #2a2a2a;
    border: 1px solid #444;
    width: 1.2em;
    height: 1.2em;
    margin-top: 0.15em;
}

.form-check-input:checked {
    background-color: var(--primary);
    border-color: var(--primary);
}

.form-check-label {
    margin-left: 0.5em;
}

.password-input-group {
    position: relative;
}

.password-toggle {
    cursor: pointer;
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    padding: 0 10px;
}

.footer {
    background-color: #1a1a1a;
    padding: 1.5rem 0;
    margin-top: auto;
    text-align: center;
}

.footer-links {
    margin-top: 0.5rem;
}

.footer-links a {
    color: var(--text-secondary);
    text-decoration: none;
    margin: 0 12px;
    font-size: 0.95rem;
    transition: color 0.3s;
}

.footer-links a:hover {
    color: var(--primary);
}

.form-label {
    font-weight: 500;
    margin-bottom: 0.5rem;
    display: block;
}

.terms-text {
    margin-left: 1.8rem;
    margin-top: 0.5rem;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\theme.css
File type: .css
/* theme.css - Updated with proper font sizes */
:root {
    --dark-bg: #121212;
    --card-bg: #1e1e1e;
    --primary: #bb86fc;
    --secondary: #03dac6;
    --text-primary: #ffffff;
    --text-secondary: #b3b3b3;
    --placeholder-color: #888;
    --font-size-base: 1rem;
    --font-size-heading: 1.5rem;
    --font-size-subheading: 1.25rem;
    --font-size-small: 0.875rem;
    --font-size-label: 0.8rem;
    --border-radius: 8px;
    --sidebar-width: 250px;
    --header-height: 70px;
    --transition: all 0.3s ease;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\includes\footer.jsp
File type: .jsp
<footer class="footer mt-5">
    <div class="container">
        <hr class="my-4">
        <div class="row">
            <div class="col-md-6">
                <p class="text-secondary"> 2023 RhythmWave. All rights reserved.</p>
            </div>
            <div class="col-md-6 text-md-end">
                <a href="#" class="text-secondary me-3"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-secondary me-3"><i class="fab fa-twitter"></i></a>
                <a href="#" class="text-secondary me-3"><i class="fab fa-instagram"></i></a>
                <a href="#" class="text-secondary"><i class="fab fa-youtube"></i></a>
            </div>
        </div>
    </div>
</footer>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\includes\navbar.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<c:set var="activePage" value="${param.page}" />

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark sticky-top mb-2">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">
      <i class="fas fa-music me-2"></i>RhythmWave
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link ${activePage eq 'index' ? 'active' : ''}" href="${pageContext.request.contextPath}/index.jsp">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq 'search' ? 'active' : ''}" href="${pageContext.request.contextPath}/search">Search</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq '' ? 'active' : ''}" href="#">Genres</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq '' ? 'active' : ''}" href="#">New Releases</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq '' ? 'active' : ''}" href="#">Top Charts</a>
        </li>
      </ul>

      <!-- Search Bar -->
      <c:if test="${!(param.searchBox eq 'noShow')}">
        <form action="${pageContext.request.contextPath}/search" method="get" class="input-group me-3" style="max-width: 300px;">
          <input type="text" class="form-control" name="query" placeholder="Search artists, albums, or songs..." value="${param.query}">
          <button class="btn btn-primary" type="submit">
            <i class="fas fa-search"></i>
          </button>
        </form>
      </c:if>

      <c:choose>
        <c:when test="${empty sessionScope.USER}">
          <div class="d-flex">
            <a href="login.jsp" class="btn btn-outline-primary me-2">Login</a>
            <a href="signup.jsp" class="btn btn-primary me-3">Sign Up</a>
          </div>
        </c:when>
        <c:otherwise>
          <div class="d-flex">
            <a href="${pageContext.request.contextPath}/LogoutServlet" class="btn btn-primary me-2">Logout</a>
            <button type="button" class="btn btn-outline-light position-relative me-2" data-bs-toggle="modal" data-bs-target="#shoppingCartModal">
              <i class="fas fa-shopping-cart me-2"></i>
              <span class="badge badge-light cart-badge"></span>
            </button>

            <c:choose>
              <c:when test="${sessionScope.USER.isAdmin() eq true}">
                <a href="${pageContext.request.contextPath}/admin/">
                  <button type="button" class="btn btn-outline-light position-relative me-2">
                    <i class="fa-solid fa-user me-2" ></i> Admin Panel
                  </button>
                </a>
              </c:when>
              <c:otherwise>
                <a href="${pageContext.request.contextPath}/profile">
                  <button type="button" class="btn btn-outline-light position-relative me-2">
                    <i class="fa-solid fa-user me-2" ></i> Profile
                  </button>
                </a>
              </c:otherwise>
            </c:choose>
          </div>
        </c:otherwise>
      </c:choose>
    </div>
  </div>
</nav>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\includes\modals\shoppingCartModal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<div class="modal fade cart-modal" id="shoppingCartModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Your Shopping Cart <span class="cart-badge"> <c:out value="${fn:length(sessionScope.cartItems)}" /></span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Cart Item 1 -->
                <c:choose>
                    <c:when test="${empty sessionScope.cartItems}">
                        <div class="modal-body">
                            <div class="cart-empty">
                                <i class="fas fa-shopping-cart"></i>
                                <p>Your cart is empty</p>
                            </div>
                        </div>
                    </c:when>
                    <c:otherwise>
                        <c:forEach var="track" items="${sessionScope.cartItems}">
                            <div class="cart-item">
                                <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80"
                                     alt="Album Cover" class="cart-item-img">
                                <div class="cart-item-details">
                                    <div class="cart-item-title">${track.title}</div>
                                    <div class="cart-item-artist">by ${track.artist}</div>
                                    <div class="cart-item-price">Rs. ${track.price}</div>
                                </div>
                                <a href="${pageContext.request.contextPath}/CartServlet?action=remove&trackId=${track.trackId}">
                                    <button class="cart-item-remove">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </a>

                            </div>
                        </c:forEach>
                    </c:otherwise>
                </c:choose>

            </div>
            <div class="modal-footer">
                <div class="cart-summary">
                    <span>Total: </span>
                    <span class="cart-total">Rs. ${sessionScope.cartTotal}</span>
                </div>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Continue Shopping</button>
                <button type="button" class="btn btn-primary">Proceed to Checkout</button>
            </div>
        </div>
    </div>
</div>


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\js\cart.js
File type: .js
// Cart functionality for RhythmWave Music Store
document.addEventListener('DOMContentLoaded', function() {
    // Play button functionality
    const playButtons = document.querySelectorAll('.play-btn');
    playButtons.forEach(button => {
        button.addEventListener('click', function() {
            this.classList.toggle('playing');
            const icon = this.querySelector('i');
            if (icon.classList.contains('fa-play')) {
                icon.classList.replace('fa-play', 'fa-pause');
            } else {
                icon.classList.replace('fa-pause', 'fa-play');
            }
        });
    });

    // Initialize cart buttons
    initializeCartButtons();

    // Initialize cart modal
    initializeCartModal();
});

// Initialize cart buttons
function initializeCartButtons() {
    const cartButtons = document.querySelectorAll('.cart-btn');
    cartButtons.forEach(button => {
        button.addEventListener('click', function() {
            const trackId = this.getAttribute('data-track-id');
            const isAdded = this.classList.contains('added');
            const action = isAdded ? 'remove' : 'add';

            updateCart(action, trackId, this);
        });
    });
}

// Initialize cart modal
function initializeCartModal() {
    // Add event listeners to remove buttons in modal
    document.addEventListener('click', function(e) {
        if (e.target.closest('.cart-item-remove')) {
            const button = e.target.closest('.cart-item-remove');
            const trackId = button.getAttribute('data-track-id');
            updateCart('remove', trackId, null);
        }
    });

    // Load initial cart state
    loadCartState();
}

// Load initial cart state from server
async function loadCartState() {
    try {
        const response = await fetch('${pageContext.request.contextPath}/CartServlet?action=getState', {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'Accept': 'application/json'
            }
        });

        if (!response.ok) {
            throw new Error('Failed to load cart state');
        }

        const data = await response.json();
        updateCartUI(data);
    } catch (error) {
        console.error('Error loading cart state:', error);
    }
}

// AJAX call to update cart
async function updateCart(action, trackId, button) {
    try {
        const response = await fetch(`CartServlet?action=${action}&trackId=${trackId}`, {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'Accept': 'application/json'
            }
        });

        if (!response.ok) {
            const error = await response.json();
            throw new Error(error.error || 'Failed to update cart');
        }

        const data = await response.json();

        // Update button state if provided
        if (button) {
            if (action === 'add') {
                button.classList.add('added');
                button.querySelector('i').classList.replace('fa-cart-plus', 'fa-check');

                // Revert after 2 seconds
                setTimeout(() => {
                    if (button.classList.contains('added')) {
                        button.querySelector('i').classList.replace('fa-check', 'fa-cart-plus');
                    }
                }, 2000);
            } else {
                button.classList.remove('added');
                button.querySelector('i').classList.replace('fa-check', 'fa-cart-plus');
            }
        }

        // Update UI
        updateCartUI(data);
    } catch (error) {
        console.error('Error updating cart:', error);
        alert('Error: ' + error.message);
    }
}

// Update cart UI elements
function updateCartUI(data) {
    // Update cart badge
    const cartBadge = document.querySelector('.cart-badge');
    if (cartBadge) {
        cartBadge.textContent = data.itemCount;
    }

    // Update cart modal content
    updateCartModal(data);
}

// Update cart modal content
function updateCartModal(data) {
    const modalBody = document.querySelector('#shoppingCartModal .modal-body');
    const cartTotal = document.querySelector('.cart-total');

    if (!modalBody || !cartTotal) return;

    // Update total
    cartTotal.textContent = 'Rs. ' + data.cartTotal.toFixed(2);

    // Update cart items
    if (data.itemCount === 0) {
        modalBody.innerHTML = `
            <div class="cart-empty">
                <i class="fas fa-shopping-cart"></i>
                <p>Your cart is empty</p>
            </div>
        `;
    } else {
        let cartItemsHtml = '';
        data.cartItems.forEach(item => {
            cartItemsHtml += `
                <div class="cart-item">
                    <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80"
                         alt="Album Cover" class="cart-item-img">
                    <div class="cart-item-details">
                        <div class="cart-item-title">${escapeHtml(item.title)}</div>
                        <div class="cart-item-artist">by ${escapeHtml(item.artist)}</div>
                        <div class="cart-item-price">Rs. ${item.price.toFixed(2)}</div>
                    </div>
                    <button class="cart-item-remove" data-track-id="${item.trackId}">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
        });
        modalBody.innerHTML = cartItemsHtml;
    }
}

// Helper function to escape HTML
function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, function(m) { return map[m]; });
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\WEB-INF\web.xml
File type: .xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="https://jakarta.ee/xml/ns/jakartaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_6_0.xsd"
         version="6.0">
</web-app>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\WEB-INF\db\RhythmWaveDB.db
File type: .db
SQLite format 3   @                                                                   .zq
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            JitablenotemptynotemptyCREATE TABLE notempty (id integer primary key)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

--------------------------------------------------
File End
--------------------------------------------------


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\CartServlet.java
File type: .java
package controller;

import dao.CartDAO;
import dao.TrackDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;
import model.User;

import java.io.IOException;
import java.io.PrintWriter;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import com.google.gson.Gson;

@WebServlet(name = "CartServlet", value = "/CartServlet")
public class CartServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("application/json");
        response.setCharacterEncoding("UTF-8");
        PrintWriter out = response.getWriter();
        Gson gson = new Gson();

        try {
            String action = request.getParameter("action");
            String trackId = request.getParameter("trackId");

            HttpSession session = request.getSession();
            User user = (User) session.getAttribute("USER");

            // Get cart items - try database first, then session
            List<Track> cartItems = getCartItems(session, user);

            // Handle getState action
            if ("getState".equals(action)) {
                double cartTotal = calculateTotal(cartItems);
                int itemCount = cartItems.size();

                CartResponse cartResponse = new CartResponse(
                        cartItems != null ? cartItems : new ArrayList<>(),
                        cartTotal,
                        itemCount
                );

                out.print(gson.toJson(cartResponse));
                out.flush();
                return;
            }

            // Validate parameters for other actions
            if (trackId == null || trackId.trim().isEmpty()) {
                response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
                out.print(gson.toJson(new ErrorResponse("Track ID is required")));
                out.flush();
                return;
            }

            if (action == null || (!action.equals("add") && !action.equals("remove"))) {
                response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
                out.print(gson.toJson(new ErrorResponse("Invalid or missing action")));
                out.flush();
                return;
            }

            // Parse trackId and fetch track
            Track track;
            try {
                track = TrackDAO.findTrackById(Integer.parseInt(trackId));
            } catch (NumberFormatException e) {
                response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
                out.print(gson.toJson(new ErrorResponse("Invalid track ID format")));
                out.flush();
                return;
            } catch (SQLException e) {
                response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
                out.print(gson.toJson(new ErrorResponse("Database error occurred")));
                out.flush();
                return;
            }

            if (track == null) {
                response.setStatus(HttpServletResponse.SC_NOT_FOUND);
                out.print(gson.toJson(new ErrorResponse("Track not found")));
                out.flush();
                return;
            }

            Double cartTotal = 0.0;

            // Perform cart action
            switch (action) {
                case "add":
                    addItemToCart(cartItems, track, user);
                    cartTotal = calculateTotal(cartItems);
                    System.out.println("Item Added to Cart: " + trackId);
                    break;
                case "remove":
                    removeFromCart(cartItems, track, user);
                    cartTotal = calculateTotal(cartItems);
                    System.out.println("Item Removed from Cart: " + trackId);
                    break;
            }

            // Update cart in session
            session.setAttribute("cartItems", cartItems);
            session.setAttribute("cartTotal", cartTotal);

            // Respond with JSON
            CartResponse cartResponse = new CartResponse(cartItems, cartTotal, cartItems.size());
            out.print(gson.toJson(cartResponse));
            out.flush();

        } catch (Exception e) {
            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
            out.print(gson.toJson(new ErrorResponse("Unexpected error: " + e.getMessage())));
            out.flush();
            e.printStackTrace();
        }
    }

    private List<Track> getCartItems(HttpSession session, User user) {
        List<Track> cartItems = (List<Track>) session.getAttribute("cartItems");

        // If user is logged in and session cart is empty, try to load from database
        if (user != null && (cartItems == null || cartItems.isEmpty())) {
            try {
                cartItems = CartDAO.getCartItems(user.getUserId());
                session.setAttribute("cartItems", cartItems);
            } catch (SQLException e) {
                System.err.println("Error loading cart from database: " + e.getMessage());
                cartItems = new ArrayList<>();
            }
        } else if (cartItems == null) {
            cartItems = new ArrayList<>();
        }

        return cartItems;
    }

    private void addItemToCart(List<Track> cartItems, Track track, User user) throws SQLException {
        // Check if track already exists in cart
        boolean exists = false;
        for (Track item : cartItems) {
            if (item.getTrackId() == track.getTrackId()) {
                exists = true;
                break;
            }
        }

        if (!exists) {
            cartItems.add(track);

            // If user is logged in, save to database
            if (user != null) {
                CartDAO.addToCart(user.getUserId(), track.getTrackId());
            }
        }
    }

    private void removeFromCart(List<Track> cartItems, Track track, User user) throws SQLException {
        // Find and remove the track by ID
        for (int i = 0; i < cartItems.size(); i++) {
            if (cartItems.get(i).getTrackId() == track.getTrackId()) {
                cartItems.remove(i);

                // If user is logged in, remove from database
                if (user != null) {
                    CartDAO.removeFromCart(user.getUserId(), track.getTrackId());
                }
                break;
            }
        }
    }

    private double calculateTotal(List<Track> cartItems) {
        double total = 0;
        if (cartItems != null) {
            for (Track track : cartItems) {
                total += track.getPrice();
            }
        }
        return total;
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        doGet(request, response);
    }

    // Inner class for JSON response
    private static class CartResponse {
        private List<Track> cartItems;
        private double cartTotal;
        private int itemCount;

        public CartResponse(List<Track> cartItems, double cartTotal, int itemCount) {
            this.cartItems = cartItems;
            this.cartTotal = cartTotal;
            this.itemCount = itemCount;
        }

        // Add getters for JSON serialization
        public List<Track> getCartItems() { return cartItems; }
        public double getCartTotal() { return cartTotal; }
        public int getItemCount() { return itemCount; }
    }

    // Inner class for error response
    private static class ErrorResponse {
        private String error;

        public ErrorResponse(String error) {
            this.error = error;
        }

        public String getError() { return error; }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\IndexServlet.java
File type: .java
package controller;

import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;

import java.io.IOException;

@WebServlet(name = "IndexServlet", value = {"", "/index"}, loadOnStartup = 1)
public class IndexServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.sendRedirect(request.getContextPath() + "/trackPaginate");
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\SearchServlet.java
File type: .java
package controller;

import dao.TrackDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.util.*;

@WebServlet("/search")
public class SearchServlet extends HttpServlet {
    private final int RECORDS_PER_PAGE = 8;

    @Override
    public void init() throws ServletException {
        TrackDAO.ensureTableExists();
    }

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // Retrieve search parameters
        String title = request.getParameter("query");
        String genre = request.getParameter("genre");
        String priceRange = request.getParameter("price");
        String rating = request.getParameter("rating");

        // Parse price range
        Double minPrice = null;
        Double maxPrice = null;
        if (priceRange != null && !priceRange.isEmpty()) {
            switch (priceRange) {
                case "under100":
                    maxPrice = 100.0;
                    break;
                case "100-200":
                    minPrice = 100.0;
                    maxPrice = 200.0;
                    break;
                case "200-400":
                    minPrice = 200.0;
                    maxPrice = 400.0;
                    break;
                case "over400":
                    minPrice = 400.0;
                    break;
            }
        }

        // Parse rating
        Double minRating = null;
        if (rating != null && !rating.isEmpty()) {
            try {
                minRating = Double.parseDouble(rating);
            } catch (NumberFormatException e) {
                minRating = null;
            }
        }

        // Handle pagination
        int page = 1;
        if (request.getParameter("page") != null) {
            try {
                page = Integer.parseInt(request.getParameter("page"));
            } catch (NumberFormatException e) {
                page = 1;
            }
        }

        List<Track> tracks = new ArrayList<>();
        int noOfRecords = 0;
        int noOfPages = 0;

        try {
            // Check if no search parameters are provided
            if ((title == null || title.isEmpty()) &&
                    (genre == null || genre.isEmpty()) &&
                    (priceRange == null || priceRange.isEmpty()) &&
                    (rating == null || rating.isEmpty())) {
                // Fetch all tracks with pagination
                tracks = TrackDAO.getAllTracksPaginated(page, RECORDS_PER_PAGE);
                noOfRecords = TrackDAO.countAllTracks();
            } else {
                // Use TrackDAO to search products
                tracks = TrackDAO.searchProducts(title, genre, minPrice, maxPrice, minRating, page, RECORDS_PER_PAGE);
                noOfRecords = TrackDAO.countProducts(title, genre, minPrice, maxPrice);
            }
            noOfPages = (int) Math.ceil(noOfRecords * 1.0 / RECORDS_PER_PAGE);

        } catch (Exception e) {
            e.printStackTrace();
        }

        // Set attributes for JSP
        request.setAttribute("trackList", tracks);
        request.setAttribute("noOfPages", noOfPages);
        request.setAttribute("currentPage", page);

        // Forward to JSP
        RequestDispatcher rd = request.getRequestDispatcher("searchMusic.jsp");
        rd.forward(request, response);
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\TrackPaginationServlet.java
File type: .java
package controller;

import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.util.*;

@WebServlet("/trackPaginate")
public class TrackPaginationServlet extends HttpServlet {
    private final int RECORDS_PER_PAGE = 8;

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        int page = 1;
        if (request.getParameter("page") != null) {
            page = Integer.parseInt(request.getParameter("page"));
        }

        List<Track> tracks = new ArrayList<>();
        int noOfRecords = 0;
        int noOfPages = 0;

        try {

            Connection conn = DatabaseConnection.getConnection();

            // Fetch limited songs
            PreparedStatement ps = conn.prepareStatement(
                    "SELECT * FROM tracks ORDER BY trackId OFFSET ? ROWS FETCH NEXT ? ROWS ONLY");
            ps.setInt(1, (page - 1) * RECORDS_PER_PAGE);
            ps.setInt(2, RECORDS_PER_PAGE);

            ResultSet rs = ps.executeQuery();
            while (rs.next()) {
                Track track = new Track(
                        rs.getString("title"),
                        rs.getString("artist")
                );
                track.setTrackId(rs.getInt("trackId"));
                track.setPrice(rs.getDouble("price"));
                tracks.add(track);
            }
            rs.close();

            // Get total rows
            Statement stmt = conn.createStatement();
            rs = stmt.executeQuery("SELECT COUNT(*) FROM tracks");
            if (rs.next()) {
                noOfRecords = rs.getInt(1);
            }
            noOfPages = (int) Math.ceil(noOfRecords * 1.0 / RECORDS_PER_PAGE);

            rs.close();

            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

        request.setAttribute("trackList", tracks);
        request.setAttribute("noOfPages", noOfPages);
        request.setAttribute("currentPage", page);

        RequestDispatcher rd = request.getRequestDispatcher("index.jsp");
        rd.forward(request, response);
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\TrackServlet.java
File type: .java
package controller;

import dao.TrackDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;

import java.io.IOException;
import java.sql.SQLException;
import java.util.LinkedList;
import java.util.List;

@WebServlet(name = "TrackServlet", value = "/TrackServlet")
public class TrackServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        LinkedList<Track> allTracks = new LinkedList<>();
        try {
            allTracks = TrackDAO.getAllTracks();
            request.setAttribute("allTracks", allTracks);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        request.getRequestDispatcher("TrackList.jsp").forward(request, response);

    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\MarketingManagement\ImageServlet.java
File type: .java
package controller.MarketingManagement;

import dao.AdvertisementDAO;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import model.Advertisement;

import java.io.IOException;
import java.sql.SQLException;

@WebServlet("/image")
public class ImageServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String adIdStr = request.getParameter("adId");
        if (adIdStr == null || adIdStr.isEmpty()) {
            response.sendError(HttpServletResponse.SC_BAD_REQUEST, "Advertisement ID is required.");
            return;
        }

        try {
            int adId = Integer.parseInt(adIdStr);
            Advertisement ad = AdvertisementDAO.findAdvertisementById(adId);
            if (ad == null || ad.getImageData() == null) {
                response.sendError(HttpServletResponse.SC_NOT_FOUND, "Image not found.");
                return;
            }

            response.setContentType("image/jpeg"); // Adjust based on actual image type if needed
            response.getOutputStream().write(ad.getImageData());
            response.getOutputStream().flush();
        } catch (SQLException e) {
            response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "Database error occurred.");
        } catch (NumberFormatException e) {
            response.sendError(HttpServletResponse.SC_BAD_REQUEST, "Invalid advertisement ID.");
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\MarketingManagement\MarketingServlet.java
File type: .java
package controller.MarketingManagement;

import dao.AdvertisementDAO;
import dao.PromotionDAO;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.MultipartConfig;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.*;
import model.Advertisement;
import model.Promotion;

import java.io.IOException;
import java.io.InputStream;
import java.sql.SQLException;
import java.time.LocalDate;
import java.util.LinkedList;

@WebServlet("/marketing")
@MultipartConfig(fileSizeThreshold = 1024 * 1024 * 2, // 2MB
        maxFileSize = 1024 * 1024 * 10,      // 10MB
        maxRequestSize = 1024 * 1024 * 50)    // 50MB
public class MarketingServlet extends HttpServlet {

    private static final String[] ALLOWED_EXTENSIONS = {".png", ".jpg", ".jpeg"};

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String action = request.getParameter("action");

        HttpSession session = request.getSession();

        if (action.startsWith("ad_")) {
            handleAdvertisementAction(request, response, action.substring(3));
        } else {
            switch (action) {
                case "add":
                    String code = request.getParameter("code");
                    double discount = Double.parseDouble(request.getParameter("discount"));
                    LocalDate startDate = LocalDate.parse(request.getParameter("startDate"));
                    LocalDate endDate = LocalDate.parse(request.getParameter("endDate"));
                    String description = request.getParameter("description");
                    addPromotion(code, discount, startDate, endDate, description);
                    break;
                case "update":
                    int promotionId = Integer.parseInt(request.getParameter("promotionId"));
                    String updateCode = request.getParameter("code");
                    double updateDiscount = Double.parseDouble(request.getParameter("discount"));
                    LocalDate updateStartDate = LocalDate.parse(request.getParameter("startDate"));
                    LocalDate updateEndDate = LocalDate.parse(request.getParameter("endDate"));
                    int usageCount = Integer.parseInt(request.getParameter("usageCount"));
                    String updateDescription = request.getParameter("description");
                    updatePromotion(promotionId, updateCode, updateDiscount, updateStartDate, updateEndDate, usageCount, updateDescription);
                    break;
                case "delete":
                    int deletePromotionId = Integer.parseInt(request.getParameter("promotionId"));
                    deletePromotion(deletePromotionId);
                    break;
                case "track":
                    String trackCode = request.getParameter("code");
                    trackPromotion(trackCode, response);
                    return; // Don't redirect, print directly
            }
        }

        response.sendRedirect(request.getContextPath() + "/marketing");
    }

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession();

        LinkedList<Promotion> allPromotions = new LinkedList<>();
        LinkedList<Advertisement> allAdvertisements = new LinkedList<>();
        try {
            allPromotions = PromotionDAO.getPromotions();
            allAdvertisements = AdvertisementDAO.getAdvertisements();
        } catch (SQLException e) {
            throw new RuntimeException("Database error: " + e.getMessage());
        }

        req.setAttribute("allPromotions", allPromotions);
        req.setAttribute("allAdvertisements", allAdvertisements);
        RequestDispatcher rd = req.getRequestDispatcher("admin/ManageMarketing.jsp");
        rd.forward(req, resp);
    }

    private void handleAdvertisementAction(HttpServletRequest request, HttpServletResponse response, String action) throws IOException, ServletException {
        switch (action) {
            case "add":
                String title = request.getParameter("title");
                String content = request.getParameter("content");
                String imageUrl = request.getParameter("imageUrl");
                LocalDate startDate = LocalDate.parse(request.getParameter("startDate"));
                LocalDate endDate = LocalDate.parse(request.getParameter("endDate"));
                boolean active = Boolean.parseBoolean(request.getParameter("active"));
                byte[] imageData = handleFileUpload(request);
                addAdvertisement(title, content, imageData, imageUrl, startDate, endDate, active);
                break;
            case "update":
                int adId = Integer.parseInt(request.getParameter("adId"));
                String updateTitle = request.getParameter("title");
                String updateContent = request.getParameter("content");
                String updateImageUrl = request.getParameter("imageUrl");
                LocalDate updateStartDate = LocalDate.parse(request.getParameter("startDate"));
                LocalDate updateEndDate = LocalDate.parse(request.getParameter("endDate"));
                boolean updateActive = Boolean.parseBoolean(request.getParameter("active"));
                byte[] updateImageData = handleFileUpload(request);
                updateAdvertisement(adId, updateTitle, updateContent, updateImageData, updateImageUrl, updateStartDate, updateEndDate, updateActive);
                break;
            case "delete":
                int deleteAdId = Integer.parseInt(request.getParameter("adId"));
                deleteAdvertisement(deleteAdId);
                break;
        }
    }

    private void addPromotion(String code, double discount, LocalDate startDate, LocalDate endDate, String description) {
        try {
            Promotion promotion = new Promotion(code, discount, startDate, endDate, 0, description);
            PromotionDAO.addPromotion(promotion);
        } catch (SQLException | IOException e) {
            System.out.println("SQL Issue! Promotion not Added! " + e.getMessage());
        }
    }

    private void updatePromotion(int promotionId, String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) {
        try {
            PromotionDAO.updatePromotion(promotionId, code, discount, startDate, endDate, usageCount, description);
        } catch (SQLException | IOException e) {
            System.out.println("Promotion Update Failed. SQL Error: " + e.getMessage());
        }
    }

    private void deletePromotion(int promotionId) {
        try {
            Promotion promo = PromotionDAO.findPromotionById(promotionId);
            PromotionDAO.removePromotion(promo);
        } catch (SQLException | IOException e) {
            System.out.println("Promotion Delete Failed. SQL Error: " + e.getMessage());
        }
    }

    private void trackPromotion(String code, HttpServletResponse response) throws IOException {
        try {
            int usage = PromotionDAO.trackUsage(code);
            response.getWriter().println("Usage count for promo " + code + ": " + usage);
        } catch (SQLException e) {
            System.out.println("Tracking Failed. SQL Error: " + e.getMessage());
            response.getWriter().println("Error tracking promo.");
        }
    }

    private void addAdvertisement(String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        try {
            Advertisement ad = new Advertisement(title, content, imageData, imageUrl, startDate, endDate, active);
            AdvertisementDAO.addAdvertisement(ad);
        } catch (SQLException | IOException e) {
            System.out.println("SQL Issue! Advertisement not Added! " + e.getMessage());
        }
    }

    private void updateAdvertisement(int adId, String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        try {
            AdvertisementDAO.updateAdvertisement(adId, title, content, imageData, imageUrl, startDate, endDate, active);
        } catch (SQLException | IOException e) {
            System.out.println("Advertisement Update Failed. SQL Error: " + e.getMessage());
        }
    }

    private void deleteAdvertisement(int adId) {
        try {
            AdvertisementDAO.deleteAdvertisement(adId);
        } catch (SQLException | IOException e) {
            System.out.println("Advertisement Delete Failed. SQL Error: " + e.getMessage());
        }
    }

    private byte[] handleFileUpload(HttpServletRequest request) throws IOException, ServletException {
        Part filePart = request.getPart("imageFile");
        if (filePart == null || filePart.getSize() == 0) {
            return null; // No new image uploaded
        }

        String fileName = extractFileName(filePart);
        String extension = fileName.substring(fileName.lastIndexOf(".")).toLowerCase();
        if (!isValidExtension(extension)) {
            throw new ServletException("Invalid file type. Only PNG, JPG, and JPEG are allowed.");
        }

        try (InputStream input = filePart.getInputStream()) {
            return input.readAllBytes();
        }
    }

    private String extractFileName(Part part) {
        String contentDisp = part.getHeader("content-disposition");
        String[] items = contentDisp.split(";");
        for (String s : items) {
            if (s.trim().startsWith("filename")) {
                return s.substring(s.indexOf("=") + 2, s.length() - 1);
            }
        }
        return "";
    }

    private boolean isValidExtension(String extension) {
        for (String allowedExt : ALLOWED_EXTENSIONS) {
            if (allowedExt.equals(extension)) {
                return true;
            }
        }
        return false;
    }

}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\OrderManagement\OrderDetailsServlet.java
File type: .java
package controller.OrderManagement;

import dao.CartDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;
import model.User;

import java.io.IOException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

@WebServlet(name = "OrderDetailsServlet", value = "/orderDetails")
public class OrderDetailsServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        List<Track> cartItems = new ArrayList<>();
        HttpSession session = request.getSession(false);
        User user = (User) session.getAttribute("USER");

        if (user == null) {
            response.sendRedirect(request.getContextPath() + "/login");
        }

        cartItems = (List<Track>) session.getAttribute("cartItems");

        if (cartItems.isEmpty()) {
            try {
                cartItems = CartDAO.getCartItems(user.getUserId());
            } catch (SQLException e) {
                throw new RuntimeException(e);
            }
        }

        request.setAttribute("cartItems", cartItems);
        request.getRequestDispatcher("/order_details.jsp").forward(request, response);

    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\LoginServlet.java
File type: .java
package controller.UserAuth;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.*;
import model.User;
import dao.UserDAO;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.SQLException;

@WebServlet("/LoginServlet")
public class LoginServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String email = request.getParameter("email");
        String password = request.getParameter("password");
        boolean remember = Boolean.parseBoolean(request.getParameter("remember-me"));

        if (email == null || password == null) {
            response.sendRedirect("login.jsp");
        }

        User loginUser = null;

        try {
            loginUser = UserDAO.findUserByEmail(email);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        if (loginUser == null) {
            request.setAttribute("error", "Incorrect Email or Password");
            RequestDispatcher rd = request.getRequestDispatcher("login.jsp");
            rd.forward(request, response);
        } else if (PasswordUtil.checkPassword(password, loginUser.getPassword())) {
            HttpSession session = request.getSession();
            session.setAttribute("USER", loginUser);

            if (remember) {
                Cookie cookie = new Cookie("userId", String.valueOf(loginUser.getUserId()));
                cookie.setMaxAge(60 * 60 * 24 * 7);
                response.addCookie(cookie);
            }

            response.sendRedirect(request.getContextPath() + "/index");
        } else {
            request.setAttribute("error", "Wrong password");
            RequestDispatcher rd = request.getRequestDispatcher("login.jsp");
            rd.forward(request, response);
        }
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\LogoutServlet.java
File type: .java
package controller.UserAuth;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.*;

import java.io.IOException;

@WebServlet("/LogoutServlet")
public class LogoutServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        HttpSession session = request.getSession(false);
        if (session != null) {
            session.invalidate();
        }

        // Remove cookie
        Cookie cookie = new Cookie("userId", "");
        cookie.setMaxAge(0);
        response.addCookie(cookie);

        response.sendRedirect(request.getContextPath() + "/index");
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\filters\AdminFilter.java
File type: .java
package controller.UserAuth.filters;

import dao.UserDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.User;

import java.io.IOException;
import java.sql.SQLException;

@WebFilter("/admin/*")
public class AdminFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
                         FilterChain chain) throws IOException, ServletException {

        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse res = (HttpServletResponse) response;
        HttpSession session = req.getSession(false);

        // Check if user is logged in
        if (session == null || session.getAttribute("USER") == null) {
            System.out.println("No user session found - redirecting to login");
            res.sendRedirect(req.getContextPath() + "/login.jsp");
            return;
        }

        User user = (User) session.getAttribute("USER");

        // Check if user is admin
        if (user != null && user.isAdmin()) {
            System.out.println("User is Admin: " + user.getFirstName() + " is Logged");
            chain.doFilter(request, response);
        } else {
            System.out.println("User is not Admin or user is null");
            res.sendRedirect(req.getContextPath() + "/");
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\filters\AuthFilter.java
File type: .java
package controller.UserAuth.filters;

import dao.CartDAO;
import dao.UserDAO;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import model.Track;
import model.User;

import java.io.IOException;
import java.sql.SQLException;
import java.util.List;

@WebFilter("/*")
public class AuthFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
                         FilterChain chain) throws IOException, ServletException {

        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse res = (HttpServletResponse) response;
        HttpSession session = req.getSession(false);

        // If no session but cookie exists
        if (session == null || session.getAttribute("USER") == null) {
            Cookie[] cookies = req.getCookies();
            if (cookies != null) {
                for (Cookie cookie : cookies) {
                    if ("userId".equals(cookie.getName())) {
                        session = req.getSession(true);

                        try {
                            User user = UserDAO.findUserById(Integer.parseInt(cookie.getValue()));
                            if (user != null) {
                                session.setAttribute("USER", user);

                                // Load user's cart from database
                                List<Track> cartItems = CartDAO.getCartItems(user.getUserId());
                                session.setAttribute("cartItems", cartItems);

                                double cartTotal = calculateCartTotal(cartItems);
                                session.setAttribute("cartTotal", cartTotal);
                            }
                        } catch (SQLException e) {
                            throw new RuntimeException(e);
                        }
                    }
                }
            }
        }

        chain.doFilter(request, response);
    }

    private double calculateCartTotal(List<Track> cartItems) {
        double total = 0;
        if (cartItems != null) {
            for (Track track : cartItems) {
                total += track.getPrice();
            }
        }
        return total;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserAuth\filters\RoleFilter.java
File type: .java
package controller.UserAuth.filters;

import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import java.io.IOException;
import jakarta.servlet.*;
import jakarta.servlet.annotation.WebFilter;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import model.Admin;
import model.enums.AdminRole;

@WebFilter(urlPatterns = {"/manageUsers", "/marketing"})
public class RoleFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse resp = (HttpServletResponse) response;
        Admin user = (Admin) req.getSession().getAttribute("USER");

        if (user == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        boolean authorized = isAuthorized(req, user);

        if (authorized) {
            chain.doFilter(request, response);
        } else {
            resp.sendError(HttpServletResponse.SC_FORBIDDEN, "Access denied");
        }
    }

    private static boolean isAuthorized(HttpServletRequest req, Admin user) {
        String path = req.getServletPath();
        AdminRole role = user.getRole();
        boolean authorized = false;

        if ("/manageUsers".equals(path) && role == AdminRole.SUPER_ADMIN) {
            authorized = true;
        } else if ("/marketing".equals(path) && (role == AdminRole.SUPER_ADMIN || role == AdminRole.MARKETING_MANAGER)) {
            authorized = true;
        }

        return authorized;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserManagement\ManageUserServlet.java
File type: .java
package controller.UserManagement;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import model.Admin;
import model.User;
import model.enums.AdminRole;
import dao.UserDAO;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.SQLException;
import java.util.Arrays;
import java.util.LinkedList;
import java.util.stream.Collectors;

@WebServlet("/manageUsers")
public class ManageUserServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String action = request.getParameter("action");
        String firstName = request.getParameter("firstName");
        String lastName = request.getParameter("lastName");
        String email = request.getParameter("email");
        String password = request.getParameter("password");
        String role = request.getParameter("role");
        String newPassword = request.getParameter("editPassword");
        String adminRole = request.getParameter("adminRole");

        try {
            switch (action) {
                case "add":
                    addUser(firstName, lastName, email, password, role, adminRole, request, response);
                    break;
                case "update":
                    String userIdStr = request.getParameter("userId");
                    if (userIdStr == null || userIdStr.trim().isEmpty()) {
                        throw new IllegalArgumentException("User ID is missing");
                    }
                    try {
                        int userId = Integer.parseInt(userIdStr);
                        updateUser(userId, firstName, lastName, email, newPassword, role, adminRole, request, response);
                    } catch (NumberFormatException e) {
                        throw new IllegalArgumentException("Invalid User ID format: " + userIdStr);
                    }
                    break;
                case "delete":
                    int userId = Integer.parseInt(request.getParameter("userId"));
                    deleteUser(userId);
                    break;
                default:
                    throw new IllegalArgumentException("Invalid action: " + action);
            }
        } catch (IllegalArgumentException e) {
            request.setAttribute("error", e.getMessage());
            doGet(request, response); // Forward to JSP to display error
            return;
        }

        response.sendRedirect(request.getContextPath() + "/manageUsers");
    }

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        LinkedList<User> allUsers = new LinkedList<>();

        try {
            allUsers = UserDAO.getUsers();
        } catch (SQLException e) {
            req.setAttribute("error", "Failed to fetch users: " + e.getMessage());
        }

        // Set admin roles for JSP dropdowns
        req.setAttribute("adminRoles", Arrays.stream(AdminRole.values())
                .map(AdminRole::getRoleName)
                .collect(Collectors.toList()));
        req.setAttribute("allUsers", allUsers);
        RequestDispatcher rd = req.getRequestDispatcher("/admin/ManageUsers.jsp");
        rd.forward(req, resp);
    }

    private void addUser(String firstName, String lastName, String email, String password, String role, String adminRole, HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
        String passwordHash = PasswordUtil.hashPassword(password);

        try {
            switch (role) {
                case "admin":
                    Admin admin = new Admin(firstName, lastName, email, passwordHash);
                    if (adminRole != null && !adminRole.isEmpty()) {
                        admin.setRole(AdminRole.fromRoleName(adminRole));
                    }
                    UserDAO.addUser(admin);
                    break;
                case "user":
                    User user = new User(firstName, lastName, email, passwordHash);
                    UserDAO.addUser(user);
                    break;
                default:
                    throw new IllegalArgumentException("Invalid role: " + role);
            }
        } catch (SQLException | IOException e) {
            request.setAttribute("error", "Failed to add user: " + e.getMessage());
            doGet(request, response); // Forward to JSP to display error
        } catch (IllegalArgumentException e) {
            request.setAttribute("error", "Invalid admin role: " + e.getMessage());
            doGet(request, response); // Forward to JSP to display error
        }
    }

    private void updateUser(int userId, String firstName, String lastName, String email, String newPassword, String role, String adminRole, HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
        try {
            UserDAO.updateUser(userId, firstName, lastName, email, role);

            if (newPassword != null && !newPassword.isEmpty()) {
                UserDAO.updateUserPassword(userId, newPassword);
            }

            if ("admin".equals(role) && adminRole != null && !adminRole.isEmpty()) {
                UserDAO.updateAdminRole(userId, AdminRole.fromRoleName(adminRole));
            } else if ("user".equals(role)) {
                // Remove admin role if user is downgraded to non-admin
                UserDAO.updateAdminRole(userId, null);
            }

        } catch (SQLException | IOException e) {
            request.setAttribute("error", "Failed to update user: " + e.getMessage());
            doGet(request, response); // Forward to JSP to display error
        } catch (IllegalArgumentException e) {
            request.setAttribute("error", "Invalid admin role: " + e.getMessage());
            doGet(request, response); // Forward to JSP to display error
        }
    }

    private void deleteUser(int userId) throws IOException, ServletException {
        try {
            User user = UserDAO.findUserById(userId);
            if (user != null) {
                UserDAO.removeUser(user);
            }
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\controller\UserManagement\RegisterServlet.java
File type: .java
package controller.UserManagement;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import model.User;
import dao.UserDAO;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.SQLException;

@WebServlet("/RegisterServlet")
public class RegisterServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String firstName = request.getParameter("first-name");
        String lastName = request.getParameter("last-name");
        String email = request.getParameter("email");
        String password = request.getParameter("password");
        String likedGenre = request.getParameter("signup-genre");

        // Hashing the Password using Bcrypt
        String passwordHash = PasswordUtil.hashPassword(password);

        User user = new User(firstName, lastName, email, passwordHash);
        user.addLikedGenre(likedGenre);

        try {
            UserDAO.addUser(user);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
        System.out.println("User added Successfully");

        response.sendRedirect("login.jsp");

    }

}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\AdvertisementDAO.java
File type: .java
package dao;

import model.Advertisement;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.time.LocalDate;
import java.util.LinkedList;

public class AdvertisementDAO {

    static {
        ensureTableExists();
    }

    public static LinkedList<Advertisement> getAdvertisements() throws SQLException {
        LinkedList<Advertisement> allAds = new LinkedList<>();
        String sql = "SELECT * FROM advertisements";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                allAds.add(createAdvertisementFromResultSet(rs));
            }
        }

        return allAds;
    }

    public static LinkedList<Advertisement> getActiveAdvertisements() throws SQLException {
        LinkedList<Advertisement> activeAds = new LinkedList<>();
        String sql = "SELECT * FROM advertisements WHERE active = 1 AND startDate <= ? AND endDate >= ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            LocalDate now = LocalDate.now();
            pstmt.setDate(1, Date.valueOf(now));
            pstmt.setDate(2, Date.valueOf(now));

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                activeAds.add(createAdvertisementFromResultSet(rs));
            }
        }

        return activeAds;
    }

    public static void addAdvertisement(Advertisement ad) throws IOException, SQLException {
        if (ad != null) {
            try (Connection con = DatabaseConnection.getConnection()) {
                String sql = "INSERT INTO advertisements (title, content, imageData, imageUrl, startDate, endDate, active) VALUES (?, ?, ?, ?, ?, ?, ?)";
                PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);

                pstmt.setString(1, ad.getTitle());
                pstmt.setString(2, ad.getContent());
                if (ad.getImageData() != null) {
                    pstmt.setBytes(3, ad.getImageData());
                } else {
                    pstmt.setNull(3, Types.BINARY);
                }
                pstmt.setString(4, ad.getImageUrl());
                pstmt.setDate(5, Date.valueOf(ad.getStartDate()));
                pstmt.setDate(6, Date.valueOf(ad.getEndDate()));
                pstmt.setBoolean(7, ad.isActive());

                int result = pstmt.executeUpdate();

                try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                    if (generatedKeys.next()) {
                        ad.setAdId(generatedKeys.getInt(1));
                    }
                }
            }
        }
    }

    public static void updateAdvertisement(int adId, String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) throws IOException, SQLException {
        // Initialize StringBuilder for dynamic SQL query
        StringBuilder sql = new StringBuilder("UPDATE advertisements SET title = ?, content = ?, imageUrl = ?, startDate = ?, endDate = ?, active = ?");

        int paramIndex = 7;

        if (imageData != null) {
            sql.append(", imageData = ?");
        }
        sql.append(" WHERE adId = ?");

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql.toString())) {

            pstmt.setString(1, title);
            pstmt.setString(2, content);
            pstmt.setString(3, imageUrl);
            pstmt.setDate(4, Date.valueOf(startDate));
            pstmt.setDate(5, Date.valueOf(endDate));
            pstmt.setBoolean(6, active);

            // Set imageData parameter only if it is not null
            if (imageData != null) {
                pstmt.setBytes(paramIndex++, imageData);
            }

            // Set adId parameter
            pstmt.setInt(paramIndex, adId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating advertisement failed, no rows affected.");
            }
        }
    }

    public static void deleteAdvertisement(int adId) throws IOException, SQLException {
        String sql = "DELETE FROM advertisements WHERE adId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, adId);
            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Deleting advertisement failed, no rows affected.");
            }
        }
    }

    public static Advertisement findAdvertisementById(int adId) throws SQLException {
        String sql = "SELECT * FROM advertisements WHERE adId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, adId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createAdvertisementFromResultSet(rs);
                }
            }
        }
        return null;
    }

    private static Advertisement createAdvertisementFromResultSet(ResultSet rs) throws SQLException {
        return new Advertisement(
                rs.getInt("adId"),
                rs.getString("title"),
                rs.getString("content"),
                rs.getBytes("imageData"),
                rs.getString("imageUrl"),
                rs.getDate("startDate").toLocalDate(),
                rs.getDate("endDate").toLocalDate(),
                rs.getBoolean("active")
        );
    }

    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'advertisements') " +
                            "CREATE TABLE advertisements (" +
                            "adId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "title VARCHAR(100), " +
                            "content VARCHAR(255), " +
                            "imageData VARBINARY(MAX), " +
                            "imageUrl VARCHAR(255), " +
                            "startDate DATE, " +
                            "endDate DATE, " +
                            "active BIT" +
                            ")"
            );
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\CartDAO.java
File type: .java
package dao;

import model.Track;
import utils.DatabaseConnection;

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

public class CartDAO {

    static {
        ensureTableExists();
    }

    public static void addToCart(int userId, int trackId) throws SQLException {
        try (Connection conn = DatabaseConnection.getConnection()) {
            // Check if item already exists in cart
            String checkSql = "SELECT * FROM carts WHERE user_id = ? AND track_id = ?";
            PreparedStatement checkStmt = conn.prepareStatement(checkSql);
            checkStmt.setInt(1, userId);
            checkStmt.setInt(2, trackId);

            ResultSet rs = checkStmt.executeQuery();

            if (rs.next()) {
                // Item exists, update quantity
                String updateSql = "UPDATE carts SET quantity = quantity + 1 WHERE user_id = ? AND track_id = ?";
                PreparedStatement updateStmt = conn.prepareStatement(updateSql);
                updateStmt.setInt(1, userId);
                updateStmt.setInt(2, trackId);
                updateStmt.executeUpdate();
            } else {
                // Item doesn't exist, insert new
                String insertSql = "INSERT INTO carts (user_id, track_id, quantity) VALUES (?, ?, 1)";
                PreparedStatement insertStmt = conn.prepareStatement(insertSql);
                insertStmt.setInt(1, userId);
                insertStmt.setInt(2, trackId);
                insertStmt.executeUpdate();
            }
        }
    }

    public static void removeFromCart(int userId, int trackId) throws SQLException {
        try (Connection conn = DatabaseConnection.getConnection()) {
            String sql = "DELETE FROM carts WHERE user_id = ? AND track_id = ?";
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.setInt(1, userId);
            stmt.setInt(2, trackId);
            stmt.executeUpdate();
        }
    }

    public static List<Track> getCartItems(int userId) throws SQLException {
        List<Track> cartItems = new ArrayList<>();
        String sql = "SELECT t.*, c.quantity FROM carts c " +
                "JOIN tracks t ON c.track_id = t.trackId " +
                "WHERE c.user_id = ?";

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql)) {

            stmt.setInt(1, userId);
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                Track track = new Track(
                        rs.getInt("trackId"),
                        rs.getString("title"),
                        rs.getString("artist"),
                        rs.getDouble("price"),
                        rs.getString("genre"),
                        rs.getDouble("rating")
                );
                cartItems.add(track);
            }
        }
        return cartItems;
    }

    public static void clearCart(int userId) throws SQLException {
        try (Connection conn = DatabaseConnection.getConnection()) {
            String sql = "DELETE FROM carts WHERE user_id = ?";
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.setInt(1, userId);
            stmt.executeUpdate();
        }
    }

    public static int getCartItemCount(int userId) throws SQLException {
        String sql = "SELECT COUNT(*) as item_count FROM carts WHERE user_id = ?";

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql)) {

            stmt.setInt(1, userId);
            ResultSet rs = stmt.executeQuery();

            if (rs.next()) {
                return rs.getInt("item_count");
            }
        }
        return 0;
    }

    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {

            // Create carts table with proper structure
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'carts') " +
                            "CREATE TABLE carts (" +
                            "id INT IDENTITY(1,1) PRIMARY KEY, " +
                            "user_id INT NOT NULL, " +
                            "track_id INT NOT NULL, " +
                            "quantity INT NOT NULL DEFAULT 1, " +
                            "added_date DATETIME DEFAULT GETDATE(), " +
                            "FOREIGN KEY (user_id) REFERENCES users(userId) ON DELETE CASCADE, " +
                            "FOREIGN KEY (track_id) REFERENCES tracks(trackId) ON DELETE CASCADE, " +
                            "UNIQUE(user_id, track_id)" +
                            ")"
            );

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\PromotionDAO.java
File type: .java
package dao;

import model.Promotion;
import utils.DatabaseConnection;

import java.io.IOException;
import java.sql.*;
import java.time.LocalDate;
import java.util.LinkedList;

public class PromotionDAO {

    static {
        ensureTableExists();
    }

    public static LinkedList<Promotion> getPromotions() throws SQLException {
        LinkedList<Promotion> allPromotions = new LinkedList<>();
        String sql = "SELECT * FROM promotions";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                allPromotions.add(createPromotionFromResultSet(rs));
            }
        }

        return allPromotions;
    }

    public static void addPromotion(Promotion promotion) throws IOException, SQLException {
        if (promotion != null) {
            try (Connection con = DatabaseConnection.getConnection()) {
                System.out.println("Connected to Database!");

                String sql = "INSERT INTO promotions (code, discount, startDate, endDate, usageCount, description) VALUES (?, ?, ?, ?, ?, ?)";
                PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);

                pstmt.setString(1, promotion.getCode());
                pstmt.setDouble(2, promotion.getDiscount());
                pstmt.setDate(3, Date.valueOf(promotion.getStartDate()));
                pstmt.setDate(4, Date.valueOf(promotion.getEndDate()));
                pstmt.setInt(5, promotion.getUsageCount());
                pstmt.setString(6, promotion.getDescription());

                int result = pstmt.executeUpdate();

                System.out.println("Number of changes made " + result);

                try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                    if (generatedKeys.next()) {
                        promotion.setPromotionId(generatedKeys.getInt(1));
                    }
                }
            }
        }
    }

    public static void removePromotion(Promotion promotion) throws IOException, SQLException {
        if (promotion == null) {
            throw new IllegalArgumentException("Promotion cannot be null");
        }

        String sql = "DELETE FROM promotions WHERE promotionId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, promotion.getPromotionId());
            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Deleting promotion failed, no rows affected.");
            }

            System.out.println("Promotion deleted successfully. Rows affected: " + affectedRows);
        }
    }

    public static Promotion findPromotionById(int promotionId) throws SQLException {
        String sql = "SELECT * FROM promotions WHERE promotionId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, promotionId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createPromotionFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static Promotion findPromotionByCode(String code) throws SQLException {
        String sql = "SELECT * FROM promotions WHERE code = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createPromotionFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static void updatePromotion(int promotionId, String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) throws IOException, SQLException {
        String sql = "UPDATE promotions SET code = ?, discount = ?, startDate = ?, endDate = ?, usageCount = ?, description = ? WHERE promotionId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);
            pstmt.setDouble(2, discount);
            pstmt.setDate(3, Date.valueOf(startDate));
            pstmt.setDate(4, Date.valueOf(endDate));
            pstmt.setInt(5, usageCount);
            pstmt.setString(6, description);
            pstmt.setInt(7, promotionId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating promotion failed, no rows affected.");
            }

            System.out.println("Promotion updated successfully. Rows affected: " + affectedRows);
        }
    }

    public static void incrementUsageCount(String code) throws SQLException {
        String sql = "UPDATE promotions SET usageCount = usageCount + 1 WHERE code = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating usage count failed, no rows affected.");
            }

            System.out.println("Promotion usage count incremented successfully. Rows affected: " + affectedRows);
        }
    }

    public static int trackUsage(String code) throws SQLException {
        String sql = "SELECT COUNT(*) FROM bookings WHERE promoCode = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, code);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return rs.getInt(1);
                }
            }
        }
        return 0;
    }

    private static Promotion createPromotionFromResultSet(ResultSet rs) throws SQLException {
        return new Promotion(
                rs.getInt("promotionId"),
                rs.getString("code"),
                rs.getDouble("discount"),
                rs.getDate("startDate").toLocalDate(),
                rs.getDate("endDate").toLocalDate(),
                rs.getInt("usageCount"),
                rs.getString("description")
        );
    }

    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {

            // Create promotions table if it doesn't exist
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'promotions') " +
                            "BEGIN " +
                            "CREATE TABLE promotions (" +
                            "promotionId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "code VARCHAR(50) UNIQUE, " +
                            "discount DECIMAL(10,2), " +   // updated for larger amounts
                            "startDate DATE, " +
                            "endDate DATE, " +
                            "usageCount INT, " +
                            "description VARCHAR(255)" +
                            ")" +
                            "END"
            );
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\TrackDAO.java
File type: .java
package dao;

import model.Track;
import utils.DatabaseConnection;

import java.sql.*;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public class TrackDAO {

    static {
        ensureTableExists();
    }

    public static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {
            // Create tracks table
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'tracks') " +
                            "CREATE TABLE tracks (" +
                            "trackId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "title VARCHAR(50), " +
                            "artist VARCHAR(50), " +
                            "genre VARCHAR(20), " +
                            "rating FLOAT, " +
                            "price DECIMAL(10,2)" +
                            ")"
            );
        } catch (SQLException e) {
            throw new RuntimeException("Error creating tracks table", e);
        }
    }

    public static LinkedList<Track> getAllTracks() throws SQLException {
        LinkedList<Track> tracks = new LinkedList<>();
        String sql = "SELECT * FROM tracks";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql);
             ResultSet rs = pstmt.executeQuery()) {

            while (rs.next()) {
                Track track = new Track(
                        rs.getString("title"),
                        rs.getString("artist")
                );
                track.setTrackId(rs.getInt("trackId"));
                track.setPrice(rs.getDouble("price"));
                track.setGenre(rs.getString("genre"));
                track.setRating(rs.getDouble("rating"));
                tracks.add(track);
            }
        }
        return tracks;
    }

    public static List<Track> getAllTracksPaginated(int page, int pageSize) throws SQLException {
        List<Track> tracks = new ArrayList<>();
        String sql = "SELECT * FROM tracks ORDER BY trackId OFFSET ? ROWS FETCH NEXT ? ROWS ONLY";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, (page - 1) * pageSize);
            pstmt.setInt(2, pageSize);

            try (ResultSet rs = pstmt.executeQuery()) {
                while (rs.next()) {
                    Track track = new Track(
                            rs.getString("title"),
                            rs.getString("artist")
                    );
                    track.setTrackId(rs.getInt("trackId"));
                    track.setPrice(rs.getDouble("price"));
                    track.setGenre(rs.getString("genre"));
                    track.setRating(rs.getDouble("rating"));
                    tracks.add(track);
                }
            }
        }
        return tracks;
    }

    public static int countAllTracks() throws SQLException {
        String sql = "SELECT COUNT(*) FROM tracks";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql);
             ResultSet rs = pstmt.executeQuery()) {

            if (rs.next()) {
                return rs.getInt(1);
            }
        }
        return 0;
    }

    public static void addTrack(Track track) throws SQLException {
        if (track == null) return;

        String sql = "INSERT INTO tracks (title, artist, price, genre, rating) VALUES (?, ?, ?, ?, ?)";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS)) {

            pstmt.setString(1, track.getTitle());
            pstmt.setString(2, track.getArtist());
            pstmt.setDouble(3, track.getPrice());
            pstmt.setString(4, track.getGenre());
            pstmt.setDouble(5, track.getRating());
            pstmt.executeUpdate();

            try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                if (generatedKeys.next()) {
                    track.setTrackId(generatedKeys.getInt(1));
                }
            }
        }
    }

    public static void removeTrack(int trackId) throws SQLException {
        String sql = "DELETE FROM tracks WHERE trackId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, trackId);
            pstmt.executeUpdate();
        }
    }

    public static Track findTrackById(int trackId) throws SQLException {
        String sql = "SELECT * FROM tracks WHERE trackId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, trackId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    Track track = new Track(
                            rs.getString("title"),
                            rs.getString("artist")
                    );
                    track.setTrackId(rs.getInt("trackId"));
                    track.setPrice(rs.getDouble("price"));
                    track.setGenre(rs.getString("genre"));
                    track.setRating(rs.getDouble("rating"));
                    return track;
                }
            }
        }
        return null;
    }

    public static void updateTrack(Track track) throws SQLException {
        if (track == null) return;

        String sql = "UPDATE tracks SET title = ?, artist = ?, price = ?, genre = ?, rating = ? WHERE trackId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, track.getTitle());
            pstmt.setString(2, track.getArtist());
            pstmt.setDouble(3, track.getPrice());
            pstmt.setString(4, track.getGenre());
            pstmt.setDouble(5, track.getRating());
            pstmt.setInt(6, track.getTrackId());
            pstmt.executeUpdate();
        }
    }

    public static List<Track> searchProducts(String title,
                                             String genre,
                                             Double minPrice,
                                             Double maxPrice,
                                             Double rating,
                                             int page,
                                             int pageSize) {

        List<Track> list = new ArrayList<>();
        StringBuilder sql = new StringBuilder("SELECT * FROM tracks WHERE 1=1");
        List<Object> params = new ArrayList<>();

        if (title != null && !title.isEmpty()) {
            sql.append(" AND title LIKE ?");
            params.add("%" + title + "%");
        }

        if (genre != null && !genre.isEmpty()) {
            sql.append(" AND genre = ?");
            params.add(genre);
        }

        if (minPrice != null) {
            sql.append(" AND price >= ?");
            params.add(minPrice);
        }
        if (maxPrice != null) {
            sql.append(" AND price <= ?");
            params.add(maxPrice);
        }

        if (rating != null) {
            sql.append(" AND rating >= ?");
            params.add(rating);
        }

        sql.append(" ORDER BY trackId OFFSET ? ROWS FETCH NEXT ? ROWS ONLY");
        params.add((page - 1) * pageSize);
        params.add(pageSize);

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(sql.toString())) {

            for (int i = 0; i < params.size(); i++) {
                ps.setObject(i + 1, params.get(i));
            }

            ResultSet rs = ps.executeQuery();
            while (rs.next()) {
                list.add(new Track(
                        rs.getInt("trackId"),
                        rs.getString("title"),
                        rs.getString("artist"),
                        rs.getDouble("price"),
                        rs.getString("genre"),
                        rs.getDouble("rating")
                ));
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return list;
    }

    public static int countProducts(String title,
                                    String genre,
                                    Double minPrice,
                                    Double maxPrice) {

        StringBuilder sql = new StringBuilder("SELECT COUNT(*) FROM tracks WHERE 1=1");
        List<Object> params = new ArrayList<>();

        if (title != null && !title.isEmpty()) {
            sql.append(" AND title LIKE ?");
            params.add("%" + title + "%");
        }
        if (genre != null && !genre.isEmpty()) {
            sql.append(" AND genre = ?");
            params.add(genre);
        }

        if (minPrice != null) {
            sql.append(" AND price >= ?");
            params.add(minPrice);
        }
        if (maxPrice != null) {
            sql.append(" AND price <= ?");
            params.add(maxPrice);
        }

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(sql.toString())) {

            for (int i = 0; i < params.size(); i++) {
                ps.setObject(i + 1, params.get(i));
            }

            ResultSet rs = ps.executeQuery();
            if (rs.next()) return rs.getInt(1);

        } catch (Exception e) {
            e.printStackTrace();
        }

        return 0;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\dao\UserDAO.java
File type: .java
package dao;

import model.Admin;
import model.User;
import model.enums.AdminRole;
import utils.DatabaseConnection;
import utils.PasswordUtil;

import java.io.IOException;
import java.sql.*;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public class UserDAO {

    static {
        ensureTableExists();
    }

    public static LinkedList<User> getUsers() throws SQLException {
        LinkedList<User> allUsers = new LinkedList<>();
        String sql = "SELECT * FROM users";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                allUsers.add(createUserFromResultSet(rs));
            }
        }

        return allUsers;
    }

    public static void addUser(User user) throws IOException, SQLException {
        if (user == null) {
            throw new IllegalArgumentException("User cannot be null");
        }

        try (Connection con = DatabaseConnection.getConnection()) {
            System.out.println("Connected to Database!");

            String sql = "INSERT INTO users (role, firstName, lastName, email, password) VALUES (?, ?, ?, ?, ?)";
            PreparedStatement pstmt = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);

            pstmt.setString(1, user.isAdmin() ? "adminUser" : "standardUser");
            pstmt.setString(2, user.getFirstName());
            pstmt.setString(3, user.getLastName());
            pstmt.setString(4, user.getEmail());
            pstmt.setString(5, user.getPassword());

            int result = pstmt.executeUpdate();

            System.out.println("Number of changes made " + result);

            try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                if (generatedKeys.next()) {
                    user.setUserId(generatedKeys.getInt(1));
                }
            }

            // Insert Liked Genres to table
            if (user.getLikedGenres() != null) {
                String genreSql = "INSERT INTO UserGenres (userId, genre) VALUES (?, ?)";
                try (PreparedStatement ps2 = con.prepareStatement(genreSql)) {
                    for (String genre : user.getLikedGenres()) {
                        ps2.setInt(1, user.getUserId());
                        ps2.setString(2, genre);
                        ps2.addBatch();
                    }
                    ps2.executeBatch();
                }
            }

            // Insert Admin Role to table if user is Admin and role is set
            if (user.isAdmin() && user instanceof Admin) {
                Admin admin = (Admin) user;
                if (admin.getRole() != null) {
                    String roleSql = "INSERT INTO AdminRoles (userId, role) VALUES (?, ?)";
                    try (PreparedStatement ps3 = con.prepareStatement(roleSql)) {
                        ps3.setInt(1, user.getUserId());
                        ps3.setString(2, admin.getRole().getRoleName());
                        ps3.executeUpdate();
                    }
                }
            }
        }
    }

    public static void removeUser(User user) throws IOException, SQLException {
        if (user == null) {
            throw new IllegalArgumentException("User cannot be null");
        }

        String sql = "DELETE FROM users WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, user.getUserId());
            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Deleting user failed, no rows affected.");
            }

            System.out.println("User deleted successfully. Rows affected: " + affectedRows);
        }
    }

    public static User findUserById(int userId) throws SQLException {
        String sql = "SELECT * FROM users WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, userId);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createUserFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static User findUserByEmail(String email) throws SQLException {
        String sql = "SELECT * FROM users WHERE email = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, email);

            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return createUserFromResultSet(rs);
                }
            }
        }
        return null;
    }

    public static void updateUser(int userId, String firstName, String lastName, String email, String role) throws IOException, SQLException {
        String sql = "UPDATE users SET firstName = ?, lastName = ?, email = ?, role = ? WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setString(1, firstName);
            pstmt.setString(2, lastName);
            pstmt.setString(3, email);
            pstmt.setString(4, (role.equals("admin")) ? "adminUser" : "standardUser");
            pstmt.setInt(5, userId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating user failed, no rows affected.");
            }

            System.out.println("User updated successfully. Rows affected: " + affectedRows);
        }
    }

    public static void updateUserPassword(int userId, String newPassword) throws IOException, SQLException {
        String sql = "UPDATE users SET password = ? WHERE userId = ?";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            String hashPassword = PasswordUtil.hashPassword(newPassword);

            pstmt.setString(1, hashPassword);
            pstmt.setInt(2, userId);

            int affectedRows = pstmt.executeUpdate();

            if (affectedRows == 0) {
                throw new SQLException("Updating user failed, no rows affected.");
            }

            System.out.println("User updated successfully. Rows affected: " + affectedRows);
        }
    }

    public static void updateAdminRole(int userId, AdminRole newRole) throws SQLException {
        String sql = "MERGE INTO AdminRoles AS target " +
                "USING (SELECT ? AS userId, ? AS role) AS source " +
                "ON target.userId = source.userId " +
                "WHEN MATCHED THEN UPDATE SET role = source.role " +
                "WHEN NOT MATCHED THEN INSERT (userId, role) VALUES (source.userId, source.role);";

        try (Connection con = DatabaseConnection.getConnection();
             PreparedStatement pstmt = con.prepareStatement(sql)) {

            pstmt.setInt(1, userId);
            pstmt.setString(2, newRole.getRoleName());

            int affectedRows = pstmt.executeUpdate();

            System.out.println("Admin role updated successfully. Rows affected: " + affectedRows);
        }
    }

    private static User createUserFromResultSet(ResultSet rs) throws SQLException {
        boolean isAdmin = "adminUser".equals(rs.getString("role"));

        if (isAdmin) {
            Admin admin = new Admin(
                    rs.getInt("userId"),
                    rs.getString("firstName"),
                    rs.getString("lastName"),
                    rs.getString("email"),
                    rs.getString("password")
            );

            admin.setLikedGenres(getUserLikedGenres(rs.getInt("userId")));
            admin.setRole(getAdminRole(rs.getInt("userId")));
            return admin;

        } else {
            User user = new User(
                    rs.getInt("userId"),
                    rs.getString("firstName"),
                    rs.getString("lastName"),
                    rs.getString("email"),
                    rs.getString("password")
            );

            user.setLikedGenres(getUserLikedGenres(rs.getInt("userId")));
            return user;
        }
    }

    private static AdminRole getAdminRole(int userId) throws SQLException {
        String sql = "SELECT role FROM AdminRoles WHERE userId = ?";

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setInt(1, userId);
            ResultSet rs = ps.executeQuery();

            if (rs.next()) {
                return AdminRole.fromRoleName(rs.getString("role"));
            }
        }
        return null;
    }

    private static List<String> getUserLikedGenres(int userId) throws SQLException {
        List<String> genres = new ArrayList<>();
        try (Connection conn = DatabaseConnection.getConnection()) {
            String genreSql = "SELECT genre FROM UserGenres WHERE userId = ?";

            try (PreparedStatement ps = conn.prepareStatement(genreSql)) {
                ps.setInt(1, userId);
                ResultSet rs = ps.executeQuery();

                while (rs.next()) {
                    genres.add(rs.getString("genre"));
                }
            }
        }
        return genres;
    }

    private static void ensureTableExists() {
        try (Connection con = DatabaseConnection.getConnection();
             Statement stmt = con.createStatement()) {
            // Create users table
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'users') " +
                            "CREATE TABLE users (" +
                            "userId INT IDENTITY(1,1) PRIMARY KEY, " +
                            "role VARCHAR(20), " +
                            "firstName VARCHAR(50), " +
                            "lastName VARCHAR(50), " +
                            "email VARCHAR(100) UNIQUE, " +
                            "password VARCHAR(255)" +
                            ")"
            );

            // Create UserGenres table
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'UserGenres') " +
                            "CREATE TABLE UserGenres (" +
                            "id INT PRIMARY KEY IDENTITY, " +
                            "userId INT, " +
                            "genre VARCHAR(50), " +
                            "FOREIGN KEY (userId) REFERENCES users(userId) ON DELETE CASCADE" +
                            ")"
            );

            // Create AdminRoles table
            stmt.executeUpdate(
                    "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'AdminRoles') " +
                            "CREATE TABLE AdminRoles (" +
                            "userId INT PRIMARY KEY, " +
                            "role VARCHAR(50), " +
                            "FOREIGN KEY (userId) REFERENCES users(userId) ON DELETE CASCADE" +
                            ")"
            );

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Admin.java
File type: .java
package model;

import model.enums.AdminRole;

public class Admin extends User {
    private AdminRole role;

    public Admin(String firstName, String lastName, String email, String password) {
        super(firstName, lastName, email, password);
        this.role = null;
    }

    public Admin(int userId, String firstName, String lastName, String email, String password) {
        super(userId, firstName, lastName, email, password);
        this.role = null;
    }

    @Override
    public boolean isAdmin() {
        return true;
    }

    @Override
    public String getRoleDescription() {
        return "Administrator";
    }

    public AdminRole getRole() {
        return role;
    }

    public void setRole(AdminRole role) {
        this.role = role;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Advertisement.java
File type: .java
package model;

import java.time.LocalDate;

public class Advertisement {
    private int adId;
    private String title;
    private String content;
    private byte[] imageData;
    private String imageUrl; // Optional, for external URLs
    private LocalDate startDate;
    private LocalDate endDate;
    private boolean active;

    public Advertisement(String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        this.title = title;
        this.content = content;
        this.imageData = imageData;
        this.imageUrl = imageUrl;
        this.startDate = startDate;
        this.endDate = endDate;
        this.active = active;
    }

    public Advertisement(int adId, String title, String content, byte[] imageData, String imageUrl, LocalDate startDate, LocalDate endDate, boolean active) {
        this.adId = adId;
        this.title = title;
        this.content = content;
        this.imageData = imageData;
        this.imageUrl = imageUrl;
        this.startDate = startDate;
        this.endDate = endDate;
        this.active = active;
    }

    // Getters and Setters
    public int getAdId() {
        return adId;
    }

    public void setAdId(int adId) {
        this.adId = adId;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getContent() {
        return content;
    }

    public void setContent(String content) {
        this.content = content;
    }

    public byte[] getImageData() {
        return imageData;
    }

    public void setImageData(byte[] imageData) {
        this.imageData = imageData;
    }

    public String getImageUrl() {
        return imageUrl;
    }

    public void setImageUrl(String imageUrl) {
        this.imageUrl = imageUrl;
    }

    public LocalDate getStartDate() {
        return startDate;
    }

    public void setStartDate(LocalDate startDate) {
        this.startDate = startDate;
    }

    public LocalDate getEndDate() {
        return endDate;
    }

    public void setEndDate(LocalDate endDate) {
        this.endDate = endDate;
    }

    public boolean isActive() {
        return active;
    }

    public void setActive(boolean active) {
        this.active = active;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Promotion.java
File type: .java
package model;

import java.time.LocalDate;

public class Promotion {
    private int promotionId;
    private String code;
    private double discount;
    private LocalDate startDate;
    private LocalDate endDate;
    private int usageCount;
    private String description;

    public Promotion(String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) {
        this.code = code;
        this.discount = discount;
        this.startDate = startDate;
        this.endDate = endDate;
        this.usageCount = usageCount;
        this.description = description;
    }

    public Promotion(int promotionId, String code, double discount, LocalDate startDate, LocalDate endDate, int usageCount, String description) {
        this.promotionId = promotionId;
        this.code = code;
        this.discount = discount;
        this.startDate = startDate;
        this.endDate = endDate;
        this.usageCount = usageCount;
        this.description = description;
    }

    // Getters and Setters
    public int getPromotionId() {
        return promotionId;
    }

    public void setPromotionId(int promotionId) {
        this.promotionId = promotionId;
    }

    public String getCode() {
        return code;
    }

    public void setCode(String code) {
        this.code = code;
    }

    public double getDiscount() {
        return discount;
    }

    public void setDiscount(double discount) {
        this.discount = discount;
    }

    public LocalDate getStartDate() {
        return startDate;
    }

    public void setStartDate(LocalDate startDate) {
        this.startDate = startDate;
    }

    public LocalDate getEndDate() {
        return endDate;
    }

    public void setEndDate(LocalDate endDate) {
        this.endDate = endDate;
    }

    public int getUsageCount() {
        return usageCount;
    }

    public void setUsageCount(int usageCount) {
        this.usageCount = usageCount;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\Track.java
File type: .java
package model;

public class Track {
    private int trackId;
    private String title;
    private String artist;
    private double price;
    private String genre;
    private double rating;

    public Track(
            int trackId,
            String title,
            String artist,
            double price,
            String genre,
            double rating) {

        this.trackId = trackId;
        this.title = title;
        this.artist = artist;
        this.price = price;
        this.genre = genre;
        this.rating = rating;
    }

    public Track(String title, String artist) {
        this.title = title;
        this.artist = artist;
    }

    public String getGenre() {
        return genre;
    }

    public void setGenre(String genre) {
        this.genre = genre;
    }

    public double getRating() {
        return rating;
    }

    public void setRating(double rating) {
        this.rating = rating;
    }

    public double getPrice() {
        return price;
    }

    public void setPrice(double price) {
        this.price = price;
    }

    public String getArtist() {
        return artist;
    }

    public int getTrackId() {
        return trackId;
    }

    public void setTrackId(int trackId) {
        this.trackId = trackId;
    }

    public void setArtist(String artist) {
        this.artist = artist;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\User.java
File type: .java
package model;

import java.util.ArrayList;
import java.util.List;

public class User {
    protected int userId;
    protected String firstName;
    protected String lastName;
    protected String email;
    protected String password;
    protected List<String> likedGenres = new ArrayList<>();

    public User(String firstName, String lastName, String email, String password) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.email = email;
        this.password = password;
    }

    public User(int userId, String firstName, String lastName, String email, String password) {
        this.userId = userId;
        this.firstName = firstName;
        this.lastName = lastName;
        this.email = email;
        this.password = password;
    }

    public void addLikedGenre(String genre) {
        if (likedGenres.isEmpty()){
            likedGenres.add(genre);
            return;
        }

        if (!(likedGenres.contains(genre)))
            likedGenres.add(genre);
    }

    public List<String> getLikedGenres() {
        return likedGenres;
    }

    public void setLikedGenres(List<String> likedGenres) {
        this.likedGenres = likedGenres;
    }

    public String likedGenreToString() {
        return String.join("|", likedGenres);
    }

    public int getUserId() {
        return userId;
    }

    public void setUserId(int userId) {
        this.userId = userId;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public boolean isAdmin() {
        return false;
    }

    public String getRoleDescription() {
        return "Standard User";
    }

}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\model\enums\AdminRole.java
File type: .java
package model.enums;

public enum AdminRole {
    SUPER_ADMIN("super_admin"),
    MARKETING_MANAGER("marketing_manager"),
    SUPPORT_ADMIN("support_admin"),
    FINANCE_ADMIN("finance_admin"),
    CONTENT_ADMIN("content_manager");

    private final String roleName;

    AdminRole(String roleName) {
        this.roleName = roleName;
    }

    public String getRoleName() {
        return roleName;
    }

    public static AdminRole fromRoleName(String roleName) {
        for (AdminRole role : AdminRole.values()) {
            if (role.roleName.equalsIgnoreCase(roleName)) {
                return role;
            }
        }
        throw new IllegalArgumentException("Invalid role name: " + roleName);
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\utils\DatabaseConnection.java
File type: .java
package utils;

import com.microsoft.sqlserver.jdbc.SQLServerConnection;

import java.io.IOException;
import java.io.InputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.Properties;

public class DatabaseConnection {
    private static String DB_URL = "jdbc:sqlserver://localhost;instanceName=SQLEXPRESS;database=test1;encrypt=true;trustServerCertificate=true";
    private static String DB_USER = "Prageeth";
    private static String DB_PASSWORD = "1234";

    public static Connection getConnection() throws SQLException {

        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
        } catch (ClassNotFoundException e) {
            System.out.println("Driver not found: " + e.getMessage());
        }

        return DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD);
    }

}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\utils\EmailHandleUtil.java
File type: .java
package utils;
import jakarta.mail.*;
import jakarta.mail.Message;
import jakarta.mail.Session;
import jakarta.mail.Transport;
import jakarta.mail.internet.InternetAddress;
import jakarta.mail.internet.MimeMessage;

import java.util.Properties;

public class EmailHandleUtil {
    public static void sendMail(String to, String subject, String body) throws Exception {
        final String username = "prageethperera2002@gmail.com";   // Your Gmail
        final String password = "bgma yxkv cvsq glzw";    // 16-char app password

        Properties props = new Properties();
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.host", "smtp.gmail.com");
        props.put("mail.smtp.port", "587"); // TLS port

        Session session = Session.getInstance(props, new Authenticator() {
            @Override
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(username, password);
            }
        });

        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress(username));
        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));
        message.setSubject(subject);

        message.setContent(body, "text/html; charset=utf-8");

        Transport.send(message);
        System.out.println("Email sent successfully to " + to);
    }

}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/java\utils\PasswordUtil.java
File type: .java
package utils;

import org.mindrot.jbcrypt.BCrypt;

public class PasswordUtil {

    // Hash the password
    public static String hashPassword(String plainPassword) {
        return BCrypt.hashpw(plainPassword, BCrypt.gensalt(12));
    }

    // Verify entered password against stored hash
    public static boolean checkPassword(String plainPassword, String hashedPassword) {
        return BCrypt.checkpw(plainPassword, hashedPassword);
    }
}


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/resources\config.properties
File type: .properties
db.url=jdbc:sqlserver://localhost;instanceName=SQLEXPRESS;database=test1;encrypt=true;trustServerCertificate=true;
db.user=sa
db.pass=1234

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\index.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RhythmWave Music Store</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/index.css">
</head>
<body>

<!-- Navigation Bar -->
<jsp:include page="/includes/navbar.jsp">
    <jsp:param name="page" value="index"/>
    <jsp:param name="user" value="${sessionScope.USER}"/>
</jsp:include>

<!-- Banner Section -->
<div class="container-fluid">
    <div class="banner">
        <c:choose>
            <c:when test="${empty sessionScope.USER}">
                <div class="container text-center">
                    <h1 class="display-4 fw-bold">Discover Your Soundtrack</h1>
                    <p class="lead">Millions of songs at your fingertips. Curated playlists and exclusive releases.</p>
                    <button class="btn btn-primary btn-lg mt-3">Explore Now</button>
                </div>
            </c:when>
            <c:otherwise>
                <div class="container text-center">
                    <h1 class="display-4 fw-bold">Welcome Back! ${sessionScope.USER.firstName}</h1>
                    <p class="lead">Millions of songs at your fingertips. Curated playlists and exclusive releases.</p>
                    <button class="btn btn-primary btn-lg mt-3">Explore Now</button>
                </div>
            </c:otherwise>
        </c:choose>
    </div>
</div>

<!-- Music Listing Section -->
<div class="container">
    <h2 class="mb-4">Featured Music</h2>
    <div class="row">
        <!-- Music Card -->
        <c:forEach var="track" items="${requestScope.trackList}">
            <div class="col-md-4 col-lg-3 mb-3">
                <div class="music-card">
                    <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80" class="album-cover" alt="Album Cover">
                    <div class="p-3">
                        <h5>${track.title}</h5>
                        <p class="artist-name">by ${track.artist}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="price-tag">Rs. ${track.price}</span>
                            <div class="d-flex">
                                <div class="play-btn me-2">
                                    <i class="fas fa-play"></i>
                                </div>
                                <c:if test="${not empty sessionScope.USER}">
                                    <button class="cart-btn" data-track-id="${track.trackId}">
                                        <i class="fas fa-cart-plus"></i>
                                    </button>
                                </c:if>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </c:forEach>

        <c:set var="currentPage" value="${requestScope.currentPage}"/>
        <c:set var="noOfPages" value="${requestScope.noOfPages}"/>

        <!-- Pagination -->
        <c:if test="${noOfPages > 1}">
            <nav class="mt-5">
                <ul class="pagination justify-content-center">
                    <li class="page-item ${currentPage == 1 ? 'disabled' : ''}">
                        <a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${currentPage - 1}">Previous</a>
                    </li>
                    <c:forEach var="i" begin="1" end="${noOfPages}">
                        <c:choose>
                            <c:when test="${i eq currentPage}">
                                <li class="page-item active"><a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${i}">${i}</a></li>
                            </c:when>
                            <c:otherwise>
                                <li class="page-item"><a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${i}">${i}</a></li>
                            </c:otherwise>
                        </c:choose>
                    </c:forEach>
                    <li class="page-item ${currentPage == noOfPages ? 'disabled' : ''}">
                        <a class="page-link" href="${pageContext.request.contextPath}/trackPaginate?page=${currentPage + 1}">Next</a>
                    </li>
                </ul>
            </nav>
        </c:if>
    </div>
</div>

<!-- Footer -->
<jsp:include page="includes/footer.jsp" />

<!-- Shopping Cart Modal -->
<jsp:include page="includes/modals/shoppingCartModal.jsp" />

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="${pageContext.request.contextPath}/js/music.js"></script>
<script src="${pageContext.request.contextPath}/js/cart.js"></script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\login.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RhythmWave - Login</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/login.css">
    <style>

    </style>
</head>
<body>
<!-- Auth Container -->
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <div class="auth-icon">
                <i class="fas fa-music"></i>
            </div>
            <h2>Welcome Back</h2>
            <p class="text-secondary">Sign in to your RhythmWave account</p>
        </div>

        <form id="loginForm" action="${pageContext.request.contextPath}/LoginServlet" method="post">
            <div class="mb-3">
                <label for="login-email" class="form-label">Email address</label>
                <input type="email" class="form-control" id="login-email" name="email" placeholder="name@example.com" required>
            </div>

            <div class="mb-3 password-input-group">
                <label for="login-password" class="form-label">Password</label>
                <input type="password" class="form-control" id="login-password" name="password" placeholder="Enter your password" required>
            </div>

            <div class="mb-3 d-flex justify-content-between align-items-center">
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="remember-me" name="remember-me" value="true">
                    <label class="form-check-label" for="remember-me">Remember me</label>
                </div>
                <a href="#" class="text-primary">Forgot password?</a>
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg">Login</button>
                <a href="signup.jsp" class="btn btn-outline-light">Don't have an account? Sign Up</a>
            </div>
        </form>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Form validation
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            if (!email || !password) {
                e.preventDefault()
                alert('Please fill in all fields');
            }

        });
    });
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\order_details.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RhythmWave - Order Details</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/theme.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/index.css">
    <style>
        body {
            background-color: var(--dark-bg);
            color: var(--text-primary);
        }
        .order-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .order-header {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #333;
            text-align: center;
        }
        .order-header h1 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        .order-header p {
            color: var(--text-secondary);
        }
        .cart-items-section, .order-summary {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #333;
        }
        .cart-item {
            display: flex;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #333;
        }
        .cart-item:last-child {
            border-bottom: none;
        }
        .item-image {
            width: 60px;
            height: 60px;
            border-radius: 4px;
            background-color: #333;
            margin-right: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }
        .item-details h5 {
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        .item-details p {
            margin-bottom: 0;
            color: var(--text-secondary);
            font-size: var(--font-size-small);
        }
        .item-price {
            margin-left: auto;
            font-weight: bold;
            color: var(--primary);
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
        }
        .summary-row.total {
            border-top: 1px solid #333;
            font-weight: bold;
            font-size: var(--font-size-subheading);
        }
        .btn-checkout {
            background-color: var(--primary);
            border-color: var(--primary);
            color: #000;
            font-weight: 500;
        }
        .btn-checkout:hover {
            background-color: var(--secondary);
            border-color: var(--secondary);
            color: #000;
        }
        .empty-cart {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }
        .empty-cart i {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: #333;
        }
    </style>
</head>
<body>
<jsp:include page="/includes/navbar.jsp" />

<div class="order-container">
    <div class="order-header">
        <h1><i class="fas fa-shopping-cart me-2"></i>Order Details</h1>
        <p>Review your selected tracks before proceeding to checkout</p>
    </div>

    <c:choose>
        <c:when test="${empty cartItems or fn:length(cartItems) == 0}">
            <div class="empty-cart">
                <i class="fas fa-shopping-cart"></i>
                <h3>Your cart is empty</h3>
                <p>Add some tracks to get started!</p>
                <a href="${pageContext.request.contextPath}/index" class="btn btn-primary">Continue Shopping</a>
            </div>
        </c:when>
        <c:otherwise>
            <div class="cart-items-section">
                <h3>Cart Items</h3>
                <c:set var="totalAmount" value="0" />
                <c:forEach var="track" items="${cartItems}">
                    <div class="cart-item">
                        <div class="item-image">
                            <i class="fas fa-music"></i>
                        </div>
                        <div class="item-details">
                            <h5>${track.title}</h5>
                            <p>by ${track.artist}</p>
                        </div>
                        <div class="item-price">Rs. ${track.price}</div>
                    </div>
                    <c:set var="totalAmount" value="${cartTotal}" />
                </c:forEach>
            </div>

            <div class="order-summary">
                <h3>Order Summary</h3>
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span>Rs. ${cartTotal}</span>
                </div>
                <div class="summary-row">
                    <span>Shipping</span>
                    <span>Free</span>
                </div>
                <div class="summary-row total">
                    <span>Total</span>
                    <span>Rs. ${cartTotal}</span>
                </div>
                <div class="d-grid gap-2 mt-3">
                    <a href="#" class="btn btn-checkout btn-lg">Proceed to Checkout</a>
                    <a href="${pageContext.request.contextPath}/index" class="btn btn-outline-light">Continue Shopping</a>
                </div>
            </div>
        </c:otherwise>
    </c:choose>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add any client-side functionality here if needed
    });
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\searchMusic.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Music - RhythmWave Music Store</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/css/index.css">
    <style>
        /* Ensure consistency with theme.css and index.css */
        body {
            background-color: var(--dark-bg);
            color: var(--text-primary);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .search-header {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
            url('https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1770&q=80');
            background-size: cover;
            background-position: center;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .search-header h1 {
            color: var(--text-primary);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .input-group input {
            background-color: #2a2a2a;
            border: 1px solid #444;
            color: var(--text-primary);
        }

        .input-group input::placeholder {
            color: var(--placeholder-color);
        }

        .input-group input:focus {
            background-color: #2a2a2a;
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
        }

        .search-section {
            background-color: var(--card-bg);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .filter-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .form-select {
            background-color: #2a2a2a;
            border: 1px solid #444;
            color: var(--text-primary);
            border-radius: 5px;
        }

        .form-select:focus {
            background-color: #2a2a2a;
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
        }

        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
            color: #000;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #9965f4;
            border-color: #9965f4;
            transform: translateY(-2px);
        }

        .btn-outline-secondary {
            border-color: var(--primary);
            color: var(--primary);
            transition: all 0.3s ease;
        }

        .btn-outline-secondary:hover {
            background-color: var(--primary);
            color: #000;
            transform: translateY(-2px);
        }

        .search-results-info {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .no-results {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
            background-color: var(--card-bg);
            border-radius: 10px;
        }

        .no-results i {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
            color: #555;
        }

        .music-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            transition: transform 0.3s, box-shadow 0.3s;
            overflow: hidden;
        }

        .music-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .album-cover {
            width: 100%;
            aspect-ratio: 1/1;
            object-fit: cover;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

        .play-btn, .cart-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .play-btn {
            background-color: var(--primary);
            color: #000;
        }

        .play-btn:hover {
            background-color: #9965f4;
            transform: scale(1.1);
        }

        .play-btn.playing {
            background-color: var(--secondary);
            animation: pulse 0.5s infinite;
        }

        .cart-btn {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .cart-btn:hover {
            background-color: var(--primary);
            color: #000;
            transform: scale(1.1);
        }

        .cart-btn.added {
            background-color: var(--primary);
            color: #000;
        }

        .price-tag {
            color: var(--primary);
            font-weight: bold;
        }

        .artist-name {
            color: var(--secondary);
        }

        /* Animation for play button */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
<!-- Navigation Bar -->
<jsp:include page="/includes/navbar.jsp">
    <jsp:param name="page" value="search"/>
    <jsp:param name="searchBox" value="noShow"/>
</jsp:include>

<!-- Search Header Section -->
<div class="container mt-4">
    <div class="search-header">
        <h1 class="display-5 fw-bold mb-4">Search Our Music Library</h1>
        <!-- Main Search Bar -->
        <div class="row justify-content-center">
            <div class="col-md-8">
                <form action="${pageContext.request.contextPath}/search" method="get">
                    <div class="input-group input-group-lg mb-4">
                        <input type="text" class="form-control" name="query" placeholder="Search artists, albums, or songs..." value="${param.query}">
                        <button class="btn btn-primary" type="submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Advanced Filters Section -->
<div class="container">
    <div class="search-section">
        <h2 class="mb-4">Refine Your Search</h2>
        <form action="${pageContext.request.contextPath}/search" method="get">
            <input type="hidden" name="query" value="${param.query}">
            <div class="row mt-3">
                <div class="col-md-3">
                    <div class="filter-label">Genre</div>
                    <select class="form-select" name="genre">
                        <option value="">All Genres</option>
                        <option value="rock" ${param.genre == 'rock' ? 'selected' : ''}>Rock</option>
                        <option value="pop" ${param.genre == 'pop' ? 'selected' : ''}>Pop</option>
                        <option value="hiphop" ${param.genre == 'hiphop' ? 'selected' : ''}>Hip Hop</option>
                        <option value="electronic" ${param.genre == 'electronic' ? 'selected' : ''}>Electronic</option>
                        <option value="jazz" ${param.genre == 'jazz' ? 'selected' : ''}>Jazz</option>
                        <option value="classical" ${param.genre == 'classical' ? 'selected' : ''}>Classical</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="filter-label">Price Range</div>
                    <select class="form-select" name="price">
                        <option value="">Any Price</option>
                        <option value="under100" ${param.price == 'under100' ? 'selected' : ''}>Under Rs. 100</option>
                        <option value="100-200" ${param.price == '100-200' ? 'selected' : ''}>Rs. 100 - Rs. 200</option>
                        <option value="200-400" ${param.price == '200-400' ? 'selected' : ''}>Rs. 200 - Rs. 400</option>
                        <option value="over400" ${param.price == 'over400' ? 'selected' : ''}>Over Rs. 400</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="filter-label">Release Year</div>
                    <select class="form-select" name="year">
                        <option value="">Any Year</option>
                        <option value="2023" ${param.year == '2023' ? 'selected' : ''}>2023</option>
                        <option value="2022" ${param.year == '2022' ? 'selected' : ''}>2022</option>
                        <option value="2020-2021" ${param.year == '2020-2021' ? 'selected' : ''}>2020-2021</option>
                        <option value="2010-2019" ${param.year == '2010-2019' ? 'selected' : ''}>2010-2019</option>
                        <option value="before2010" ${param.year == 'before2010' ? 'selected' : ''}>Before 2010</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="filter-label">Rating</div>
                    <select class="form-select" name="rating">
                        <option value="">Any Rating</option>
                        <option value="5" ${param.rating == '5' ? 'selected' : ''}>5 Stars</option>
                        <option value="4" ${param.rating == '4' ? 'selected' : ''}>4+ Stars</option>
                        <option value="3" ${param.rating == '3' ? 'selected' : ''}>3+ Stars</option>
                    </select>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-12 text-end">
                    <button type="submit" class="btn btn-primary">Apply Filters</button>
                    <a href="${pageContext.request.contextPath}/search?query=${param.query}" class="btn btn-outline-secondary ms-2">Clear Filters</a>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Search Results Section -->
<div class="container mt-5">
    <c:choose>
        <c:when test="${not empty requestScope.trackList}">
            <div class="search-results-info">
                <h4>${empty param.query ? 'All Tracks' : 'Search Results for "' += param.query += '"'}</h4>
                <p>Found ${fn:length(requestScope.trackList)} results</p>
            </div>
            <div class="row">
                <c:forEach var="track" items="${requestScope.trackList}">
                    <div class="col-md-4 col-lg-3 mb-4">
                        <div class="music-card">
                            <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80" class="album-cover" alt="Album Cover">
                            <div class="p-3">
                                <h5>${track.title}</h5>
                                <p class="artist-name">by ${track.artist}</p>
                                <p class="genre">Genre: ${track.genre}</p>
                                <p class="rating">Rating: ${track.rating} Stars</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="price-tag">Rs. ${track.price}</span>
                                    <div class="d-flex">
                                        <div class="play-btn me-2">
                                            <i class="fas fa-play"></i>
                                        </div>
                                        <c:if test="${not empty sessionScope.USER}">
                                            <button class="cart-btn" data-track-id="${track.trackId}">
                                                <i class="fas fa-cart-plus"></i>
                                            </button>
                                        </c:if>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </c:forEach>
            </div>
            <!-- Pagination -->
            <c:if test="${requestScope.noOfPages > 1}">
                <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center mt-4">
                        <c:if test="${requestScope.currentPage > 1}">
                            <li class="page-item">
                                <a class="page-link" href="${pageContext.request.contextPath}/search?query=${param.query}&genre=${param.genre}&price=${param.price}&rating=${param.rating}&page=${requestScope.currentPage - 1}">Previous</a>
                            </li>
                        </c:if>
                        <c:forEach begin="1" end="${requestScope.noOfPages}" var="i">
                            <li class="page-item ${requestScope.currentPage == i ? 'active' : ''}">
                                <a class="page-link" href="${pageContext.request.contextPath}/search?query=${param.query}&genre=${param.genre}&price=${param.price}&rating=${param.rating}&page=${i}">${i}</a>
                            </li>
                        </c:forEach>
                        <c:if test="${requestScope.currentPage < requestScope.noOfPages}">
                            <li class="page-item">
                                <a class="page-link" href="${pageContext.request.contextPath}/search?query=${param.query}&genre=${param.genre}&price=${param.price}&rating=${param.rating}&page=${requestScope.currentPage + 1}">Next</a>
                            </li>
                        </c:if>
                    </ul>
                </nav>
            </c:if>
        </c:when>
        <c:otherwise>
            <div class="no-results">
                <i class="fas fa-music"></i>
                <h4>No tracks available</h4>
                <p>No tracks found in the library. Please check back later.</p>
            </div>
        </c:otherwise>
    </c:choose>
</div>

<!-- Footer -->
<jsp:include page="/includes/footer.jsp" />

<!-- Shopping Cart Modal -->
<jsp:include page="/includes/modals/shoppingCartModal.jsp" />

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="${pageContext.request.contextPath}/js/music.js"></script>
<script src="${pageContext.request.contextPath}/js/cart.js"></script>

</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\signup.jsp
File type: .jsp
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RhythmWave - Sign Up</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/css/signup.css">
  <style>

  </style>
</head>
<body>
<!-- Auth Container -->
<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <div class="auth-icon">
        <i class="fas fa-music"></i>
      </div>
      <h2>Create Your RhythmWave Account</h2>
      <p class="text-secondary">Join our community of music lovers today</p>
    </div>

    <form id="signupForm" action="${pageContext.request.contextPath}/RegisterServlet" method="post">
      <div class="form-group">
        <label for="first-name" class="form-label">First Name</label>
        <input type="text" class="form-control" id="first-name" name="first-name" placeholder="Enter your first name" required>
      </div>

      <div class="form-group">
        <label for="last-name" class="form-label">Last Name</label>
        <input type="text" class="form-control" id="last-name" name="last-name" placeholder="Enter your last name" required>
      </div>

      <div class="form-group">
        <label for="email" class="form-label">Email address</label>
        <input type="email" class="form-control" id="email" name="email" placeholder="name@example.com" required>
      </div>

      <div class="form-group password-input-group">
        <label for="password" class="form-label">Password</label>
        <input type="password" class="form-control" id="password" name="password" placeholder="Create a strong password" required>
        <span class="password-toggle" id="signup-password-toggle">
          <i class="far fa-eye"></i>
        </span>
      </div>

      <div class="form-group password-input-group">
        <label for="signup-confirm-password" class="form-label">Confirm Password</label>
        <input type="password" class="form-control" id="signup-confirm-password" placeholder="Confirm your password" required>
        <span class="password-toggle" id="signup-confirm-password-toggle">
          <i class="far fa-eye"></i>
        </span>
      </div>

      <div class="form-group">
        <label for="signup-genre" class="form-label">Favorite Music Genre</label>
        <select class="form-control" id="signup-genre" name="signup-genre">
          <option value="">Select your favorite genre</option>
          <option value="rock">Rock</option>
          <option value="pop">Pop</option>
          <option value="jazz">Jazz</option>
          <option value="hiphop">Hip Hop</option>
          <option value="electronic">Electronic</option>
          <option value="classical">Classical</option>
          <option value="country">Country</option>
          <option value="r&b">R&B</option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary btn-lg">Create Account</button>

      <div class="text-center mt-4">
        <p class="text-secondary">Already have an account? <a href="login.jsp" class="text-primary">Log In</a></p>
      </div>
    </form>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\index.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/index.css">
    <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/admin-styles.css">
</head>
<body>
<div class="admin-container">
    <!-- Sidebar Navigation -->
    <jsp:include page="includes/admin_nav_bar.jsp" />

    <!-- Main Content Area -->
    <main class="admin-main">
        <header class="admin-header">
            <h1>RhythmWave Admin Dashboard</h1>
            <div class="user-info">
                <div class="user-avatar"><c:out value="${fn:substring(sessionScope.USER.firstName, 0, 1)}" /></div>
                <div>
                    <div>${sessionScope.USER.firstName} ${sessionScope.USER.lastName}</div>
                    <div class="text-muted">${sessionScope.USER.email}</div>
                </div>
            </div>
        </header>

        <!-- Welcome Section -->
        <section class="welcome-section">
            <div class="welcome-icon">
                <i class="fas fa-music"></i>
            </div>
            <div class="welcome-content">
                <h2>Welcome back, ${sessionScope.USER.firstName}!</h2>
                <p>Manage your music platform efficiently with the RhythmWave Admin Panel.</p>
            </div>
        </section>

        <!-- Stats Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-content">
                    <h3>1,254</h3>
                    <p>Total Users</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-tag"></i>
                </div>
                <div class="stat-content">
                    <h3>24</h3>
                    <p>Active Promotions</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-ad"></i>
                </div>
                <div class="stat-content">
                    <h3>12</h3>
                    <p>Running Ads</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stat-content">
                    <h3>+8.2%</h3>
                    <p>Revenue Growth</p>
                </div>
            </div>
        </div>

        <!-- Dashboard Cards -->
        <div class="dashboard-grid">

            <c:if test="${sessionScope.USER.role.roleName eq 'super_admin'}">

            <!-- User Management Card -->
            <div class="dashboard-card card-user">
                <div class="card-icon">
                    <i class="fas fa-users-cog"></i>
                </div>
                <h3 class="card-title">User Management</h3>
                <p class="card-description">Manage users, roles, and permissions</p>
                <a href="<%=request.getContextPath()%>/manageUsers" class="card-link">
                    Manage Users <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            </c:if>

            <c:if test="${sessionScope.USER.role.roleName eq 'marketing_manager'
            or sessionScope.USER.role.roleName eq 'super_admin'}">

                <!-- Marketing Management Card -->
                <div class="dashboard-card card-user">
                    <div class="card-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <h3 class="card-title">Marketing Management</h3>
                    <p class="card-description">Create promotions and advertisements</p>
                    <a href="<%=request.getContextPath()%>/marketing" class="card-link">
                        Manage Marketing <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

            </c:if>

            <c:if test="${sessionScope.USER.role.roleName eq 'content_manager'
            or sessionScope.USER.role.roleName eq 'super_admin'}">

            <!-- Content Management Card -->
            <div class="dashboard-card">
                <div class="card-icon">
                    <i class="fas fa-music"></i>
                </div>
                <h3 class="card-title">Content Management</h3>
                <p class="card-description">Manage songs, albums, and playlists</p>
                <a href="#" class="card-link">
                    Manage Content <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            </c:if>

            <c:if test="${sessionScope.USER.role.roleName eq 'finance_manager'
            or sessionScope.USER.role.roleName eq 'super_admin'}">

                <!-- Content Management Card -->
                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-music"></i>
                    </div>
                    <h3 class="card-title">Finance Management</h3>
                    <p class="card-description">Manage Orders, Payments, and Analytics</p>
                    <a href="#" class="card-link">
                        Manage Payments <i class="fas fa-arrow-right"></i>
                    </a>
                </div>

            </c:if>

            <!-- Settings Card -->
            <div class="dashboard-card">
                <div class="card-icon">
                    <i class="fas fa-cog"></i>
                </div>
                <h3 class="card-title">Settings</h3>
                <p class="card-description">Configure system settings</p>
                <a href="#" class="card-link">
                    Open Settings <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>

        <footer class="admin-footer">
            &copy; 2023 RhythmWave | Admin Panel
        </footer>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\ManageMarketing.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hotel Admin - Marketing Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/index.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/admin-styles.css">
</head>
<body>
<div class="admin-container">
  <!-- Sidebar Navigation -->
  <jsp:include page="includes/admin_nav_bar.jsp">
    <jsp:param name="page" value="manageMarketing"/>
  </jsp:include>

  <!-- Main Content Area -->
  <main class="admin-main">
    <header class="admin-header">
      <h1>Marketing Management</h1>
      <div class="user-info">
        <div class="user-avatar">A</div>
        <div>
          <div>${sessionScope.USER.firstName} ${sessionScope.USER.lastName}</div>
          <div class="text-muted">${sessionScope.USER.email}</div>
        </div>
      </div>
    </header>

    <!-- Welcome Section -->
    <section class="welcome-section">
      <div class="welcome-icon">
        <i class="fas fa-chart-bar"></i>
      </div>
      <div class="welcome-content">
        <h2>Marketing Management</h2>
        <p>Manage promotions, advertisements, and marketing campaigns for your platform.</p>
      </div>
    </section>

    <!-- Promotions Section -->
    <div class="table-container">
      <div class="table-header">
        <h3>Manage Promotions</h3>
        <div class="table-actions">
          <button class="btn btn-primary" onclick="openAddPromotionModal()">
            <i class="fas fa-plus"></i> Add Promotion
          </button>
        </div>
      </div>
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>Code</th>
          <th>Discount</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Usage</th>
          <th>Description</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <c:choose>
          <c:when test="${not empty requestScope.allPromotions}">
            <c:forEach var="promo" items="${requestScope.allPromotions}">
              <tr>
                <td>${promo.promotionId}</td>
                <td><strong>${promo.code}</strong></td>
                <td>${promo.discount}%</td>
                <td>${promo.startDate}</td>
                <td>${promo.endDate}</td>
                <td>${promo.usageCount}</td>
                <td>${promo.description}</td>
                <td>
                  <span class="status-badge status-active">Active</span>
                </td>
                <td class="actions">
                  <button class="btn btn-edit btn-sm" onclick="openEditPromotionModal('${promo.promotionId}', '${promo.code}', '${promo.discount}', '${promo.startDate}', '${promo.endDate}', '${promo.description}')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-delete btn-sm" onclick="openDeletePromotionModal('${promo.promotionId}', '${promo.code}')">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
            </c:forEach>
          </c:when>
          <c:otherwise>
            <tr>
              <td colspan="9" class="text-muted text-center py-4">No promotions found.</td>
            </tr>
          </c:otherwise>
        </c:choose>
        </tbody>
      </table>
    </div>

    <!-- Advertisements Section -->
    <div class="table-container">
      <div class="table-header">
        <h3>Manage Advertisements</h3>
        <div class="table-actions">
          <button class="btn btn-primary" onclick="openAddAdvertisementModal()">
            <i class="fas fa-plus"></i> Add Advertisement
          </button>
        </div>
      </div>
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>Title</th>
          <th>Content</th>
          <th>Image</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <c:choose>
          <c:when test="${not empty requestScope.allAdvertisements}">
            <c:forEach var="ad" items="${requestScope.allAdvertisements}">
              <tr>
                <td>${ad.adId}</td>
                <td><strong>${ad.title}</strong></td>
                <td>${ad.content}</td>
                <td>
                  <c:if test="${not empty ad.imageData}">
                    <img src="${pageContext.request.contextPath}/image?adId=${ad.adId}" class="preview-img" alt="Ad Image">
                  </c:if>
                </td>
                <td>${ad.startDate}</td>
                <td>${ad.endDate}</td>
                <td>
                  <span class="status-badge ${ad.active ? 'status-active' : 'status-inactive'}">
                      ${ad.active ? 'Active' : 'Inactive'}
                  </span>
                </td>
                <td class="actions">
                  <button class="btn btn-edit btn-sm" onclick="openEditAdvertisementModal('${ad.adId}', '${ad.title}', '${ad.content}', '${ad.imageUrl}', '${ad.startDate}', '${ad.endDate}', '${ad.active}')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-delete btn-sm" onclick="openDeleteAdvertisementModal('${ad.adId}', '${ad.title}')">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
            </c:forEach>
          </c:when>
          <c:otherwise>
            <tr>
              <td colspan="8" class="text-muted text-center py-4">No advertisements found.</td>
            </tr>
          </c:otherwise>
        </c:choose>
        </tbody>
      </table>
    </div>

    <footer class="admin-footer">
      &copy; 2023 RhythmWave | Admin Panel
    </footer>
  </main>
</div>

<!-- Modals -->
<jsp:include page="includes/modals/manage_marketing_modals/add_promotion_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/edit_promotion_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/delete_promotion_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/add_advertisement_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/edit_advertisement_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>
<jsp:include page="includes/modals/manage_marketing_modals/delete_advertisement_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Initialize Bootstrap modals
  const addPromotionModal = new bootstrap.Modal(document.getElementById('addPromotionModal'));
  const editPromotionModal = new bootstrap.Modal(document.getElementById('editPromotionModal'));
  const deletePromotionModal = new bootstrap.Modal(document.getElementById('deletePromotionModal'));
  const addAdvertisementModal = new bootstrap.Modal(document.getElementById('addAdvertisementModal'));
  const editAdvertisementModal = new bootstrap.Modal(document.getElementById('editAdvertisementModal'));
  const deleteAdvertisementModal = new bootstrap.Modal(document.getElementById('deleteAdvertisementModal'));

  function openAddPromotionModal() {
    addPromotionModal.show();
  }

  function closeAddPromotionModal() {
    addPromotionModal.hide();
  }

  function openEditPromotionModal(promotionId, code, discount, startDate, endDate, description) {
    document.getElementById('editPromotionId').value = promotionId;
    document.getElementById('editPromoCode').value = code;
    document.getElementById('editDiscount').value = discount;
    document.getElementById('editStartDate').value = startDate;
    document.getElementById('editEndDate').value = endDate;
    document.getElementById('editDescription').value = description;
    editPromotionModal.show();
  }

  function closeEditPromotionModal() {
    editPromotionModal.hide();
  }

  function openDeletePromotionModal(promotionId, code) {
    document.getElementById('deletePromotionId').value = promotionId;
    document.getElementById('deletePromoCode').textContent = code;
    deletePromotionModal.show();
  }

  function closeDeletePromotionModal() {
    deletePromotionModal.hide();
  }

  function openAddAdvertisementModal() {
    addAdvertisementModal.show();
  }

  function closeAddAdvertisementModal() {
    addAdvertisementModal.hide();
  }

  function openEditAdvertisementModal(adId, title, content, startDate, endDate, active) {
    document.getElementById('editAdId').value = adId;
    document.getElementById('editAdTitle').value = title;
    document.getElementById('editAdContent').value = content;
    document.getElementById('editAdStartDate').value = startDate;
    document.getElementById('editAdEndDate').value = endDate;
    document.getElementById('editAdActive').value = active;
    editAdvertisementModal.show();
  }

  function closeEditAdvertisementModal() {
    editAdvertisementModal.hide();
  }

  function openDeleteAdvertisementModal(adId, title) {
    document.getElementById('deleteAdId').value = adId;
    document.getElementById('deleteAdTitle').textContent = title;
    deleteAdvertisementModal.show();
  }

  function closeDeleteAdvertisementModal() {
    deleteAdvertisementModal.hide();
  }
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\ManageUsers.jsp
File type: .jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hotel Admin - User Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/index.css">
  <link rel="stylesheet" href="${pageContext.request.contextPath}/admin/css/admin-styles.css">
</head>
<body>
<div class="admin-container">
  <!-- Sidebar Navigation -->
  <jsp:include page="includes/admin_nav_bar.jsp">
    <jsp:param name="page" value="manageUsers"/>
  </jsp:include>

  <!-- Main Content Area -->
  <main class="admin-main">
    <header class="admin-header">
      <h1>User Management</h1>
      <div class="user-info">
        <div class="user-avatar">A</div>
        <div>
          <div>${sessionScope.USER.firstName} ${sessionScope.USER.lastName}</div>
          <div class="text-muted">${sessionScope.USER.email}</div>
        </div>
      </div>
    </header>

    <!-- Error Message Display -->
    <c:if test="${not empty error}">
      <div class="alert alert-danger"><c:out value="${error}"/></div>
    </c:if>

    <!-- Users Table -->
    <div class="table-container">
      <div class="table-header">
        <h3>All Users</h3>
        <div class="table-actions">
          <button class="btn btn-primary" onclick="openAddUserModal()">
            <i class="fas fa-plus"></i> Add User
          </button>
        </div>
      </div>
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Email</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <c:forEach var="user" items="${requestScope.allUsers}">
          <tr>
            <td><c:out value="${user.userId}"/></td>
            <td>
              <div><strong><c:out value="${user.firstName} ${user.lastName}"/></strong></div>
<%--              <div class="text-muted">Joined: 2023-10-15</div>--%>
            </td>
            <td><c:out value="${user.email}"/></td>
            <td>
              <span class="status-badge ${user.isAdmin() ? 'status-active' : 'status-inactive'}">
                <c:choose>
                  <c:when test="${user.isAdmin()}">
                    <c:choose>
                      <c:when test="${user.isAdmin()}">
                        Admin
                        <c:if test="${not empty user.role}">
                          (${user.role.roleName})
                        </c:if>
                      </c:when>
                      <c:otherwise>
                        User
                      </c:otherwise>
                    </c:choose>
                  </c:when>
                  <c:otherwise>
                    <c:out value="User"/>
                  </c:otherwise>
                </c:choose>
              </span>
            </td>
            <td>
              <span class="status-badge status-active">Active</span>
            </td>
            <td class="actions">
              <button class="btn btn-edit btn-sm" onclick="openEditModal('<c:out value="${user.userId}"/>', '<c:out value="${user.firstName}"/>', '<c:out value="${user.lastName}"/>', '<c:out value="${user.email}"/>', '<c:out value="${user.isAdmin()}"/>', '<c:out value="${user.isAdmin() && user.getRole() != null ? user.getRole().getRoleName() : ''}"/>')">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button class="btn btn-delete btn-sm" onclick="openDeleteModal('<c:out value="${user.userId}"/>', '<c:out value="${user.firstName} ${user.lastName}"/>')">
                <i class="fas fa-trash"></i> Delete
              </button>
            </td>
          </tr>
        </c:forEach>
        </tbody>
      </table>
    </div>

    <footer class="admin-footer">
      &copy; 2023 RhythmWave | Admin Panel
    </footer>
  </main>
</div>

<!-- Add User Modal -->
<jsp:include page="includes/modals/manage_user_modals/add_user_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>

<!-- Edit User Modal -->
<jsp:include page="includes/modals/manage_user_modals/edit_user_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>

<!-- Delete User Modal -->
<jsp:include page="includes/modals/manage_user_modals/delete_user_modal.jsp">
  <jsp:param name="contextPath" value="${pageContext.request.contextPath}"/>
</jsp:include>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Initialize Bootstrap modals
  const addUserModal = new bootstrap.Modal(document.getElementById('addUserModal'));
  const editUserModal = new bootstrap.Modal(document.getElementById('editUserModal'));
  const deleteUserModal = new bootstrap.Modal(document.getElementById('deleteUserModal'));

  function openAddUserModal() {
    document.getElementById('addUserForm').reset();
    document.getElementById('addAdminRoleGroup').style.display = 'none';
    addUserModal.show();
  }

  function closeAddUserModal() {
    addUserModal.hide();
  }

  function openEditModal(userId, firstName, lastName, email, isAdmin, adminRole) {
    console.log('openEditModal called with:', userId, firstName, lastName, email, isAdmin, adminRole);
    document.getElementById('editUserId').value = userId;
    document.getElementById('editFirstName').value = firstName;
    document.getElementById('editLastName').value = lastName;
    document.getElementById('editEmail').value = email;
    document.getElementById('editRole').value = isAdmin === 'true' ? 'admin' : 'user';
    document.getElementById('editAdminRole').value = adminRole || '';
    document.getElementById('editAdminRoleGroup').style.display = isAdmin === 'true' ? 'block' : 'none';
    editUserModal.show();
  }

  function closeEditModal() {
    editUserModal.hide();
  }

  function openDeleteModal(userId, userName) {
    document.getElementById('deleteUserId').value = userId;
    document.getElementById('deleteUserName').textContent = userName;
    deleteUserModal.show();
  }

  function closeDeleteModal() {
    deleteUserModal.hide();
  }

  function toggleAdminRoleField(prefix) {
    const roleSelect = document.getElementById(prefix + 'Role');
    const adminRoleGroup = document.getElementById(prefix + 'AdminRoleGroup');
    adminRoleGroup.style.display = roleSelect.value === 'admin' ? 'block' : 'none';
  }

  // Client-side validation for forms
  document.getElementById('editUserForm').addEventListener('submit', function(event) {
    const role = document.getElementById('editRole').value;
    const adminRole = document.getElementById('editAdminRole').value;
    if (role === 'admin' && !adminRole) {
      event.preventDefault();
      alert('Please select an admin role.');
    }
  });

  document.getElementById('addUserForm').addEventListener('submit', function(event) {
    const role = document.getElementById('addRole').value;
    const adminRole = document.getElementById('addAdminRole').value;
    if (role === 'admin' && !adminRole) {
      event.preventDefault();
      alert('Please select an admin role.');
    }
  });
</script>
</body>
</html>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\css\admin-styles.css
File type: .css
/* Admin-specific styles for ManageUsers.jsp, ManageMarketing.jsp */
@import "theme.css";

/* Table Styles */
.table-container {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    margin-bottom: 2rem;
    overflow-x: auto;
}

.table-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.table-header h3 {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.table-actions {
    display: flex;
    gap: 0.75rem;
}

table {
    width: 100%;
    border-collapse: collapse;
    color: var(--text-primary);
}

/* Add or modify these styles */
th, td {
    padding: 0.875rem;
    text-align: left;
    border-bottom: 1px solid #333;
    font-size: var(--font-size-small);
    vertical-align: middle; /* Center content vertically */
    min-height: 100px; /* Match preview-img height */
}

th {
    background-color: rgba(42, 42, 42, 0.5);
    color: var(--text-secondary);
    font-weight: 600;
}

td.actions {
    display: flex;
    gap: 0.5rem;
    align-items: center; /* Center buttons vertically */
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: var(--font-size-label);
    height: 100%; /* Fill the cell height */
    box-sizing: border-box; /* Include padding in height */
}

tr:hover {
    background-color: rgba(42, 42, 42, 0.3);
}

.actions {
    display: flex;
    gap: 0.5rem;

}

.btn {
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius);
    border: none;
    cursor: pointer;
    transition: var(--transition);
    font-size: var(--font-size-small);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-primary {
    background-color: var(--primary);
    color: #000;
}

.btn-primary:hover {
    background-color: #9965f4;
}

.btn-secondary {
    background-color: #2a2a2a;
    color: var(--text-primary);
}

.btn-secondary:hover {
    background-color: #3a3a3a;
}

.btn-edit {
    background-color: var(--secondary);
    color: #000;
}

.btn-edit:hover {
    background-color: #02b3a1;
}

.btn-delete {
    background-color: #dc3545;
    color: #fff;
}

.btn-delete:hover {
    background-color: #c82333;
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: var(--font-size-label);
}

/* Modal Styles */
.modal-content {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border: 1px solid #333;
    border-radius: var(--border-radius);
}

.modal-header {
    border-bottom: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.modal-title {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
}

.modal-body {
    padding: 1.5rem;
}

.modal-footer {
    border-top: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-group label {
    display: block;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #444;
    border-radius: var(--border-radius);
    background-color: #2a2a2a;
    color: var(--text-primary);
    font-size: var(--font-size-small);
    transition: var(--transition);
}

.form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
    outline: none;
}

/* Image Preview */
.preview-img {
    width: 100px;
    height: 60px;
    border-radius: var(--border-radius);
    object-fit: cover;
    border: 1px solid #333;
    vertical-align: middle; /* Align image with other content */
}

/* Status Badges */
.status-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.status-active {
    background-color: rgba(3, 218, 198, 0.2);
    color: var(--secondary);
}

.status-inactive {
    background-color: rgba(220, 53, 69, 0.2);
    color: #dc3545;
}

/* Image Preview */
.image-preview {
    width: 100px;
    height: 100px;
    border-radius: var(--border-radius);
    object-fit: cover;
    border: 1px solid #333;
}

.text-muted {
    color: var(--text-secondary) !important;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\css\index.css
File type: .css
/* General application styles from index.css */
@import "theme.css";

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: var(--font-size-base);
    line-height: 1.5;
}

/* Admin Layout Styles */
.admin-container {
    display: flex;
    min-height: 100vh;
}

.admin-sidebar {
    width: var(--sidebar-width);
    background-color: var(--card-bg);
    border-right: 1px solid #333;
    position: fixed;
    height: 100vh;
    overflow-y: auto;
    z-index: 1000;
    transition: var(--transition);
}

.sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid #333;
    text-align: center;
}

.sidebar-header h2 {
    color: var(--primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.sidebar-nav {
    padding: 1rem 0;
}

.sidebar-nav a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    text-decoration: none;
    padding: 0.875rem 1.5rem;
    transition: var(--transition);
    font-size: var(--font-size-small);
}

.sidebar-nav a:hover, .sidebar-nav a.active {
    background-color: rgba(187, 134, 252, 0.1);
    color: var(--primary);
    border-left: 3px solid var(--primary);
}

.sidebar-nav i {
    width: 20px;
    text-align: center;
}

.admin-main {
    flex: 1;
    margin-left: var(--sidebar-width);
    padding: 1.5rem;
    transition: var(--transition);
}

.admin-header {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid #333;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.admin-header h1 {
    color: var(--text-primary);
    font-size: var(--font-size-heading);
    margin: 0;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    font-size: var(--font-size-small);
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-weight: bold;
}

/* Dashboard Styles */
.welcome-section {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 2rem;
    margin-bottom: 2rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

.welcome-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.welcome-icon i {
    font-size: 2rem;
    color: #000;
}

.welcome-content h2 {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.welcome-content p {
    color: var(--text-secondary);
    margin: 0;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.dashboard-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    transition: var(--transition);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.dashboard-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    border-color: var(--primary);
}

.card-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1rem;
}

.card-icon i {
    font-size: 1.5rem;
    color: var(--primary);
}

.card-title {
    font-size: var(--font-size-subheading);
    margin-bottom: 0.5rem;
    color: var(--text-primary);
}

.card-description {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin-bottom: 1rem;
}

.card-link {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    font-size: var(--font-size-small);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: var(--transition);
}

.card-link:hover {
    color: var(--secondary);
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.stat-icon i {
    font-size: 1.25rem;
    color: var(--primary);
}

.stat-content h3 {
    color: var(--text-primary);
    font-size: 1.5rem;
    margin: 0;
}

.stat-content p {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin: 0;
}

/* Footer */
.admin-footer {
    background-color: #1a1a1a;
    color: var(--text-secondary);
    text-align: center;
    padding: 1.5rem;
    margin-top: 2rem;
    border-radius: var(--border-radius);
    font-size: var(--font-size-small);
}

/* Responsive Design */
@media (max-width: 992px) {
    .admin-sidebar {
        transform: translateX(-100%);
    }

    .admin-sidebar.active {
        transform: translateX(0);
    }

    .admin-main {
        margin-left: 0;
    }
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }

    .welcome-section {
        flex-direction: column;
        text-align: center;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\css\theme.css
File type: .css
/* theme.css - Updated with proper font sizes */
:root {
    --dark-bg: #121212;
    --card-bg: #1e1e1e;
    --primary: #bb86fc;
    --secondary: #03dac6;
    --text-primary: #ffffff;
    --text-secondary: #b3b3b3;
    --placeholder-color: #888;
    --font-size-base: 1rem;
    --font-size-heading: 1.5rem;
    --font-size-subheading: 1.25rem;
    --font-size-small: 0.875rem;
    --font-size-label: 0.8rem;
    --border-radius: 8px;
    --sidebar-width: 250px;
    --header-height: 70px;
    --transition: all 0.3s ease;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\admin_nav_bar.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="page" value="${param.page}" />

<nav class="admin-sidebar">
  <div class="sidebar-header">
    <h2>RhythmWave Admin</h2>
  </div>
  <div class="sidebar-nav">
    <c:if test="${sessionScope.USER != null}">
      <a href="${pageContext.request.contextPath}/admin/index" class="${empty page ? 'active' : ''}">
        <i class="fas fa-tachometer-alt"></i>
        Dashboard
      </a>

      <c:if test="${sessionScope.USER.role != null && sessionScope.USER.role.roleName eq 'super_admin'}">
        <a href="${pageContext.request.contextPath}/manageUsers" class="${page eq 'manageUsers' ? 'active' : ''}">
          <i class="fas fa-users-cog"></i>
          User Management
        </a>
      </c:if>

      <c:if test="${sessionScope.USER.role != null && (sessionScope.USER.role.roleName eq 'super_admin' || sessionScope.USER.role.roleName eq 'marketing_manager')}">
        <a href="${pageContext.request.contextPath}/marketing" class="${page eq 'manageMarketing' ? 'active' : ''}">
          <i class="fas fa-chart-bar"></i>
          Marketing Management
        </a>
      </c:if>

      <a href="${pageContext.request.contextPath}/LogoutServlet" class="${page eq 'logout' ? 'active' : ''}">
        <i class="fas fa-sign-out-alt"></i>
        Logout
      </a>
    </c:if>
  </div>
</nav>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\add_advertisement_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="addAdvertisementModal" tabindex="-1" aria-labelledby="addAdvertisementModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addAdvertisementModalLabel">Add New Advertisement</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="addAdvertisementForm" action="${contextPath}/marketing" method="POST" enctype="multipart/form-data">
                <div class="modal-body">
                    <input type="hidden" name="action" value="ad_add">
                    <div class="form-group">
                        <label for="addAdTitle">Title</label>
                        <input type="text" class="form-control" id="addAdTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdContent">Content</label>
                        <input type="text" class="form-control" id="addAdContent" name="content" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdImage" class="form-label">Image</label>
                        <input type="file" class="form-control" id="addAdImage" name="imageFile" accept="image/png,image/jpeg,image/jpg">
                    </div>
                    <div class="form-group">
                        <label for="addAdStartDate">Start Date</label>
                        <input type="date" class="form-control" id="addAdStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdEndDate">End Date</label>
                        <input type="date" class="form-control" id="addAdEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addAdActive">Active</label>
                        <select class="form-control" id="addAdActive" name="active" required>
                            <option value="true">Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Advertisement</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\add_promotion_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="addPromotionModal" tabindex="-1" aria-labelledby="addPromotionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addPromotionModalLabel">Add New Promotion</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="addPromotionForm" action="${contextPath}/marketing" method="POST">
                <div class="modal-body">
                    <input type="hidden" name="action" value="add">
                    <div class="form-group">
                        <label for="addPromoCode">Code</label>
                        <input type="text" class="form-control" id="addPromoCode" name="code" required>
                    </div>
                    <div class="form-group">
                        <label for="addDiscount">Discount</label>
                        <input type="number" class="form-control" id="addDiscount" name="discount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="addStartDate">Start Date</label>
                        <input type="date" class="form-control" id="addStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addEndDate">End Date</label>
                        <input type="date" class="form-control" id="addEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="addDescription">Description</label>
                        <input type="text" class="form-control" id="addDescription" name="description" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Promotion</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\delete_advertisement_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="deleteAdvertisementModal" tabindex="-1" aria-labelledby="deleteAdvertisementModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteAdvertisementModalLabel">Delete Advertisement</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="deleteAdvertisementForm" action="${contextPath}/marketing" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="deleteAdId" name="adId">
                    <input type="hidden" name="action" value="ad_delete">
                    <p>Are you sure you want to delete advertisement <strong id="deleteAdTitle"></strong>?</p>
                    <p class="text-muted">This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\delete_promotion_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="deletePromotionModal" tabindex="-1" aria-labelledby="deletePromotionModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deletePromotionModalLabel">Delete Promotion</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="deletePromotionForm" action="${contextPath}/marketing" method="POST">
        <div class="modal-body">
          <input type="hidden" id="deletePromotionId" name="promotionId">
          <input type="hidden" name="action" value="delete">
          <p>Are you sure you want to delete promotion <strong id="deletePromoCode"></strong>?</p>
          <p class="text-muted">This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-danger">Delete</button>
        </div>
      </form>
    </div>
  </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\edit_advertisement_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="editAdvertisementModal" tabindex="-1" aria-labelledby="editAdvertisementModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editAdvertisementModalLabel">Edit Advertisement</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="editAdvertisementForm" action="${contextPath}/marketing" method="POST" enctype="multipart/form-data">
                <div class="modal-body">
                    <input type="hidden" id="editAdId" name="adId">
                    <input type="hidden" name="action" value="ad_update">
                    <div class="form-group">
                        <label for="editAdTitle">Title</label>
                        <input type="text" class="form-control" id="editAdTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdContent">Content</label>
                        <input type="text" class="form-control" id="editAdContent" name="content" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdImage">Image</label>
                        <div class="custom-file-upload">
                            <input type="file" id="editAdImage" name="image" accept="image/*">
                            <label for="editAdImage">
                                <span class="file-name">No file chosen</span>
                                <span class="btn">Choose File</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editAdStartDate">Start Date</label>
                        <input type="date" class="form-control" id="editAdStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdEndDate">End Date</label>
                        <input type="date" class="form-control" id="editAdEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdActive">Active</label>
                        <select class="form-control" id="editAdActive" name="active" required>
                            <option value="true">Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.getElementById('editAdImage').addEventListener('change', function() {
        const fileName = this.files.length > 0 ? this.files[0].name : 'No file chosen';
        this.nextElementSibling.querySelector('.file-name').textContent = fileName;
    });
</script>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_marketing_modals\edit_promotion_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="editPromotionModal" tabindex="-1" aria-labelledby="editPromotionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPromotionModalLabel">Edit Promotion</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="editPromotionForm" action="${contextPath}/marketing" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="editPromotionId" name="promotionId">
                    <input type="hidden" name="action" value="update">
                    <div class="form-group">
                        <label for="editPromoCode">Code</label>
                        <input type="text" class="form-control" id="editPromoCode" name="code" required>
                    </div>
                    <div class="form-group">
                        <label for="editDiscount">Discount</label>
                        <input type="number" class="form-control" id="editDiscount" name="discount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editStartDate">Start Date</label>
                        <input type="date" class="form-control" id="editStartDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editEndDate">End Date</label>
                        <input type="date" class="form-control" id="editEndDate" name="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editDescription">Description</label>
                        <input type="text" class="form-control" id="editDescription" name="description" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_user_modals\add_user_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addUserModalLabel">Add New User</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="addUserForm" action="${contextPath}/manageUsers" method="POST">
        <div class="modal-body">
          <input type="hidden" name="action" value="add">
          <div class="form-group">
            <label for="addFirstName">First Name</label>
            <input type="text" class="form-control" id="addFirstName" name="firstName" required>
          </div>
          <div class="form-group">
            <label for="addLastName">Last Name</label>
            <input type="text" class="form-control" id="addLastName" name="lastName" required>
          </div>
          <div class="form-group">
            <label for="addEmail">Email</label>
            <input type="email" class="form-control" id="addEmail" name="email" required>
          </div>
          <div class="form-group">
            <label for="addPassword">Password</label>
            <input type="password" class="form-control" id="addPassword" name="password" required>
          </div>
          <div class="form-group">
            <label for="addRole">Role</label>
            <select class="form-control" id="addRole" name="role" required onchange="toggleAdminRoleField('add')">
              <option value="user">User</option>
              <option value="admin">Admin</option>
            </select>
          </div>
          <div class="form-group" id="addAdminRoleGroup" style="display: none;">
            <label for="addAdminRole">Admin Role</label>
            <select class="form-control" id="addAdminRole" name="adminRole">
              <option value="">Select Admin Role</option>
              <c:forEach var="role" items="${adminRoles}">
                <option value="${role}">${role}</option>
              </c:forEach>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Add User</button>
        </div>
      </form>
    </div>
  </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_user_modals\delete_user_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="deleteUserModal" tabindex="-1" aria-labelledby="deleteUserModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteUserModalLabel">Delete User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="deleteUserForm" action="${contextPath}/manageUsers" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="deleteUserId" name="userId">
                    <input type="hidden" name="action" value="delete">
                    <p>Are you sure you want to delete user <strong id="deleteUserName"></strong>?</p>
                    <p class="text-muted">This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\admin\includes\modals\manage_user_modals\edit_user_modal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>

<c:set var="contextPath" value="${param.contextPath}" />

<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editUserModalLabel">Edit User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="editUserForm" action="${contextPath}/manageUsers" method="POST">
                <div class="modal-body">
                    <input type="hidden" id="editUserId" name="userId">
                    <input type="hidden" id="action" name="action" value="update">
                    <div class="form-group">
                        <label for="editFirstName">First Name</label>
                        <input type="text" class="form-control" id="editFirstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="editLastName">Last Name</label>
                        <input type="text" class="form-control" id="editLastName" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label for="editEmail">Email</label>
                        <input type="email" class="form-control" id="editEmail" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="editRole">Role</label>
                        <select class="form-control" id="editRole" name="role" required onchange="toggleAdminRoleField('edit')">
                            <option value="user">User</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                    <div class="form-group" id="editAdminRoleGroup" style="display: none;">
                        <label for="editAdminRole">Admin Role</label>
                        <select class="form-control" id="editAdminRole" name="adminRole">
                            <option value="">Select Admin Role</option>
                            <c:forEach var="role" items="${adminRoles}">
                                <option value="${role}">${role}</option>
                            </c:forEach>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editPassword">Password</label>
                        <input type="password" class="form-control" id="editPassword" name="editPassword" placeholder="New Password (leave blank to keep unchanged)">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\admin-styles.css
File type: .css

@import "theme.css";

/* Table Styles */
.table-container {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    margin-bottom: 2rem;
    overflow-x: auto;
}

.table-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.table-header h3 {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.table-actions {
    display: flex;
    gap: 0.75rem;
}

table {
    width: 100%;
    border-collapse: collapse;
    color: var(--text-primary);
}

th, td {
    padding: 0.875rem;
    text-align: left;
    border-bottom: 1px solid #333;
    font-size: var(--font-size-small);
}

th {
    background-color: rgba(42, 42, 42, 0.5);
    color: var(--text-secondary);
    font-weight: 600;
}

tr:hover {
    background-color: rgba(42, 42, 42, 0.3);
}

.actions {
    display: flex;
    gap: 0.5rem;
}

.btn {
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius);
    border: none;
    cursor: pointer;
    transition: var(--transition);
    font-size: var(--font-size-small);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-primary {
    background-color: var(--primary);
    color: #000;
}

.btn-primary:hover {
    background-color: #9965f4;
}

.btn-secondary {
    background-color: #2a2a2a;
    color: var(--text-primary);
}

.btn-secondary:hover {
    background-color: #3a3a3a;
}

.btn-edit {
    background-color: var(--secondary);
    color: #000;
}

.btn-edit:hover {
    background-color: #02b3a1;
}

.btn-delete {
    background-color: #dc3545;
    color: #fff;
}

.btn-delete:hover {
    background-color: #c82333;
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: var(--font-size-label);
}

/* Modal Styles */
.modal-content {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border: 1px solid #333;
    border-radius: var(--border-radius);
}

.modal-header {
    border-bottom: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.modal-title {
    color: var(--text-primary);
    font-size: var(--font-size-subheading);
}

.modal-body {
    padding: 1.5rem;
}

.modal-footer {
    border-top: 1px solid #333;
    padding: 1.25rem 1.5rem;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-group label {
    display: block;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #444;
    border-radius: var(--border-radius);
    background-color: #2a2a2a;
    color: var(--text-primary);
    font-size: var(--font-size-small);
    transition: var(--transition);
}

.form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
    outline: none;
}

/* Status Badges */
.status-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: var(--font-size-label);
    font-weight: 500;
}

.status-active {
    background-color: rgba(3, 218, 198, 0.2);
    color: var(--secondary);
}

.status-inactive {
    background-color: rgba(220, 53, 69, 0.2);
    color: #dc3545;
}

/* Image Preview */
.preview-img {
    width: 100px;
    height: 100px;
    border-radius: var(--border-radius);
    object-fit: cover;
    border: 1px solid #333;
}

.text-muted {
    color: var(--text-secondary) !important;
}

/* Custom File Upload Styles */
.custom-file-upload {
    position: relative;
    display: inline-block;
    width: 100%;
}

.custom-file-upload input[type="file"] {
    display: none;
}

.custom-file-upload label {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #444;
    border-radius: var(--border-radius);
    background-color: #2a2a2a;
    color: var(--text-primary);
    font-size: var(--font-size-small);
    cursor: pointer;
    transition: var(--transition);
}

.custom-file-upload label:hover {
    background-color: #3a3a3a;
}

.custom-file-upload label:focus-within {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
    outline: none;
}

.custom-file-upload .file-name {
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: var(--text-secondary);
}

.custom-file-upload .btn {
    background-color: var(--primary);
    color: #000;
    padding: 0.5rem 1rem;
    font-size: var(--font-size-label);
}

.custom-file-upload .btn:hover {
    background-color: #9965f4;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\index.css
File type: .css
/* General application styles from index.css */
@import "theme.css";

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: var(--font-size-base);
    line-height: 1.5;
}

/* Admin Layout Styles */
.admin-container {
    display: flex;
    min-height: 100vh;
}

.admin-sidebar {
    width: var(--sidebar-width);
    background-color: var(--card-bg);
    border-right: 1px solid #333;
    position: fixed;
    height: 100vh;
    overflow-y: auto;
    z-index: 1000;
    transition: var(--transition);
}

.sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid #333;
    text-align: center;
}

.sidebar-header h2 {
    color: var(--primary);
    font-size: var(--font-size-subheading);
    margin: 0;
}

.sidebar-nav {
    padding: 1rem 0;
}

.sidebar-nav a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    text-decoration: none;
    padding: 0.875rem 1.5rem;
    transition: var(--transition);
    font-size: var(--font-size-small);
}

.sidebar-nav a:hover, .sidebar-nav a.active {
    background-color: rgba(187, 134, 252, 0.1);
    color: var(--primary);
    border-left: 3px solid var(--primary);
}

.sidebar-nav i {
    width: 20px;
    text-align: center;
}

.admin-main {
    flex: 1;
    margin-left: var(--sidebar-width);
    padding: 1.5rem;
    transition: var(--transition);
}

.admin-header {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid #333;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.admin-header h1 {
    color: var(--text-primary);
    font-size: var(--font-size-heading);
    margin: 0;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-secondary);
    font-size: var(--font-size-small);
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-weight: bold;
}

/* Dashboard Styles */
.welcome-section {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 2rem;
    margin-bottom: 2rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

.welcome-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.welcome-icon i {
    font-size: 2rem;
    color: #000;
}

.welcome-content h2 {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.welcome-content p {
    color: var(--text-secondary);
    margin: 0;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.dashboard-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    transition: var(--transition);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.dashboard-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    border-color: var(--primary);
}

.card-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1rem;
}

.card-icon i {
    font-size: 1.5rem;
    color: var(--primary);
}

.card-title {
    font-size: var(--font-size-subheading);
    margin-bottom: 0.5rem;
    color: var(--text-primary);
}

.card-description {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin-bottom: 1rem;
}

.card-link {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    font-size: var(--font-size-small);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: var(--transition);
}

.card-link:hover {
    color: var(--secondary);
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background-color: var(--card-bg);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    border: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: rgba(187, 134, 252, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.stat-icon i {
    font-size: 1.25rem;
    color: var(--primary);
}

.stat-content h3 {
    color: var(--text-primary);
    font-size: 1.5rem;
    margin: 0;
}

.stat-content p {
    color: var(--text-secondary);
    font-size: var(--font-size-small);
    margin: 0;
}

/* Footer */
.admin-footer {
    background-color: #1a1a1a;
    color: var(--text-secondary);
    text-align: center;
    padding: 1.5rem;
    margin-top: 2rem;
    border-radius: var(--border-radius);
    font-size: var(--font-size-small);
}

/* Responsive Design */
@media (max-width: 992px) {
    .admin-sidebar {
        transform: translateX(-100%);
    }

    .admin-sidebar.active {
        transform: translateX(0);
    }

    .admin-main {
        margin-left: 0;
    }
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }

    .welcome-section {
        flex-direction: column;
        text-align: center;
    }
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\login.css
File type: .css
@import "theme.css";

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.auth-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-grow: 1;
    padding: 2rem;
}

.auth-card {
    background-color: var(--card-bg);
    border-radius: 10px;
    padding: 2.5rem;
    width: 100%;
    max-width: 450px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.5);
}

.auth-header {
    text-align: center;
    margin-bottom: 2rem;
}

.auth-icon {
    font-size: 2.5rem;
    color: var(--primary);
    margin-bottom: 1rem;
}

.form-control {
    background-color: #2a2a2a;
    border: 1px solid #444;
    color: var(--text-primary);
    padding: 0.75rem 1rem;
}

.form-control:focus {
    background-color: #2a2a2a;
    color: var(--text-primary);
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem rgba(187, 134, 252, 0.25);
}

.btn-primary {
    background-color: var(--primary);
    border: none;
    color: #000;
    padding: 0.75rem;
    font-weight: 600;
}

.btn-primary:hover {
    background-color: #9965f4;
}

.form-check-input {
    background-color: #2a2a2a;
    border: 1px solid #444;
}

.form-check-input:checked {
    background-color: var(--primary);
    border-color: var(--primary);
}

.form-control::placeholder {
    color: var(--placeholder-color);
    opacity: 1;
}

.form-control:-ms-input-placeholder {
    color: var(--placeholder-color);
}

.form-control::-ms-input-placeholder {
    color: var(--placeholder-color);
}

.password-toggle {
    cursor: pointer;
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
}

.password-input-group {
    position: relative;
}

.footer {
    background-color: #1a1a1a;
    padding: 1.5rem 0;
    margin-top: auto;
    text-align: center;
}

.footer-links {
    margin-top: 0.5rem;
}

.footer-links a {
    color: var(--text-secondary);
    text-decoration: none;
    margin: 0 10px;
    font-size: 0.9rem;
}

.footer-links a:hover {
    color: var(--primary);
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\signup.css
File type: .css
@import "theme.css";

body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    background-image: linear-gradient(to bottom, #1a1a1a, #2d2d2d);
}

.auth-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-grow: 1;
    padding: 2rem;
}

.auth-card {
    background-color: var(--card-bg);
    border-radius: 12px;
    padding: 2.5rem;
    width: 100%;
    max-width: 500px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.5);
}

.auth-header {
    text-align: center;
    margin-bottom: 2.5rem;
}

.auth-icon {
    font-size: 3rem;
    color: var(--primary);
    margin-bottom: 1.5rem;
}

.form-control {
    background-color: #2a2a2a;
    border: 1px solid #444;
    color: var(--text-primary);
    padding: 0.85rem 2.5rem 0.85rem 1.2rem;
    font-size: 1.05rem;
    margin-bottom: 1.5rem;
}

.form-control:focus {
    background-color: #2a2a2a;
    color: var(--text-primary);
    border-color: var(--primary);
    box-shadow: 0 0 0 0.3rem rgba(187, 134, 252, 0.25);
}

.form-control::placeholder {
    color: var(--placeholder-color);
    opacity: 1;
}

.form-control:-ms-input-placeholder {
    color: var(--placeholder-color);
}

.form-control::-ms-input-placeholder {
    color: var(--placeholder-color);
}

.btn-primary {
    background-color: var(--primary);
    border: none;
    color: #000;
    padding: 0.9rem;
    font-weight: 600;
    font-size: 1.1rem;
    border-radius: 8px;
    transition: all 0.3s;
    width: 100%;
    margin-top: 1rem;
}

.btn-primary:hover {
    background-color: #9965f4;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(187, 134, 252, 0.4);
}

.form-check-input {
    background-color: #2a2a2a;
    border: 1px solid #444;
    width: 1.2em;
    height: 1.2em;
    margin-top: 0.15em;
}

.form-check-input:checked {
    background-color: var(--primary);
    border-color: var(--primary);
}

.form-check-label {
    margin-left: 0.5em;
}

.password-input-group {
    position: relative;
}

.password-toggle {
    cursor: pointer;
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    padding: 0 10px;
}

.footer {
    background-color: #1a1a1a;
    padding: 1.5rem 0;
    margin-top: auto;
    text-align: center;
}

.footer-links {
    margin-top: 0.5rem;
}

.footer-links a {
    color: var(--text-secondary);
    text-decoration: none;
    margin: 0 12px;
    font-size: 0.95rem;
    transition: color 0.3s;
}

.footer-links a:hover {
    color: var(--primary);
}

.form-label {
    font-weight: 500;
    margin-bottom: 0.5rem;
    display: block;
}

.terms-text {
    margin-left: 1.8rem;
    margin-top: 0.5rem;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\css\theme.css
File type: .css
/* theme.css - Updated with proper font sizes */
:root {
    --dark-bg: #121212;
    --card-bg: #1e1e1e;
    --primary: #bb86fc;
    --secondary: #03dac6;
    --text-primary: #ffffff;
    --text-secondary: #b3b3b3;
    --placeholder-color: #888;
    --font-size-base: 1rem;
    --font-size-heading: 1.5rem;
    --font-size-subheading: 1.25rem;
    --font-size-small: 0.875rem;
    --font-size-label: 0.8rem;
    --border-radius: 8px;
    --sidebar-width: 250px;
    --header-height: 70px;
    --transition: all 0.3s ease;
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\includes\footer.jsp
File type: .jsp
<footer class="footer mt-5">
    <div class="container">
        <hr class="my-4">
        <div class="row">
            <div class="col-md-6">
                <p class="text-secondary"> 2023 RhythmWave. All rights reserved.</p>
            </div>
            <div class="col-md-6 text-md-end">
                <a href="#" class="text-secondary me-3"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-secondary me-3"><i class="fab fa-twitter"></i></a>
                <a href="#" class="text-secondary me-3"><i class="fab fa-instagram"></i></a>
                <a href="#" class="text-secondary"><i class="fab fa-youtube"></i></a>
            </div>
        </div>
    </div>
</footer>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\includes\navbar.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<c:set var="activePage" value="${param.page}" />

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark sticky-top mb-2">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">
      <i class="fas fa-music me-2"></i>RhythmWave
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link ${activePage eq 'index' ? 'active' : ''}" href="${pageContext.request.contextPath}/index">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq 'search' ? 'active' : ''}" href="${pageContext.request.contextPath}/search">Search</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq '' ? 'active' : ''}" href="#">Genres</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq '' ? 'active' : ''}" href="#">New Releases</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ${activePage eq '' ? 'active' : ''}" href="#">Top Charts</a>
        </li>
      </ul>

      <!-- Search Bar -->
      <c:if test="${!(param.searchBox eq 'noShow')}">
        <form action="${pageContext.request.contextPath}/search" method="get" class="input-group me-3" style="max-width: 300px;">
          <input type="text" class="form-control" name="query" placeholder="Search artists, albums, or songs..." value="${param.query}">
          <button class="btn btn-primary" type="submit">
            <i class="fas fa-search"></i>
          </button>
        </form>
      </c:if>

      <c:choose>
        <c:when test="${empty sessionScope.USER}">
          <div class="d-flex">
            <a href="login.jsp" class="btn btn-outline-primary me-2">Login</a>
            <a href="signup.jsp" class="btn btn-primary me-3">Sign Up</a>
          </div>
        </c:when>
        <c:otherwise>
          <div class="d-flex">
            <a href="${pageContext.request.contextPath}/LogoutServlet" class="btn btn-primary me-2">Logout</a>
            <button type="button" class="btn btn-outline-light position-relative me-2" data-bs-toggle="modal" data-bs-target="#shoppingCartModal">
              <i class="fas fa-shopping-cart me-2"></i>
              <span class="badge badge-light cart-badge"></span>
            </button>

            <c:choose>
              <c:when test="${sessionScope.USER.isAdmin() eq true}">
                <a href="${pageContext.request.contextPath}/admin/">
                  <button type="button" class="btn btn-outline-light position-relative me-2">
                    <i class="fa-solid fa-user me-2" ></i> Admin Panel
                  </button>
                </a>
              </c:when>
              <c:otherwise>
                <a href="${pageContext.request.contextPath}/profile">
                  <button type="button" class="btn btn-outline-light position-relative me-2">
                    <i class="fa-solid fa-user me-2" ></i> Profile
                  </button>
                </a>
              </c:otherwise>
            </c:choose>
          </div>
        </c:otherwise>
      </c:choose>
    </div>
  </div>
</nav>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\includes\modals\shoppingCartModal.jsp
File type: .jsp
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<div class="modal fade cart-modal" id="shoppingCartModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Your Shopping Cart <span class="cart-badge"> <c:out value="${fn:length(sessionScope.cartItems)}" /></span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Cart Item 1 -->
                <c:choose>
                    <c:when test="${empty sessionScope.cartItems}">
                        <div class="modal-body">
                            <div class="cart-empty">
                                <i class="fas fa-shopping-cart"></i>
                                <p>Your cart is empty</p>
                            </div>
                        </div>
                    </c:when>
                    <c:otherwise>
                        <c:forEach var="track" items="${sessionScope.cartItems}">
                            <div class="cart-item">
                                <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80"
                                     alt="Album Cover" class="cart-item-img">
                                <div class="cart-item-details">
                                    <div class="cart-item-title">${track.title}</div>
                                    <div class="cart-item-artist">by ${track.artist}</div>
                                    <div class="cart-item-price">Rs. ${track.price}</div>
                                </div>

                                <button class="cart-item-remove" data-track-id="${track.trackId}">
                                    <i class="fas fa-trash"></i>
                                </button>

                            </div>
                        </c:forEach>
                    </c:otherwise>
                </c:choose>

            </div>
            <div class="modal-footer">
                <div class="cart-summary">
                    <span>Total: </span>
                    <span class="cart-total">Rs. ${sessionScope.cartTotal}</span>
                </div>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Continue Shopping</button>
                <a href="${pageContext.request.contextPath}/orderDetails">
                    <button type="button" class="btn btn-primary">Proceed to Checkout</button>
                </a>
            </div>
        </div>
    </div>
</div>


--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\js\cart.js
File type: .js
// Cart functionality for RhythmWave Music Store
document.addEventListener('DOMContentLoaded', function() {
    // Initialize cart buttons
    initializeCartButtons();

    // Initialize cart modal
    initializeCartModal();
});

// Initialize cart buttons
function initializeCartButtons() {
    const cartButtons = document.querySelectorAll('.cart-btn');
    cartButtons.forEach(button => {
        button.addEventListener('click', function() {
            const trackId = this.getAttribute('data-track-id');
            const isAdded = this.classList.contains('added');
            const action = isAdded ? 'remove' : 'add';

            updateCart(action, trackId, this);
        });
    });
}

// Initialize cart modal
function initializeCartModal() {
    // Add event listeners to remove buttons in modal
    document.addEventListener('click', function(e) {
        if (e.target.closest('.cart-item-remove')) {
            const button = e.target.closest('.cart-item-remove');
            const trackId = button.getAttribute('data-track-id');
            updateCart('remove', trackId, null);
        }
    });

    // Load initial cart state
    loadCartState();
}

// Load initial cart state from server
async function loadCartState() {
    try {
        const response = await fetch('${pageContext.request.contextPath}/CartServlet?action=getState', {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'Accept': 'application/json'
            }
        });

        if (!response.ok) {
            throw new Error('Failed to load cart state');
        }

        const data = await response.json();
        updateCartUI(data);
    } catch (error) {
        console.error('Error loading cart state:', error);
    }
}

// AJAX call to update cart
async function updateCart(action, trackId, button) {
    try {
        const response = await fetch(`CartServlet?action=${action}&trackId=${trackId}`, {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'Accept': 'application/json'
            }
        });

        if (!response.ok) {
            const error = await response.json();
            throw new Error(error.error || 'Failed to update cart');
        }

        const data = await response.json();

        // Update button state if provided
        if (button) {
            if (action === 'add') {
                button.classList.add('added');
                button.querySelector('i').classList.replace('fa-cart-plus', 'fa-check');

                // Revert after 2 seconds
                setTimeout(() => {
                    if (button.classList.contains('added')) {
                        button.querySelector('i').classList.replace('fa-check', 'fa-cart-plus');
                    }
                }, 2000);
            } else {
                button.classList.remove('added');
                button.querySelector('i').classList.replace('fa-check', 'fa-cart-plus');
            }
        }

        // Update UI
        updateCartUI(data);
    } catch (error) {
        console.error('Error updating cart:', error);
        alert('Error: ' + error.message);
    }
}

// Update cart UI elements
function updateCartUI(data) {
    // Update cart badge
    const cartBadge = document.querySelector('.cart-badge');
    if (cartBadge) {
        cartBadge.textContent = data.itemCount;
    }

    // Update cart modal content
    updateCartModal(data);
}

// Update cart modal content
function updateCartModal(data) {
    const modalBody = document.querySelector('#shoppingCartModal .modal-body');
    const cartTotal = document.querySelector('.cart-total');

    if (!modalBody || !cartTotal) return;

    // Update total
    cartTotal.textContent = 'Rs. ' + data.cartTotal.toFixed(2);

    // Update cart items
    if (data.itemCount === 0) {
        modalBody.innerHTML = `
            <div class="cart-empty">
                <i class="fas fa-shopping-cart"></i>
                <p>Your cart is empty</p>
            </div>
        `;
    } else {
        let cartItemsHtml = '';
        data.cartItems.forEach(item => {
            cartItemsHtml += `
                <div class="cart-item">
                    <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80"
                         alt="Album Cover" class="cart-item-img">
                    <div class="cart-item-details">
                        <div class="cart-item-title">${escapeHtml(item.title)}</div>
                        <div class="cart-item-artist">by ${escapeHtml(item.artist)}</div>
                        <div class="cart-item-price">Rs. ${item.price.toFixed(2)}</div>
                    </div>
                    <button class="cart-item-remove" data-track-id="${item.trackId}">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
        });
        modalBody.innerHTML = cartItemsHtml;
    }
}

// Helper function to escape HTML
function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, function(m) { return map[m]; });
}

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\js\music.js
File type: .js
document.addEventListener('DOMContentLoaded', function() {
    const playButtons = document.querySelectorAll('.play-btn');
    playButtons.forEach(button => {
        button.addEventListener('click', function() {
            this.classList.toggle('playing');
            const icon = this.querySelector('i');
            if (icon.classList.contains('fa-play')) {
                icon.classList.replace('fa-play', 'fa-pause');
            } else {
                icon.classList.replace('fa-pause', 'fa-play');
            }
        });
    });
});

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\WEB-INF\web.xml
File type: .xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="https://jakarta.ee/xml/ns/jakartaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_6_0.xsd"
         version="6.0">
</web-app>

--------------------------------------------------
File End
--------------------------------------------------


E:/SLIIT/Year 2 Semester 1/SE2030 - Software Engineering/Assignment/web_based_music_store/src/main/webapp\WEB-INF\db\RhythmWaveDB.db
File type: .db
SQLite format 3   @                                                                   .zq
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            JitablenotemptynotemptyCREATE TABLE notempty (id integer primary key)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

--------------------------------------------------
File End
--------------------------------------------------
